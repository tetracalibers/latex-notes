\documentclass[b5paper]{book}

% === extend ===

\usepackage{xparse}%オプション（省略可能引数）をもつコマンド作成

% === color ===

\usepackage[dvipsnames]{xcolor}

\definecolor{myPurple}{HTML}{CDC1FF}
\definecolor{electriclavender}{rgb}{0.96, 0.73, 1.0}
\definecolor{electricpurple}{rgb}{0.75, 0.0, 1.0}
\definecolor{heliotrope}{rgb}{0.87, 0.45, 1.0}
\definecolor{hotpink}{rgb}{1.0, 0.41, 0.71}
\definecolor{hotmagenta}{rgb}{1.0, 0.11, 0.81}
\definecolor{frenchrose}{rgb}{0.96, 0.29, 0.54}
\definecolor{carnationpink}{rgb}{1.0, 0.65, 0.79}
\definecolor{deeppink}{rgb}{1.0, 0.08, 0.58}
\definecolor{deepskyblue}{rgb}{0.0, 0.75, 1.0}
\definecolor{fuchsiapink}{rgb}{1.0, 0.47, 1.0}
\definecolor{electricblue}{rgb}{0.49, 0.98, 1.0}
\definecolor{capri}{rgb}{0.0, 0.75, 1.0}
\definecolor{brightturquoise}{rgb}{0.03, 0.91, 0.87}
\definecolor{rosepink}{rgb}{1.0, 0.4, 0.8}
\definecolor{salmon}{rgb}{1.0, 0.55, 0.41}
\definecolor{princetonorange}{rgb}{1.0, 0.56, 0.0}
\definecolor{lavendermagenta}{rgb}{0.93, 0.51, 0.93}
\definecolor{lightseagreen}{rgb}{0.13, 0.7, 0.67}
\definecolor{lightfuchsiapink}{rgb}{0.98, 0.52, 0.9}
\definecolor{aliceblue}{rgb}{0.94, 0.97, 1.0}
\definecolor{caribbeangreen}{rgb}{0.0, 0.8, 0.6}
\definecolor{guppiegreen}{rgb}{0.0, 1.0, 0.5}
\definecolor{malachite}{rgb}{0.04, 0.85, 0.32}
\definecolor{lawngreen}{rgb}{0.49, 0.99, 0.0}
\definecolor{beaublue}{rgb}{0.74, 0.83, 0.9}
\definecolor{ghostwhite}{rgb}{0.97, 0.97, 1.0}
\definecolor{periwinkle}{rgb}{0.8, 0.8, 1.0}
\definecolor{lightslategray}{rgb}{0.47, 0.53, 0.6}
\definecolor{magenta(dye)}{rgb}{0.79, 0.08, 0.48}
\definecolor{oceanboatblue}{rgb}{0.0, 0.47, 0.75}
\definecolor{palemagenta}{rgb}{0.98, 0.52, 0.9}
\definecolor{robineggblue}{rgb}{0.0, 0.8, 0.8}
\definecolor{rosebonbon}{rgb}{0.98, 0.26, 0.62}

% === math ===

\usepackage{amsthm} % 定理環境とQEDコマンド
\renewcommand{\qedsymbol}{\textcolor{gray}{$\blacksquare$}}

\usepackage{mathtools}
% 別の場所で参照する数式以外は番号が付かないように
\mathtoolsset{showonlyrefs=true}

% 数学モードに変更することなくギリシャ文字を使う
% （これがないと謎にエラーになる）
\usepackage{textgreek}

% 約分のためのキャンセル線
\usepackage[thicklines]{cancel}
\renewcommand{\CancelColor}{\color{Rhodamine}}

\DeclareMathOperator{\Arg}{Arg}

\newcommand{\icvec}[1]{% inline column vector
  \left(\begin{smallmatrix}#1\end{smallmatrix}\right)%
}
\newcommand{\irvec}[1]{% inline row vector
  \begin{smallmatrix}(#1)\end{smallmatrix}%
}

% === font ===

\usepackage[T1]{fontenc}

% normal font, math font
%\usepackage[light,math]{anttor}
\usepackage{gfsartemisia}

% monospace font
\usepackage[scaled]{beramono}

% === layout ===

\usepackage{lipsum} % デバッグ用のダミーテキスト

\usepackage{setspace} % 行間調整用

\usepackage[margin=15mm]{geometry} % 余白
\renewcommand{\baselinestretch}{1.5} % 行間

\setlength{\parindent}{0pt} % 段落始めでの字下げをしない

\usepackage{here} % figure環境のHオプション（画像を強制的にその場に表示する）を提供

\usepackage{awesomebox}
\newenvironment{supplnote}{
  \begin{awesomeblock}{1pt}{\faPaw}{lightgray}
    \small
}{
  \end{awesomeblock}
}

% === tikz ===

\usepackage[dvipdfmx]{graphicx}

\usepackage{pgfplots}
\pgfplotsset{compat=1.10}
\usepgfplotslibrary{fillbetween}

\usepackage{tikz} %図を描く
\usetikzlibrary{
  positioning,
  intersections,
  calc,
  arrows.meta,
  math,
  angles,
  quotes,
  bending,
  3d,
  decorations.pathmorphing,
  decorations.pathreplacing,
  decorations.footprints,
  patterns,
  shadows,
  shapes.geometric,
  spy
}
\tikzstyle{axis}=[->, >=Stealth]
\tikzstyle{vector}=[->,>=Stealth,very thick, line cap=round]
\tikzstyle{auxline}=[dashed, thick] % 補助線
\tikzstyle{plotline}=[blue,very thick] % グラフ
\tikzstyle{zy-plane}=[canvas is zy plane at x=0]
\tikzstyle{xz-plane}=[canvas is xz plane at y=0]
\tikzstyle{xy-plane}=[canvas is xy plane at z=0]

\usepackage{tikz-3dplot}

\usepackage{witharrows} % 数式の間に矢印で説明を入れる
\usepackage{annotate-equations}

\usepackage{nl-interval} % 数直線上の区間を描く

\usepackage[outline]{contour} % 文字の縁取り

\usepackage{froufrou} % セクションを区切る装飾
\setfroufrou{dinkus}

\usepackage{halloweenmath}

% === tcolorbox ===

\usepackage{tcolorbox}
\tcbuselibrary{listings,breakable,xparse,skins,hooks,theorems}

\DeclareTColorBox{definition}{m O{} }%
{
  enhanced,
  colframe=white,
  colback=yellow!10!white,
  coltitle=cyan!40!black, 
  fonttitle=\bfseries,
  breakable=true,
  underlay unbroken={
    \begin{tcbclipinterior}
      \shade[inner color=cyan!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  underlay first={
    \begin{tcbclipinterior}
      \shade[inner color=cyan!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2.5cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}},
  underlay last={
    \begin{tcbclipinterior}
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  title={#1},
  attach title to upper=\quad,
  bottom=5mm,
  #2
}

%付箋環境~桃色バージョン~の定義
\DeclareTColorBox{theorem}{m O{} }%
{
  enhanced,
  colframe=white,
  colback=yellow!10!white,
  coltitle=magenta!40!black, 
  fonttitle=\bfseries,
  breakable,
  underlay unbroken={
    \begin{tcbclipinterior}
      \shade[inner color=magenta!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  }, 
  underlay first={
    \begin{tcbclipinterior}
      \shade[inner color=magenta!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2.5cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  underlay last={
    \begin{tcbclipinterior}
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  title={#1},
  attach title to upper=\quad, 
  bottom=5mm,
  #2
}

\definecolor{ProofColor}{HTML}{D2DAFF}
\DeclareTColorBox{proof}{m}{%
  empty,
  title={#1},
  before title={Proof:~},
  attach boxed title to top left,
  boxed title style={
    empty,
    size=minimal,
    toprule=2pt,
    top=4pt,
    overlay={
      \draw[ProofColor,line width=2pt] ([yshift=-1pt]frame.north west)--([yshift=-1pt]frame.north east);
    }
  },
  coltitle=ProofColor!70!black,
  fonttitle=\bfseries,
  before=\par\medskip\noindent,
  parbox=false,
  boxsep=0pt,
  left=1em,
  right=1.5em,
  top=2.5em,
  bottom=1em,
  breakable,
  pad at break*=0mm,
  vfill before first,
  overlay unbroken={
    \draw[ProofColor,line width=1pt, dashed] 
      ([yshift=-1pt]title.north east) 
        --([xshift=-0.5pt,yshift=-1pt]title.north-|frame.east) 
        --([xshift=-0.5pt]frame.south east)
        --(frame.south west); 
  },
  overlay first={
    \draw[ProofColor,line width=1pt, dashed]([yshift=-1pt]title.north east)--([xshift=-0.5pt,yshift=-1pt]title.north-|frame.east)--([xshift=-0.5pt]frame.south east);
  },
  overlay middle={
    \draw[ProofColor,line width=1pt, dashed] ([xshift=-0.5pt]frame.north east)--([xshift=-0.5pt]frame.south east);
  },
  overlay last={
    \draw[ProofColor,line width=1pt, dashed] ([xshift=-0.5pt]frame.north east)--([xshift=-0.5pt]frame.south east)--(frame.south west);
  },%
}

\NewDocumentCommand{\patterntitle}{m}{
  \tcbox[
    enhanced,
    empty,
    boxsep=0pt,
    left=2pt,right=2pt,
    bottom=2pt,
    fonttitle=\bfseries,
    borderline south={1pt}{0pt}{ProofColor},
  ]{\textcolor{ProofColor}{\faStarAndCrescent}~#1}
}

\newenvironment{subpattern}[1]{
  \patterntitle{#1}
  \begin{quote}
}{
  \end{quote}
}

\definecolor{mathLabelColor}{HTML}{FF87CA}
\NewDocumentCommand{\labelmath}{O{mathLabelColor!80!gray} O{red!10} m m}{
  \tcboxmath[
    enhanced,
    frame hidden,
    colback={#2},
    opacityback=0.6,
    title={#4},
    coltitle={#1},
    fonttitle=\bfseries,
    attach boxed title to top right={yshift=-0.5mm},
    boxed title style={empty, top=0mm, bottom=0mm}
  ]{#3}
}
% 余白少なめバージョン
\NewDocumentCommand{\fitLabelMath}{O{mathLabelColor!80!gray} O{red!10} O{0.6} m m}{
  \tcboxmath[
    enhanced,
    frame hidden,
    colback={#2},
    opacityback={#3},
    title={#5},
    coltitle={#1},
    fonttitle=\bfseries,
    left=1pt, right=1pt, top=1pt, bottom=1pt,
    attach boxed title to top center={yshift=-0.5mm},
    boxed title style={empty, top=0mm, bottom=0mm}
  ]{#4}
}

\NewDocumentCommand{\wavemath}{O{Rhodamine} m}{
  \tcboxmath[
    enhanced,
      frame hidden,
      interior hidden,
      size=minimal,
      bottom=1.1em,
      overlay={
          \draw[
              #1,
              thick,
              decorate,
              decoration={
                  snake,               % 波線を引く
                  amplitude=0.1em,     % 波線の振幅
                  segment length=0.5em   % 波線の周期
              }
          ] ([yshift=0.7em]frame.south west) -- ([yshift=0.7em]frame.south east);
      } 
    ]{#2}
}

\NewDocumentCommand{\wavelabelmath}{O{Rhodamine} m m}{
  \tcboxmath[
    enhanced,
      frame hidden,
      interior hidden,
      size=minimal,
      bottom=1.4em,
      overlay={
          \draw[
              #1,
              thick,
              decorate,
              decoration={
                  snake,               % 波線を引く
                  amplitude=0.1em,     % 波線の振幅
                  segment length=0.5em   % 波線の周期
              }
          ] ([yshift=1.1em]frame.south west) -- ([yshift=1.1em]frame.south east)
          node[midway,below] {\bfseries #3};
      }
    ]{#2}
}

\definecolor{reviewBgColor}{HTML}{F9F9F9}
\definecolor{reviewFgColor}{HTML}{6886C5}
\newtcolorbox{review}{
  colback=reviewBgColor,
  colbacktitle=reviewFgColor,
  title=REVIEW,
  enhanced,
  attach boxed title to top left={yshift=-0.18cm,xshift=-0.5mm},
  boxed title style={
    tikz={rotate=4,transform shape},
    frame code={
      \draw[decorate, reviewFgColor,decoration={random steps,segment length=2mm,amplitude=0.6pt},fill=lightgray!20] (frame.south west) rectangle (frame.north east);
    }
  },
frame code={
  \draw[decorate, reviewFgColor!50,decoration={random steps,segment length=2mm,amplitude=0.6pt}] (frame.north east) rectangle (frame.south west);
},
}

\DeclareTColorBox{emphabox}{O{CadetBlue}}{%
  enhanced,
  breakable,
  interior hidden,
  frame hidden,
  grow sidewards by=-5mm,
  beforeafter skip=\baselineskip,
  frame code={%
    \draw[line width=1pt,#1] ($(frame.north west)!0.3!(frame.north east)$) -- (frame.north west) -- ($(frame.north west)!0.3!(frame.south west)$);
    \draw[line width=1pt,#1] ($(frame.south east)!0.3!(frame.south west)$) -- (frame.south east) -- ($(frame.south east)!0.3!(frame.north east)$);
    \draw[rosepink, fill=carnationpink, decorate, decoration={footprints,foot length=7pt,foot of=felis silvestris, foot angle=5, foot sep=2pt}] ($(frame.south east)!0.3!(frame.south west)$) -- (frame.south east);
  }
}

\DeclareTColorBox{spacebox}{}{%
  enhanced,
  breakable,
  interior hidden,
  frame hidden,
  grow sidewards by=-5mm,
  beforeafter skip=\baselineskip,
}

% === shotcut ===

% WIPマークを表示
\newcommand{\wip}{
  \begin{center}
    \vspace{1em}
    \scalebox{2.5}{\textcolor{lightgray}{$\xrightswishingghost{\text{Under construction}\ldots}$}}
  \end{center}
}

% definition,theorem環境内で用語を強調表示する
\definecolor{hlcolor}{HTML}{F9F07A}
\NewDocumentCommand{\hl}{O{hlcolor} m}{\hspace{0.25em}\textcolor{#1!40!black}{\textbf{#2}}\hspace{0.25em}}

% 偶関数に背景色とラベルをつける
\NewDocumentCommand{\evenFn}{O{0.6} m}{
  \fitLabelMath[pink][pink][#1]{#2}{偶}
}
% 奇関数に背景色とラベルをつける
\NewDocumentCommand{\oddFn}{O{0.6} m}{
  \fitLabelMath[cyan][cyan!30][#1]{#2}{奇}
}

% 元の関数と導関数の区別をつける
\NewDocumentCommand{\origFn}{O{0.6} m}{
  \fitLabelMath[cyan][cyan!30][#1]{#2}{元の関数}
}
\NewDocumentCommand{\derivFn}{O{0.6} m}{
  \fitLabelMath[magenta!70][magenta!30][#1]{#2}{導関数}
}

% ---

\begin{document}



\end{document}