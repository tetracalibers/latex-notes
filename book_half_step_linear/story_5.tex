\documentclass[../book_half_step_linear]{subfiles}

\begin{document}

\section{行列の積を解釈する}

\subsection{まずは基本的な定義を形式的に把握}

ベクトルは数が一方向にならんだものだったが、\keyword{行列}は数が平面的にならんだもの

\br

行列に対してベクトルと同じようにスカラー倍や和の演算を定義して、行列同士を行き来できるようになる

さらに行列には掛け算、つまり積を定義できる

積は行列のサイズを変えうるため、スカラー倍や和とは異なるもの

\br

$L \times M$行列$A$と$M \times N$行列$B$の積を考える

これらの積により、$L \times N$行列$C$が作られる

作られる行列$C$の$l$行目かつ$n$列目の要素は、左側の行列$A$の$l$行目の「行」すべての要素と、右側の行列$B$の$n$列目の「列」すべての要素の掛け算、そしてその総和で作られる

\br

なお、左側の「列」のサイズと右側の「行」のサイズが一致していないと、積が定義されないこともわかる

今の例では左側の行列$A$のサイズが$L \times M$、右側の$B$が$M \times N$なので、サイズ$M$が一致している

\br

また、できあがる行列の行のサイズは左側の行のサイズと一致し、列のサイズは右側の列のサイズと一致する

今の例では$L \times N$になる

\sectionline
\subsection{途中の全経路を考えることで積を与える}

行列積$C=AB$に対して、左辺の行列$C$の$l$行$n$列成分を、「行列$A$の$l$（行目）を左端、行列$B$の$n$（列目）を右端とする経路を足し合わせたもの」と解釈する

実際に、1つ目の経路を$a_{l1}b_{1n}$、2つ目を$a_{l2}b_{2n}$などとしていくと、これらの足し算が$C_{ln}$を与えることがわかる

なお、どの経路を使っても$l$と$n$を結ぶことができるので、途中の経由点$m$としては$1$から$M$までを、つまりすべての経路を考える

$c_{ln}$を$l$と$n$を結ぶ経路と考えることで、記号的な行列積の定義を「途中の経路の総和」のようなイメージで捉えられる

\br

なお、確率的な現象を扱う場合には、行列の要素に「確率」の意味合いが出てくるため、この経路にさらに深い意味合いをもたせることができる

\sectionline
\subsection{観測装置を経由して捉える}

ブラケット記号を使って行列積を捉えてみる

ここでは例として$2\times 2$行列$A$と$2\times 1$行列$\ket{\vb*{x}}$の行列積を考える

$\ket{\vb*{x}}$は列ベクトルだが、$2\times 1$行列としても捉えられる

なお、行列積の結果としては$2\times 1$行列、つまり列ベクトルが出てくるはず

\br

まず、$A$を「2つの行ベクトル$\bra{\vb*{a}_1}$と$\bra{\vb*{a}_2}$がならんだもの」と解釈する
\begin{equation*}
  A = \begin{bmatrix}
    a_{11} & a_{12} \\
    a_{21} & a_{22}
  \end{bmatrix} = \mqty[\bra{\vb*{a}_1} \\ \bra{\vb*{a}_2}]
\end{equation*}
すると、「（要素が行ベクトルである）列ベクトル」を考えられる

\br

ここで一次結合のときの話を思い出すと、列ベクトルはある基底を用いた場合の係数をならべたものだった

つまり、その基底に関する座標である

今は素朴に\keyword{標準基底}と呼ばれるもの、すなわち、
\begin{equation*}
  \Ket{\vb*{e}_1} = \mqty[1 \\ 0], \quad \Ket{\vb*{e}_2} = \mqty[0 \\ 1]
\end{equation*}
を基底とする

標準基底$\ket{\vb*{e}_i}$は$i$番目の要素だけ$1$、それ以外は$0$の列ベクトル

これで一次結合の形が出る
\begin{equation*}
  A = \mqty[\bra{\vb*{a}_1} \\ \bra{\vb*{a}_2}] = \mqty[\Ket{\vb*{a}_1} \\ 0] + \mqty[0 \\ \Ket{\vb*{a}_2}] = \Ket{\vb*{e}_1} \bra{\vb*{a}_1} + \Ket{\vb*{e}_2} \bra{\vb*{a}_2}
\end{equation*}
内積として解釈されるのを避けるため、$\bra{\vb*{a}_i}$を$\ket{\vb*{e}_i}$の右側に書いた

\br

この形で書いた行列$A$と$\ket{\vb*{x}}$の積を計算すると、
\begin{align*}
  A\ket{\vb*{x}} & = \biggl( \Ket{\vb*{e}_1} \bra{\vb*{a}_1} + \Ket{\vb*{e}_2} \bra{\vb*{a}_2} \biggr) \ket{\vb*{x}}                             \\
                 & = \biggl( \Braket{\vb*{a}_1 | \vb*{x}} \biggr) \Ket{\vb*{e}_1} + \biggl( \Braket{\vb*{a}_2 | \vb*{x}} \biggr) \Ket{\vb*{e}_2} \\
                 & = \mqty[\Braket{\vb*{a}_1 | \vb*{x}}                                                                                          \\  \Braket{\vb*{a}_2 | \vb*{x}}] \\
                 & = \begin{bmatrix}
                       a_{11}x_1 + a_{12}x_2 \\
                       a_{21}x_1 + a_{22}x_2
                     \end{bmatrix}
\end{align*}
途中で$\braket{\vb*{a}_1|\vb*{x}}$がスカラー、つまり単なる値なので$\ket{\vb*{e}_1}$の前に出せることなども使った

\br

ここで、内積$\braket{\vb*{a}_i|\vb*{x}}$に注目しよう

内積の解釈の一つに、素朴に転置した行ベクトルと列ベクトルの掛け算というものがあった

ただ、状態$\ket{\vb*{x}}$を観測装置$\bra{\vb*{a}_1}$で観測する、という解釈もできるのだった

つまり、1つの状態$\ket{\vb*{x}}$を、2つの観測装置$\bra{\vb*{a}_1}$と$\bra{\vb*{a}_2}$で観測して、それぞれの結果を使ってまた一次結合をとったベクトルに写す、と解釈できる

\sectionline

ベクトルは、注目している対象の情報を含んでいる

そして、行列は「ベクトルをほかのベクトルに変換すること」、つまり「情報を処理すること」に対応する

\sectionline
\subsection{行列に割り算はない}

通常の実数の計算には「割り算」がある

何かを掛け算したものの、元に戻したいときには割り算が使える

\br

しかし、行列には割り算が定義されていない

\keyword{逆行列}はあるが、これは割り算ではなく、掛け算をすると単位行列を与える特別な関係にある行列である

\sectionline
\subsection{逆行列と、逆行列が存在する条件}

$D\times D$行列$A$に対して、
\begin{equation*}
  AX = XA = I
\end{equation*}
を満たす行列が「存在する場合」を考える

\br

ここで$I$は単位行列で、対角成分はすべて$1$、それ以外は$0$である

なお、単位行列の各要素を、
\begin{equation*}
  I_{ij} = \delta_{ij} = \begin{cases}
    1 & (i=j)              \\
    0 & (\text{otherwise})
  \end{cases}
\end{equation*}
と書くこともある

ここで使われている$\delta_{ij}$は\keyword{クロネッカーのデルタ}の記号

\br

式$AX = XA = I$が満たされる場合に、$X$を$A$の\keyword{逆行列}と呼び、$A^{-1}$と書く

なお、$A^{-1}$の逆行列は$\left( A^{-1} \right)^{-1} = A$である

\br

また、$AX$と$XA$の両方の掛け算が成立するためには、$A$の行と列のサイズが同じ、つまり\keyword{正方行列}である必要がある

\br

ここで、正方行列だからといって逆行列が必ずしも存在するわけではない、ということに注意

行列が逆行列をもつとき、\keyword{正則}であると言う

\br

行列が正則であるための条件として、たとえば行列の各列（各行でも可）をベクトルとみなしたとき、それらが一次独立である、というものがある

この条件を言い換えた別の条件もいくつかある

\sectionline
\subsection{行列の転置}

行列$A=[a_{ij}]$に対して、その\keyword{転置行列}は$A^\top=[a_{ji}]$である

成分の順番が変わっていて、列と行をばたんと入れ替えるイメージ

\br

$N\times 1$行列、つまり列ベクトルの転置は、$1\times N$行列、つまり行ベクトルになる

\section{ベクトルを別のベクトルに変換する}

\subsection{抽象的な操作でも線形なら行列で表せる}

画像を回転する、拡大縮小する…世の中にはさまざまな操作がある

多くの操作は行列で表現できる

「多くの」の意味を厳密にいうと、\keyword{線形性}を持つ操作であれば、ということ

\br

ベクトルを別のベクトルに写す関数で線形性をもつものを\keyword{線形写像}と呼ぶ

線形な操作は必ず行列で表現できる

\br

何かしら対象とする操作があり、それを具体的に「数がならんだ」行列として表現することにより、計算機を使った処理が可能になる

それが線形代数の強み

\sectionline
\subsection{行列は線形写像を与える、逆もまた然り}

$A \in \mathbb{R}^{M \times N}$および$\vb*{x} \in \mathbb{R}^N$を考えて、関数$f(\vb*{x})$を$f(\vb*{x}) = A\vb*{x}$と定義する

この関数が線形性を満たすことは、行列のスカラー倍と和の性質から簡単に示せる

逆に、線形性を満たす関数であれば行列で表現できることの証明もそれほど難しくはない

\sectionline
\subsection{操作の順番を変えると結果が変わる}

次のような回転の操作と軸対称の操作を考える
\begin{enumerate}[label={[\arabic*]}]
  \item $90^\circ$反時計回りに回転$\to$ $x$軸について対称な点に写す
  \item $x$軸について対称な点に写す$\to$ $90^\circ$反時計回りに回転
\end{enumerate}

[1]と[2]の操作を実際にやってみると、明らかに、最後に得られる点の座標が異なる

操作の順番を変えると結果が変わるのは、よくあること

\br

行列は、操作を与える

その行列を使った計算でも、この順番の違いが生み出されることを確認できる

行列の積の順番を変えて結果が変わることを\keyword{非可換性}という

実際の掛け算では非可換性は出てこないが、非可換性を扱える行列ならば、世の中の自然な操作を表現できそう…という気がする

\sectionline
\subsection{非可換性を具体的な行列計算で眺める}

2次元平面において、角度$\theta$だけ回転させる行列を$R_\theta$、$x$軸について対称な点に写す操作の行列を$A$とすると、
\begin{equation*}
  R_\theta = \begin{bmatrix}
    \cos\theta & -\sin\theta \\
    \sin\theta & \cos\theta
  \end{bmatrix}, \quad
  A       = \begin{bmatrix}
    1 & 0  \\
    0 & -1
  \end{bmatrix}
\end{equation*}
と書ける

なお、ここでの議論は標準基底を使ったもの

\br

今、ベクトル$\ket{\vb*{x}}$について[1]の順番で操作してみる

最初に回転させることは$R_\theta\ket{\vb*{x}}$に対応する

そのあとで軸対称をとるので、最終的に得られる点は$A(R_\theta\ket{\vb*{x}}) = A R_\theta \ket{\vb*{x}}$である

つまり[1]の操作は$AR_\theta$で与えられる

同様に、[2]の操作は$R_\theta A$である

\br

実際に行列積をとると、
\begin{align*}
  AR_\theta  & = \begin{bmatrix}
                   \cos\theta  & -\sin\theta \\
                   -\sin\theta & -\cos\theta
                 \end{bmatrix} \\
  R_\theta A & = \begin{bmatrix}
                   \cos\theta  & \sin\theta  \\
                   -\sin\theta & -\cos\theta
                 \end{bmatrix}
\end{align*}
なので、操作そのものが異なることがわかる

\br

これらの行列をベクトルにかけ算すると、2つの操作後のベクトルが得られる

当然、結果として得られるベクトルは異なる

これが非可換性の影響

\sectionline
\subsection{線形写像と線形変換と逆行列}

ここでの例は2次元平面、つまり2次元の線形空間の点を、同じ空間内の別の空間に写していた

同じ空間内での操作、つまり線型写像のことを特に\keyword{線形変換}と呼ぶことがある

\br

「変換」は、同じ空間内で行き来する、というイメージ

ということは、「変換」ではない場合には、線形写像は空間のサイズが変わってもかまわない

\br

実際、$A \in \mathbb{R}^{M \times N}$および$\vb*{x} \in \mathbb{R}^N$に対して線形写像$f(\vb*{x}) = A\vb*{x}$を考えたが、写す前の空間と写した後の空間の次元が異なる

線形写像を行列で表現したときの行と列のサイズに、写した後と写す前の空間の次元が反映される

\sectionline

そもそも逆行列をもつためには正方行列、つまり行と列が同じサイズである必要があった

「写して、戻す」で元に戻るためには同じ空間である必要がある

\br

たとえば今より小さい次元の空間に写してしまうと、すべての点を一対一対応させるわけにはいかない

いくつかの点を、次元の小さな空間の同じ点に対応させる必要があるので、逆向きの操作で戻すときにどの点に戻すべきなのか、困ってしまう

\br

このことから、正方行列でないと逆行列をもち得ないことがわかる
（もちろん、正方行列だからといって必ずしも逆行列をもつわけではない）

\sectionline
\subsection{考える基底が変われば操作の表現も変わる}

抽象的なものを具体的に表現するための道具が\keyword{行列}

そもそも、基底を変えればベクトルの表現、つまり座標が変わる

そして当然のことだが、ベクトルを表現するための基底が変われば、操作を与える具体的な行列も変わる

計算の都合のために「よい基底」を選ぶこと、そして、操作のための「よい行列」を選ぶことはとても大切

\sectionline

基底で表現が変わることの例を見ておこう

$\ket{\vb*{x}}$を表現するために、次の2つの基底を考える
\begin{enumerate}[label={[\arabic*]}]
  \item 基底として$\{ \vb*{u}_1, \vb*{u}_2 \}$：$\ket{\vb*{x}} = 3\ket{\vb*{u}_1} + 2\ket{\vb*{u}_2}$
  \item 基底として$\{ \vb*{a}_1, \vb*{a}_2 \}$：$\ket{\vb*{x}} = -5\ket{\vb*{a}_1} + 2\ket{\vb*{a}_2}$
\end{enumerate}
基底が変われば一次結合の係数、つまり座標が変わる

\br

さて、与えられたベクトル$\ket{\vb*{x}}$について$\ket{\vb*{u}_1}$方向にどれだけ伸びているか、つまり横方向にどれだけの成分をもっているのかを抽出して、$\ket{\vb*{u}_1}$方向のベクトルに写す操作を考える

結果だけ書くと、基底[1]および[2]の場合の操作をそれぞれ$A_{[1]}, \, A_{[2]}$として、
\begin{equation*}
  A_{[1]} = \begin{bmatrix}
    1 & 0 \\
    0 & 0
  \end{bmatrix}, \quad
  A_{[2]} = \begin{bmatrix}
    -1 & -1 \\
    0  & 0
  \end{bmatrix}
\end{equation*}
となる

この行列を$\ket{\vb*{x}}$を表す座標に作用させると、1行目の成分に$\ket{\vb*{u}_1}$方向にどれだけ進むかが入り、2行目はゼロとなる

\br

このように、基底が変われば、抽象的な操作を表す行列も変わる

抽象的な操作を具体的な基底を使って表現した行列のことを\keyword{表現行列}と呼ぶ

\sectionline
\subsection{基底変換の一般的な話}



\end{document}
