\documentclass[b5paper]{book}

\usepackage{subfiles}

\title{Imaging Math for non-mathematicians}
\author{tomixy}

% === color ===

\usepackage[dvipsnames]{xcolor}

\definecolor{myPurple}{HTML}{CDC1FF}
\definecolor{electriclavender}{rgb}{0.96, 0.73, 1.0}
\definecolor{electricpurple}{rgb}{0.75, 0.0, 1.0}
\definecolor{heliotrope}{rgb}{0.87, 0.45, 1.0}
\definecolor{hotpink}{rgb}{1.0, 0.41, 0.71}
\definecolor{carnationpink}{rgb}{1.0, 0.65, 0.79}
\definecolor{deeppink}{rgb}{1.0, 0.08, 0.58}
\definecolor{deepskyblue}{rgb}{0.0, 0.75, 1.0}
\definecolor{fuchsiapink}{rgb}{1.0, 0.47, 1.0}
\definecolor{electricblue}{rgb}{0.49, 0.98, 1.0}
\definecolor{capri}{rgb}{0.0, 0.75, 1.0}
\definecolor{brightturquoise}{rgb}{0.03, 0.91, 0.87}
\definecolor{rosepink}{rgb}{1.0, 0.4, 0.8}
\definecolor{salmon}{rgb}{1.0, 0.55, 0.41}
\definecolor{princetonorange}{rgb}{1.0, 0.56, 0.0}

% === extend ===

\usepackage{xparse}%オプション（省略可能引数）をもつコマンド作成

% === math ===

\usepackage{mathtools}
% 別の場所で参照する数式以外は番号が付かないように
\mathtoolsset{showonlyrefs=true}

% 約分のためのキャンセル線
\usepackage[thicklines]{cancel}
\renewcommand{\CancelColor}{\color{Rhodamine}}

\DeclareMathOperator{\Arg}{Arg}

\newcommand{\icvec}[1]{% inline column vector
  \left(\begin{smallmatrix}#1\end{smallmatrix}\right)%
}
\newcommand{\irvec}[1]{% inline row vector
  \begin{smallmatrix}(#1)\end{smallmatrix}%
}

% === font ===

\usepackage[T1]{fontenc}

% normal font, math font
%\usepackage[light,math]{anttor}
\usepackage{gfsartemisia}

% monospace font
\usepackage[scaled]{beramono}

% === layout ===

\usepackage{setspace} % 行間調整用

\usepackage[margin=15mm]{geometry} % 余白
\renewcommand{\baselinestretch}{1.5} % 行間

\setlength{\parindent}{0pt} % 段落始めでの字下げをしない

\usepackage{here} % figure環境のHオプション（画像を強制的にその場に表示する）を提供

\usepackage{awesomebox}
\newenvironment{supplnote}{
  \begin{awesomeblock}{1pt}{\faPaw}{lightgray}
    \small
}{
  \end{awesomeblock}
}

% === tikz ===

\usepackage[dvipdfmx]{graphicx}

\usepackage{pgfplots}
\pgfplotsset{compat=1.10}
\usepgfplotslibrary{fillbetween}

\usepackage{tikz} %図を描く
\usetikzlibrary{
  positioning,
  intersections,
  calc,
  arrows.meta,
  math,
  angles,
  quotes,
  bending,
  3d,
  decorations.pathmorphing,
  decorations.pathreplacing,
  patterns,
  shadows,
  shapes.geometric,
  spy
}
\tikzstyle{axis}=[->, >=Stealth]
\tikzstyle{vector}=[->,>=Stealth,very thick, line cap=round]
\tikzstyle{auxline}=[dashed, thick] % 補助線
\tikzstyle{plotline}=[blue,very thick] % グラフ
\tikzstyle{zy-plane}=[canvas is zy plane at x=0]
\tikzstyle{xz-plane}=[canvas is xz plane at y=0]
\tikzstyle{xy-plane}=[canvas is xy plane at z=0]

\usepackage{tikz-3dplot}

\usepackage{witharrows} % 数式の間に矢印で説明を入れる
\usepackage{annotate-equations}

\usepackage[outline]{contour} % 文字の縁取り

\usepackage{froufrou} % セクションを区切る装飾
\setfroufrou{dinkus}

% === tcolorbox ===

\usepackage{tcolorbox}
\tcbuselibrary{listings,breakable,xparse,skins,hooks,theorems}

\DeclareTColorBox{definition}{m O{} }%
{
  enhanced,
  colframe=white,
  colback=yellow!10!white,
  coltitle=cyan!40!black, 
  fonttitle=\bfseries,
  breakable=true,
  underlay unbroken={
    \begin{tcbclipinterior}
      \shade[inner color=cyan!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  underlay first={
    \begin{tcbclipinterior}
      \shade[inner color=cyan!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2.5cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}},
  underlay last={
    \begin{tcbclipinterior}
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  title={#1},
  attach title to upper=\quad,
  bottom=5mm,
  #2
}

%付箋環境~桃色バージョン~の定義
\DeclareTColorBox{theorem}{m O{} }%
{
  enhanced,
  colframe=white,
  colback=yellow!10!white,
  coltitle=magenta!40!black, 
  fonttitle=\bfseries,
  breakable,
  underlay unbroken={
    \begin{tcbclipinterior}
      \shade[inner color=magenta!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  }, 
  underlay first={
    \begin{tcbclipinterior}
      \shade[inner color=magenta!80!yellow,outer color=yellow!10!white] (interior.north east) circle (2.5cm);
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  underlay last={
    \begin{tcbclipinterior}
      \draw[help lines,step=5mm,yellow!80!black,shift={(interior.north west)}] (interior.south west) grid (interior.north east);
    \end{tcbclipinterior}
  },
  title={#1},
  attach title to upper=\quad, 
  bottom=5mm,
  #2
}

\definecolor{ProofColor}{HTML}{fbfbfb}
\DeclareTColorBox{proof}{O{}}{
  enhanced,
  title={Proof},
  coltitle=magenta!60!white,
  attach boxed title to top left={
    xshift=0mm, yshift*=-\tcboxedtitleheight/2,
  },
  colback={ProofColor},
  boxed title style={
    colback=ProofColor,
    boxrule=0pt,
    frame hidden,
  },
  boxrule=0pt,
  frame hidden,
  left=5mm,
  breakable,
  overlay={
    \draw[line width=5pt,magenta!40!white,opacity=0.2]
      ([shift={(3mm,-\tcboxedtitleheight/2)}]interior.north west) 
        -- ([shift={(3mm,\tcboxedtitleheight/2)}]interior.south west);
    }
}

\definecolor{mathLabelColor}{HTML}{FF87CA}
\NewDocumentCommand{\labelmath}{O{mathLabelColor!80!gray} O{red!10} m m}{
  \tcboxmath[
    enhanced,
    frame hidden,
    colback={#2},
    opacityback=0.6,
    title={#4},
    coltitle={#1},
    fonttitle=\bfseries,
    attach boxed title to top right={yshift=-0.5mm},
    boxed title style={empty, top=0mm, bottom=0mm}
  ]{#3}
}
% 余白少なめバージョン
\NewDocumentCommand{\fitLabelMath}{O{mathLabelColor!80!gray} O{red!10} O{0.6} m m}{
  \tcboxmath[
    enhanced,
    frame hidden,
    colback={#2},
    opacityback={#3},
    title={#5},
    coltitle={#1},
    fonttitle=\bfseries,
    left=1pt, right=1pt, top=1pt, bottom=1pt,
    attach boxed title to top center={yshift=-0.5mm},
    boxed title style={empty, top=0mm, bottom=0mm}
  ]{#4}
}

\definecolor{reviewBgColor}{HTML}{F9F9F9}
\definecolor{reviewFgColor}{HTML}{6886C5}
\newtcolorbox{review}{
  colback=reviewBgColor,
  colbacktitle=reviewFgColor,
  title=REVIEW,
  enhanced,
  attach boxed title to top left={yshift=-0.18cm,xshift=-0.5mm},
  boxed title style={
    tikz={rotate=4,transform shape},
    frame code={
      \draw[decorate, reviewFgColor,decoration={random steps,segment length=2mm,amplitude=0.6pt},fill=lightgray!20] (frame.south west) rectangle (frame.north east);
    }
  },
frame code={
  \draw[decorate, reviewFgColor!50,decoration={random steps,segment length=2mm,amplitude=0.6pt}] (frame.north east) rectangle (frame.south west);
},
}

% === shotcut ===

% definition,theorem環境内で用語を強調表示する
\definecolor{hlcolor}{HTML}{F9F07A}
\NewDocumentCommand{\hl}{O{hlcolor} m}{\hspace{0.25em}\textcolor{#1!40!black}{\textbf{#2}}\hspace{0.25em}}

% 偶関数に背景色とラベルをつける
\NewDocumentCommand{\evenFn}{O{0.6} m}{
  \fitLabelMath[pink][pink][#1]{#2}{偶}
}
% 奇関数に背景色とラベルをつける
\NewDocumentCommand{\oddFn}{O{0.6} m}{
  \fitLabelMath[cyan][cyan!30][#1]{#2}{奇}
}

% 元の関数と導関数の区別をつける
\NewDocumentCommand{\origFn}{O{0.6} m}{
  \fitLabelMath[cyan][cyan!30][#1]{#2}{元の関数}
}
\NewDocumentCommand{\derivFn}{O{0.6} m}{
  \fitLabelMath[magenta!70][magenta!30][#1]{#2}{導関数}
}

% === hyperlink ===

% 「%」は以降の内容を「改行コードも含めて」無視するコマンド
\usepackage[%
  dvipdfmx,% 欧文ではコメントアウトする
  setpagesize=false,%
  bookmarks=true,%
  bookmarksdepth=tocdepth,%
  bookmarksnumbered=true,%
  colorlinks=true,%
  allcolors=MidnightBlue,%
  pdftitle={},%
  pdfsubject={},%
  pdfauthor={},%
  pdfkeywords={}%
]{hyperref}
% PDFのしおり機能の日本語文字化けを防ぐ((u)pLaTeXのときのみかく)
\usepackage{pxjahyper}

% ---

\begin{document}

\maketitle
\tableofcontents

\subfile{math/basic}
\subfile{math/calculus}
\subfile{math/complex}
\subfile{math/fourier}
\subfile{math/linear_system}

\end{document}
