\documentclass[../math-imaging]{subfiles}

\begin{document}

\chapter{複素数と複素関数}

\section{虚数の導入}

\subsection{$x^2 = -1$の解は存在するか？}

「負の数と負の数をかけたら正の数になる」というのが、中学校で初めて数学の門を叩いて真っ先に学ぶ事実である。

\begin{equation}
  (-1) \times (-1) = 1
\end{equation}

方程式の言葉で書けば、$x^2 = 1$の解の一つは$x = -1$となる。（もう一つの解は$x = 1$だ。）

では、次の方程式の解は考えられるだろうか？

\begin{equation}
  x^2 = -1
\end{equation}

$x^2$ということは、同じ数$x$どうしをかけて$-1$にならなければならない。

とはいえ、正の数どうしをかけても正の数になるし、負の数どうしをかけても正の数になる。

\vskip\baselineskip

つまり、このような$x$は「存在しない」ということになる。

しかし、このような方程式の解が存在した方がありがたいと考えた人もいた。（私たちもこの先、その有り難さを知ることになる。）

\vskip\baselineskip

「負の数と負の数をかけたら正の数になる」というこれまでの数の体系を壊さずに、$x^2 = -1$が成り立つような数を新たに考えよう、という話が始まる。

\subsection{回転で捉える数直線の拡張}

これまでの数の体系である実数は、すべて数直線上に存在していた。

\begin{center}
  \begin{tikzpicture}
    \def\len{4}
    \draw[->] (-\len,0) -- (\len,0) node[right] {$\mathbb{R} $};
    \foreach \x in {-1,0,1} {
        \draw (\x*2,0.1) -- (\x*2,-0.1) node[below] {$\x$};
      }
  \end{tikzpicture}
\end{center}

$x^2 = -1$の解となる$x$は、少なくともこの数直線上には存在しない。

ならば、数の体系を平面に拡張して考えてみよう。

\vskip\baselineskip

まずは、平面というスケールに飛び出して$(-1) \times (-1) = 1$を考えてみる。

\begin{equation}
  1 \times (-1) \times (-1) = 1
\end{equation}

と書き直すと、「$-1$を$2$回かけたら$1$に戻る」ということがいえる。

図示すると、次のようなことが起こっていると考えられないだろうか？

\begin{center}
  \begin{tikzpicture}
    \def\len{4}
    \def\scale{2}

    % 180度回転を表す円弧 (1,0) to (-1,0)
    \draw[->,-{Stealth[length=1em, open, round]}, shorten >=1em, shorten <=1em, thick, cyan] (\scale,0) arc (0:180:\scale) node[above, midway] {$\times$\large$(-1)$};
    \draw[<-,{Stealth[length=1em, open, round]}-, shorten >=1em, shorten <=1em, thick, cyan] (\scale,0) arc (0:-180:\scale) node[below, midway] {$\times$\large$(-1)$};

    \draw[->] (-\len,0) -- (\len,0) node[right] {$\mathbb{R} $};

    \def\h{0.1}
    \draw (\scale, \h) -- (\scale,-\h) node[below right] {$1$};
    \draw (-\scale, \h) -- (-\scale,-\h) node[below left] {$-1$};

    % 0
    \draw (0, \h) -- (0,-\h) node[below] {$0$};
  \end{tikzpicture}
\end{center}

「$-1$をかける」という操作を、平面上の$180$度回転と捉える。

すると、$2$回かけて$-1$になる数（$x^2 = -1$の解）は、$180$度回転の中間に位置する数と考えることができる。

\begin{center}
  \begin{tikzpicture}
    \def\len{4}
    \def\scale{2}

    % 90度回転を表す円弧
    \draw[->,-{Stealth[length=1em, open, round]}, shorten >=1em, shorten <=1em, thick, magenta] (\scale,0) arc (0:90:\scale) node[above right, midway] {$\times$\Large$?$};
    % さらに90度回転を表す円弧
    \draw[->,-{Stealth[length=1em, open, round]}, shorten >=1em, shorten <=1em, thick, magenta] (0, \scale) arc (90:180:\scale) node[above left, midway] {$\times$\Large$?$};

    \draw[->] (-\len,0) -- (\len,0) node[right] {$\mathbb{R} $};
    \draw[->, dotted] (0,-\len) -- (0,\len);

    \def\h{0.1}
    \draw (\scale, \h) -- (\scale,-\h) node[below] {$1$};
    \draw (-\scale, \h) -- (-\scale,-\h) node[below] {$-1$};

    % 0
    \draw (0, \h) -- (0,-\h) node[below] {$0$};

    \node[fill=white] at (0, \scale) {\large$?$};
  \end{tikzpicture}
\end{center}

このような方向性で拡張した数を複素数といい、$?$にあたる数は虚数$i$と呼ぶことにする。

\begin{center}
  \begin{tikzpicture}
    \def\len{4}
    \def\scale{2}

    % 90度回転を表す円弧
    \draw[->,-{Stealth[length=1em, open, round]}, shorten >=1em, shorten <=1em, thick, magenta] (\scale,0) arc (0:90:\scale) node[above right, midway] {$\times$\Large$i$};
    % さらに90度回転を表す円弧
    \draw[->,-{Stealth[length=1em, open, round]}, shorten >=1em, shorten <=1em, thick, magenta] (0, \scale) arc (90:180:\scale) node[above left, midway] {$\times$\Large$i$};

    \draw[->] (-\len,0) -- (\len,0) node[right] {$\mathbb{R}$};
    \draw[->, gray] (0,-\len) -- (0,\len) node [above] {$\mathbb{R}i$};

    \def\h{0.1}
    \draw (\scale, \h) -- (\scale,-\h) node[below] {$1$};
    \draw (-\scale, \h) -- (-\scale,-\h) node[below] {$-1$};

    % O
    \draw (0, \h) -- (0,-\h) node[below] {$0$};

    \node[fill=white] at (0, \scale) {\large$i$};
  \end{tikzpicture}
\end{center}

\subsection{虚数の定義}

前節での話を踏まえて、新たな数を次のように定義する。

\begin{definition}{虚数}
  方程式$x^2 =-1$の解の一つを\hl{虚数}と呼び、$i$と表す。
\end{definition}

これで、$x^2 = -1$の解を、次のように記述できるようになった。

\begin{theorem}{$x^2 = -1$の解}
  方程式$x^2 = -1$の解は、$x= i$と$x=-i$の$2$つ存在する。
\end{theorem}

\section{複素数の表現}

\subsection{複素数と複素平面}

前章では、数直線上の$1$から$90$度回転したところに、虚数$i$という数が存在するという考え方を導入した。

このような平面において、実数が存在する軸（お馴染みの数直線）を実軸Re、虚数が存在する軸を虚軸Imと呼ぶことにする。

\begin{center}
  \begin{tikzpicture}
    \def\len{4}
    \def\scale{2}

    \draw[->] (-\len,0) -- (\len,0) node[right] {Re};
    \draw[->] (0,-\len) -- (0,\len) node [above] {Im};

    \def\h{0.1}
    \draw (\scale, \h) -- (\scale,-\h) node[below] {$1$};
    \draw (-\scale, \h) -- (-\scale,-\h) node[below] {$-1$};
    % i
    \draw (\h, \scale) -- (-\h,\scale) node[left] {$i$};
    % -i
    \draw (\h, -\scale) -- (-\h,-\scale) node[left] {$-i$};

    % O
    \draw (0, \h) -- (0,-\h) node[below left] {$O$};
  \end{tikzpicture}
\end{center}

では、実軸上にも虚軸上にもない、平面上の点に位置する数は、どう表せばよいだろうか？

平面上の点をベクトル（矢印）で表す考え方を流用して、次のように考えてみる。

\begin{center}
  \scalebox{1.25}{
    \begin{tikzpicture}[
        txtnode/.style={text height=0.75em},
      ]
      \def\ang{35} % 偏角
      \def\r{3} % 半径

      % x軸の描画
      \draw [->] (-1,0) -- (4,0) node[right] {Re};
      % y軸の描画
      \draw [->] (0,-1) -- (0,3) node[above] {Im};

      % 原点O
      \coordinate (O) at (0,0) node[below left, txtnode] {O};

      % 座標軸上の点
      \coordinate (X) at ({\r*cos(\ang)}, 0);
      \coordinate (Y) at (0, {\r*sin(\ang)});

      \node [below, txtnode] at (X) {$a$};
      \node [left, txtnode] at (Y) {$b$};

      % 複素数z
      \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});

      % 補助線の描画
      \draw[auxline] (X) -- (Z);
      \draw[auxline] (Y) -- (Z);

      % ベクトル
      \draw[vector, magenta] (O) -- (X) node[midway, below, txtnode] {$a$};
      \draw[vector, cyan] (X) -- (Z) node[midway, right, txtnode] {$bi$};
      \draw[vector, Orchid] (O) -- (Z) node[midway, above left, txtnode] {$a+bi$};

      % 複素数を表す数式の描画
      \node[above right] at (Z) {$a+bi$};
    \end{tikzpicture}
  }
\end{center}

$a$というベクトルは実軸上の単位ベクトル$1$を$a$倍したもの、$bi$というベクトルは虚軸上の単位ベクトル$i$を$b$倍したものと考え、平面上の任意の数はそれらのベクトルの和の形で表す。

このとき、$a$を実部、$b$を虚部と呼び、$a+bi$の形で表した数を複素数という。

\begin{definition}{複素数}
  \newline
  $i$を虚数単位、$a, b$を実数とし、次の形で表される数を\hl{複素数}という。
  \LARGE
  \begin{equation}
    a+bi
  \end{equation}
  \normalsize
  このとき、$a$を\hl{実部}、$b$を\hl{虚部}と呼ぶ。
\end{definition}

$b=0$であるとき、複素数$a+bi$は実数$a$となるので、複素数は実数を含む数の体系（実数の拡張）となっている。

\vskip\baselineskip

また、数直線の拡張として考えてきた平面は、平面上の各点が複素数に対応するので、複素平面と呼ばれる。

数直線が実数の集合を表すのに対し、複素平面は複素数の集合を表す。

\begin{definition}{複素平面}
  複素数の実部を横軸、虚部を縦軸にとった平面を\hl{複素平面}と呼ぶ。
\end{definition}

\begin{center}
  \scalebox{1.25}{
    \begin{tikzpicture}[
        txtnode/.style={text height=0.75em},
      ]
      \def\ang{35} % 偏角
      \def\r{3} % 半径

      % x軸の描画
      \draw [->] (-1,0) -- (4,0) node[right] {Re};
      % y軸の描画
      \draw [->] (0,-1) -- (0,3) node[above] {Im};

      % 原点O
      \coordinate (O) at (0,0) node[below left, txtnode] {O};

      % 座標軸上の点
      \coordinate (X) at ({\r*cos(\ang)}, 0);
      \coordinate (Y) at (0, {\r*sin(\ang)});

      \node [below, txtnode] at (X) {$a$};
      \node [left, txtnode] at (Y) {$b$};

      % 複素数z
      \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});

      % 補助線の描画
      \draw[auxline] (X) -- (Z);
      \draw[auxline] (Y) -- (Z);

      % 複素数を表す数式の描画
      \node[above right] at (Z) {$a+bi$};
    \end{tikzpicture}
  }
\end{center}

複素平面において、実軸をRe、虚軸をImと表記しているのは、複素数の実部（Real Part）と虚部（Imaginary Part）をそれぞれの軸で表しているからである。

\subsection{複素数の絶対値と偏角}

複素数を複素平面上のベクトルとして捉えることで、複素数に幾何学的な意味を持たせることができる。

そして最終的には、$-1$をかける操作が$180$度回転であることや、$i$をかける操作が$90$度回転であることの一般化として、複素数のかけ算に複素平面上の回転という解釈を与える。

\vskip\baselineskip

そのための準備として、まずは複素数に関する「長さ」と「角」を定義しよう。

\subsubsection{複素数の「長さ」}

実数における絶対値は、数直線上の原点$0$からその数までの距離を表していた。

複素数の絶対値も、同じように「原点からの距離」として定義する。

\begin{center}
  \scalebox{1.5}{
    \begin{tikzpicture}[
        txtnode/.style={text height=0.75em},
      ]
      \def\ang{35} % 偏角
      \def\r{3} % 半径

      % 原点O
      \coordinate (O) at (0,0) node[below left, txtnode] {O};

      % 座標軸上の点
      \coordinate (X) at ({\r*cos(\ang)}, 0);
      \coordinate (Y) at (0, {\r*sin(\ang)});
      \node [below, txtnode] at (X) {$a$};
      \node [left, txtnode] at (Y) {$b$};

      % 複素数z
      \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});

      % 補助線の描画
      \draw[auxline, lightgray] (Y) -- (Z);

      % 三角形の描画
      \draw[fill=myPurple!30] (O) -- (X) -- (Z) -- cycle;

      % 直角O-X-Z
      \draw (O) -- (X) -- (Z) pic [fill=lightgray, opacity=0.8, angle radius=0.6em] {right angle = O--X--Z};

      % 三角形の辺のラベルの描画
      \node[below, myPurple!90!black] at ($(O)!0.5!(X)$) {$a$};
      \draw[myPurple] (X) -- (Z) node[midway, right, myPurple!90!black] {$b$};
      \draw[myPurple] (O) -- (Z) node[midway, above, sloped, Orchid] {$\sqrt{a^2 + b^2}$};

      % ベクトルの描画
      \draw[vector, Orchid] (O) -- (Z);
      % 複素数を表す数式の描画
      \node[above right] at (Z) {$z=a+bi$};

      % x軸の描画
      \draw [axis] (-1,0) -- (4,0) node[right] {Re};
      % y軸の描画
      \draw [axis] (0,-1) -- (0,3) node[above] {Im};
    \end{tikzpicture}
  }
\end{center}

\begin{definition}{複素数の絶対値}
  \newline
  複素平面において、原点から複素数$z=a+bi$までの距離を複素数$z$の絶対値と定義する。\\
  この距離は三平方の定理から求められ、$|z|$と表す。
  \LARGE
  \begin{equation}
    |z| = \sqrt{a^2 + b^2}
  \end{equation}
\end{definition}

\subsubsection{複素数の「回転角」}

ここで、複素数$z$が$0$でなければ、原点$O$から$z$までを結ぶベクトルと、実軸Reの正の向きとのなす角$\theta$を考えることができる。

\begin{center}
  \scalebox{1.5}{
    \begin{tikzpicture}[
        txtnode/.style={text height=0.75em},
      ]
      \def\ang{35} % 偏角
      \def\r{3} % 半径

      % 原点O
      \coordinate (O) at (0,0) node[below left, txtnode] {O};

      % 座標軸上の点
      \coordinate (X) at ({\r*cos(\ang)}, 0);
      \coordinate (Y) at (0, {\r*sin(\ang)});
      \node [below, txtnode] at (X) {$a$};
      \node [left, txtnode] at (Y) {$b$};

      % 複素数z
      \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});

      % 補助線の描画
      \draw[auxline, lightgray] (Y) -- (Z);

      % 三角形の描画
      \draw[fill=myPurple!30] (O) -- (X) -- (Z) -- cycle;

      % 直角O-X-Z
      \draw (O) -- (X) -- (Z) pic [fill=lightgray, opacity=0.8, angle radius=0.6em] {right angle = O--X--Z};

      % 三角形の辺のラベルの描画
      \draw[myPurple] (X) -- (Z);
      \draw[myPurple] (O) -- (Z) node[midway, above left, Orchid] {$|z|$};

      % 角X-O-Zを表す扇形
      \pic [fill=Emerald!30,angle eccentricity=1.3, angle radius=2em, "$\theta$"{text=Emerald}] {angle = X--O--Z};

      % ベクトルの描画
      \draw[vector, Orchid] (O) -- (Z);
      % 複素数を表す数式の描画
      \node[above right] at (Z) {$z=a+bi$};

      % x軸の描画
      \draw [axis] (-1,0) -- (4,0) node[right] {Re};
      % y軸の描画
      \draw [axis] (0,-1) -- (0,3) node[above] {Im};
    \end{tikzpicture}
  }
\end{center}

\begin{definition}{複素数の偏角}
  \newline
  $0$でない複素数$z$に対して、複素平面上の原点$O$から複素数$z$までを結ぶベクトルと、実軸の正の向きとのなす角$\theta$を、複素数$z$の\hl{偏角}と呼び、次のように表す。
  \LARGE
  \begin{equation}
    \arg z = \theta
  \end{equation}
\end{definition}

ここで、$\theta$を整数回$2\pi$シフトさせても（何周回転させても）、同じ複素数$z$の位置に戻ってくる。

つまり、1つの複素数$z$に対して偏角の値は複数考えられるので、それが困る場合には、主値と呼ばれる代表値を使うことにする。

\begin{definition}{偏角の主値}
  \newline
  複素数$z$の偏角のうち、$0\leq \theta \leq 2\pi$、もしくは$-\pi < \theta \leq \pi$の範囲にある偏角を\hl{主値}と呼び、次のように表す。
  \LARGE
  \begin{equation}
    \Arg z = \theta
  \end{equation}
\end{definition}

\subsection{複素数の極形式}

複素数が持つ「長さ」と「角」を定義したところで、それらを使って1つの複素数を表現できないか？ということを考える。

\begin{center}
  \scalebox{1.5}{
    \begin{tikzpicture}[
        txtnode/.style={text height=0.75em},
      ]
      \def\ang{35} % 偏角
      \def\r{3} % 半径

      % 原点O
      \coordinate (O) at (0,0) node[below left, txtnode] {O};

      % 座標軸上の点
      \coordinate (X) at ({\r*cos(\ang)}, 0);
      \coordinate (Y) at (0, {\r*sin(\ang)});
      \node [below, txtnode] at (X) {$a$};
      \node [left, txtnode] at (Y) {$b$};

      % 複素数z
      \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});

      % 補助線の描画
      \draw[auxline, lightgray] (Y) -- (Z);

      % 三角形の描画
      \draw[fill=myPurple!30] (O) -- (X) -- (Z) -- cycle;

      % 直角O-X-Z
      \draw (O) -- (X) -- (Z) pic [fill=lightgray, opacity=0.8, angle radius=0.6em] {right angle = O--X--Z};

      % 角X-O-Zを表す扇形
      \pic [fill=Emerald!30,angle eccentricity=1.3, angle radius=2em, "$\theta$"{text=Emerald}] {angle = X--O--Z};

      % ベクトルの描画
      \draw[vector, Orchid] (O) -- (Z);

      % 複素数を表す数式の描画
      \node[above right] at (Z) {$z$};

      % x軸の描画
      \draw [axis] (-1,0) -- (4,0) node[right] {Re};
      % y軸の描画
      \draw [axis] (0,-1) -- (0,3) node[above] {Im};

      % 三角形の辺のラベルの描画
      \draw[magenta, thick] (O) -- (X) node[midway, below] {$r\cos\theta$};
      \draw[cyan, thick] (X) -- (Z) node[midway, right] {$r\sin\theta$};
      \node[above left, Orchid] at ($(O)!0.5!(Z)$) {$r$};
    \end{tikzpicture}
  }
\end{center}

複素数$z = a+ bi$の絶対値を$r$、偏角を$\theta$とすると、

\begin{align}
  a & = r\cos\theta \\
  b & = r\sin\theta
\end{align}

となり、複素数$z$は絶対値と偏角を使った表示（極形式）に置き換えることができる。

\begin{definition}{極形式}
  \newline
  複素数$z$は、その絶対値$r$と偏角$\theta$を用いて次のように表すことができる。
  \LARGE
  \begin{equation}
    z = r(\cos\theta + i\sin\theta)
  \end{equation}
\end{definition}

絶対値を「半径」、偏角を「回転角」とみなし、それらを使って複素数を表現できたことで、複素数と回転との関係についても調べる準備が整った。

\section{複素数の四則演算}

図形的な意味を考えながら、複素数の四則演算を定義していこう。

\subsection{複素数の和と差}

複素数の和・差は、ベクトルの和・差と同じように定義される。

\begin{definition}{複素数の和と差}
  \newline
  複素数$z=a+bi, w = c +di$について、$z$と$w$の和（差）を次のように定義する。
  \LARGE
  \begin{equation}
    z \pm w = (a \pm c) + (b \pm d)i
  \end{equation}
\end{definition}

つまり、実部同士・虚部同士の足し算（引き算）を行えばよい。

実部同士を足したものが実部になり、虚部同士を足したものが虚部になる。

この定義は、実部と虚部を並べたベクトルの和（差）と一致している。

\begin{equation}
  \begin{pmatrix}
    a \\
    b
  \end{pmatrix} \pm \begin{pmatrix}
    c \\
    d
  \end{pmatrix} = \begin{pmatrix}
    a \pm c \\
    b \pm d
  \end{pmatrix}
\end{equation}

\subsection{複素数の積}

複素数の積は、ベクトルの演算から定義をそのまま流用することはできない。
（そもそも、ベクトルの積とは何か？という問題になる。）

\vskip\baselineskip

複素数のかけ算で成り立っていてほしい性質は、$-1$をかける操作が$180$度回転であることや、$i$をかける操作が$90$度回転であることだ。

というわけで、複素数の積は回転を表すものとして定義したい。

\subsubsection{回転行列から定義を探る}

複素数$z=a+bi$の実部と虚部を並べたベクトル$\icvec{a\\b}$を、原点を中心に$\theta$だけ回転させたベクトルは、2次元の回転行列を左からかけた形で次のように表せる。

\begin{equation}
  \begin{pmatrix}
    \cos \theta & -\sin \theta \\
    \sin \theta & \cos \theta
  \end{pmatrix} \begin{pmatrix}
    a \\
    b
  \end{pmatrix}
  = \begin{pmatrix}
    a \cos \theta - b \sin \theta \\
    a \sin \theta + b \cos \theta
  \end{pmatrix}
\end{equation}

ここで、絶対値が$1$、偏角が$\theta$である複素数$w=c+di$の実部と虚部は、

\begin{align}
  c & = \cos \theta \\
  d & = \sin \theta
\end{align}

と表せるから、これらを使って回転行列を書き直してみる。

\begin{equation}
  \begin{pmatrix}
    c & -d \\
    d & c
  \end{pmatrix} \begin{pmatrix}
    a \\
    b
  \end{pmatrix}
  = \begin{pmatrix}
    a c - b d \\
    a d + b c
  \end{pmatrix}
\end{equation}

これは、複素数$z=a+bi$の実部と虚部を並べたベクトルを、複素数$w=c+di$の実部と虚部だけを使って回転させたものと捉えられる。

つまり、$z$に$w$をかけることで$z$を回転させたいのなら、$z$と$w$の積を

\begin{equation}
  zw = (ac - bd) + (ad + bc)i
\end{equation}

と考えればよいのではないだろうか。

\begin{definition}{複素数の積}
  \newline
  複素数$z=a+bi, w = c +di$について、$z$と$w$の積を次のように定義する。
  \LARGE
  \begin{equation}
    zw = (ac - bd) + (ad + bc)i
  \end{equation}
\end{definition}

\section{共役複素数}

\begin{definition}{共役複素数}
  \newline
  複素数$z=x+iy$に対して，その共役複素数$\overline{z}$を次のように定義する。
  \LARGE
  \begin{equation}
    \overline{z}\coloneqq x-iy
  \end{equation}
\end{definition}

\begin{center}
  \begin{tikzpicture}
    \def\ang{35} % 偏角
    \def\r{3} % 半径

    % x軸の描画
    \draw [axis] (-1,0) -- (4,0) node[right] {Re};
    % y軸の描画
    \draw [axis] (0,-3) -- (0,3) node[above] {Im};

    % 原点O
    \coordinate (O) at (0,0) node[below left] {O};

    % 座標軸上の点
    \coordinate[label=below right:$x$] (X) at ({\r*cos(\ang)}, 0);
    \coordinate[label=left:$y$] (Y) at (0, {\r*sin(\ang)});
    \coordinate[label=left:$-y$] (-Y) at (0, {-\r*sin(\ang)});

    % 複素数z
    \coordinate (Z) at ({\r*cos(\ang)}, {\r*sin(\ang)});
    % 共役複素数z*
    \coordinate (Z*) at ({\r*cos(\ang)}, {-\r*sin(\ang)});

    % ベクトルの描画
    \draw[vector] (O) -- (Z);
    \draw[vector] (O) -- (Z*);

    % 補助線の描画
    \draw[auxline] (X) -- (Z);
    \draw[auxline] (X) -- (Z*);
    \draw[auxline] (Y) -- (Z);
    \draw[auxline] (-Y) -- (Z*);

    % 偏角を表す円弧の描画
    \pic [draw, ->, "$\theta$", angle eccentricity=1.5] {angle = X--O--Z};
    \pic [draw, <-, "$-\theta$", angle eccentricity=1.7] {angle = Z*--O--X};

    % 半径を表すラベルの描画
    \draw (O) -- (Z) node[midway, above] {$r$};
    \draw (O) -- (Z*) node[midway, below] {$r$};

    % 点の描画
    \fill (O) circle (1.2pt);
    \fill (Z) circle (1.2pt);
    \fill (Z*) circle (1.2pt);

    % 複素数を表す数式の描画
    \node[above right] at (Z) {$z=x+iy$};
    \node[below right] at (Z*) {$\overline{z}=x-iy$};
  \end{tikzpicture}
\end{center}

\begin{theorem}{共役複素数と絶対値}
  \newline
  複素数$z$とその共役複素数$\overline{z}$の積は、$z$の絶対値の二乗に等しい。
  \LARGE
  \begin{equation}
    z\overline{z} = |z|^2
  \end{equation}
\end{theorem}

\begin{proof}{共役複素数と絶対値}
  複素数$z=x+iy$とその共役複素数$\overline{z}=x-iy$の積を計算する。
  \begin{align*}
    z\overline{z} & = (x+iy)(x-iy)             \\
                  & = x^2 - ixy + ixy - i^2y^2 \\
                  & = x^2 + y^2                \\
                  & = |z|^2
  \end{align*}
\end{proof}

\section{オイラーの公式}

\begin{center}
  \def\xang{-13}
  \def\zang{45}
  \begin{tikzpicture}[x=(\xang:0.9), y=(90:0.9), z=(\zang:1.1)]
    \def\xmax{8.8}         % max x axis
    \def\ymin{-1.5}        % min y axis
    \def\ymax{1.6}         % max y axis
    \def\zmax{1.6}         % max z axis
    \def\xf{1.17*\xmax}    % x position frequency axis
    \def\A{(0.70*\ymax)}   % amplitude
    \def\T{(0.335*\xmax)}  % period
    \def\w{\zmax/11.2}     % spacing components
    \def\ang{47}           % angle
    \def\s{\ang/360*\T}    % time component
    \def\x{\A*cos(\ang)}   % real component
    \def\y{\A*sin(\ang)}   % imaginary component
    \def\N{100}            % number of samples
    \def\tick#1#2{\draw[thick] (#1) ++ (#2:0.12) --++ (#2-180:0.24)}

    % COMPLEX PLANE
    \begin{scope}[shift={(-1.6*\zmax,0,0)}]
      % 複素平面の枠
      \draw[black,fill=white,opacity=0.3,zy-plane](-1.25*\zmax,-1.25*\ymax) rectangle (1.4*\zmax,1.25*\ymax);
      % Im axis
      \draw[axis] (0,\ymin,0) -- (0,\ymax+0.02,0) node[pos=1,left=0,zy-plane] {Im};
      % Re axis
      \draw[axis] (0,0,-\zmax) -- (0,0,\zmax+0.02) node[right=1,below=0,zy-plane] {Re} coordinate (X);
      % 複素平面上の単位円
      \draw[plotline,zy-plane] (0,0) circle(0.991*\A) coordinate (O);
      % 単位円上の点P
      \fill[red,zy-plane] (\ang:{\A}) circle(0.07) coordinate(P);
      \node[blue,zy-plane,anchor=south west,scale=0.7] at (P) {$z(t)=Ae^{i\omega t}$};
      % 動径OP
      \draw[vector,thick,zy-plane] (0,0) -- (\ang:{\A-0.03}) coordinate (R);
      % 偏角を表す円弧
      \draw pic[-{>[flex'=1]},draw=blue,angle radius=14,angle eccentricity=1,"$\omega t$"{above=0,right=-0.5,yslant=0.69,scale=0.8},blue,zy-plane] {angle = X--O--R};
      % Re軸上の目盛り
      \tick{0,0,{\A}}{90};
      \tick{0,0,{-\A}}{90};
      % Im軸上の目盛り
      \tick{0,{\A},0}{\zang};
      \tick{0,{-\A},0}{\zang};
    \end{scope}

    % IMAGINARY
    \begin{scope}[shift={(0,0,1.9*\zmax)}]
      % sinを描く平面の枠
      \draw[black,fill=white,opacity=0.3,xy-plane](-0.5*\ymax,-1.2*\ymax) rectangle (1.10*\xmax,1.25*\ymax);
      % t axis
      \draw[axis] (-0.3*\ymax,0,0) -- (\xmax,0,0) node[below right,xy-plane] {$t$ [s]};
      % Im axis
      \draw[axis] (0,\ymin,0) -- (0,\ymax,0) node[left,xy-plane] {Im};
      % sin関数のグラフ
      \draw[plotline,samples=\N,smooth,variable=\t,domain=-0.05*\T:0.95*\xmax] plot(\t,{\A*sin(360/\T*\t)},0);
      % sin関数上の点I
      \fill[red,xy-plane] ({\s},{\y}) circle(0.07) coordinate(I);
      % 点Iでの波の高さを示すベクトル
      \draw[vector,thick,xy-plane] ({\s},0) --++ (0,{\y-0.03});
      \node[xy-plane,below] at ({\s},0) {$\omega t$};
      % 波の高さを表すIm軸上の目盛り
      \tick{0,{\A},0}{180};
      \tick{0,{-\A},0}{180};
      % 周期を示す目盛り
      \tick{{\T},0,0}{90} node[right=0,below,xy-plane] {\contour{white}{$T$}};
      \tick{{2*\T},0,0}{90} node[right=0,below,xy-plane] {\contour{white}{$2T$}};
      % 関数を表す数式
      \node[blue,below=0,xy-plane] at (0.4*\xmax,1.15*\ymax,0) {$y(t)=A\sin(\omega t)$};
    \end{scope}

    % REAL
    \begin{scope}[shift={(0,-1.8*\zmax,0)}]
      % cosを描く平面の枠
      \draw[black,fill=white,opacity=0.3,xz-plane] (-0.5*\ymax,-1.4*\ymax) rectangle (1.10*\xmax,1.25*\ymax);
      % t axis
      \draw[axis] (-0.3*\ymax,0,0) -- (\xmax,0,0) node[below right,xz-plane] {$t$ [s]};
      % Re axis
      \draw[axis] (0,0,-\zmax) -- (0,0,\zmax) node[left=-1,xz-plane] {Re};
      % cos関数のグラフ
      \draw[plotline,samples=\N,smooth,variable=\t,domain=-0.05*\T:0.95*\xmax] plot(\t,0,{\A*cos(360/\T*\t)});
      % cos関数上の点R
      \fill[red,xz-plane] ({\s},{\x}) circle(0.07) coordinate(R);
      % 点Rでの波の高さを示すベクトル
      \draw[vector,thick,xz-plane] ({\s},0) --++ (0,{\x-0.03});
      \node[xz-plane,below] at ({\s},0) {$\omega t$};
      % 波の高さを表すRe軸上の目盛り
      \tick{0,0,{\A}}{180};
      \tick{0,0,{-\A}}{180};
      % 周期を示す目盛り
      \tick{{\T},0,0}{\zang} node[below,xz-plane] {$T$};
      \tick{{2*\T},0,0}{\zang} node[below,xz-plane] {$2T$};
      % 関数を表す数式
      \node[blue,above=0,xz-plane] at (0.3*\xmax,-\ymax,0) {$x(t)=A\cos(\omega t)$};
    \end{scope}

    % COMPONENTS
    % 単位円上の点P、Im軸上の点I、Re軸上の点Rを結ぶ線
    \draw[red!80!black,dashed] (P) -- ({\s},{\y},{\x}) (I) -- ({\s},{\y},{\x+0.05}) ({\s},{\y-0.06},{\x}) -- (R);
    % 空間上に写したt軸
    \draw[axis,black,thick] (-0.1*\ymax,0,0) -- (\xmax,0,0) node[below right] {$t$ [s]};
    % 空間上に写したIm軸
    \draw[axis,black,thick] (0,\ymin,0) -- (0,\ymax+0.02,0) node[above] {Im};
    % 空間上に写したRe軸
    \draw[axis,black,thick] (0,0,-\zmax) -- (0,0,\zmax+0.02);
    \node[right=0.5em,below] at (0,0,\zmax+0.02) {$Re$};
    % 空間上のグラフ
    \foreach \i [evaluate={\tmin=max(-0.05*\T,(\i-0.05)*\T); \tmax=min(0.95*\xmax,(\i+1)*\T);}] in {0,...,2} {
        \draw[plotline,samples=0.4*\N,smooth,variable=\t] plot[domain=\tmin:\tmax](\t,{\A*sin(360/\T*\t)},{\A*cos(360/\T*\t)});
      }
    % 単位円上の点P、Im軸上の点I、Re軸上の点Rを結ぶ線が交わる点Z
    \fill[red] ({\s},{\y},{\x}) circle(0.07) coordinate(Z);
    % 空間上に動径OPを写したベクトル
    \draw[vector,thick] ({\s},0,0) --++ (0,{\y-0.03},{\x-0.03});
    % 周期を表すt軸上の目盛り
    \tick{{\T},0,0}{90};
    \tick{{2*\T},0,0}{90};
    % Re軸上の目盛り
    \tick{0,0,{\A}}{90};
    \tick{0,0,{-\A}}{90};
    % Im軸上の目盛り
    \tick{0,{\A},0}{\zang};
    \tick{0,{-\A},0}{\zang};
  \end{tikzpicture}
\end{center}

\end{document}