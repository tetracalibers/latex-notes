\documentclass[../../imaging-math]{subfiles}

\begin{document}

\section{数列の極限}

微分を定義するには関数の極限を考えるが、関数の極限の諸性質は、数列の極限から導かれる。

まずは、$\varepsilon - \delta $論法（数列の場合は$\varepsilon - N$論法とも呼ばれる）によって数列の極限を定義し、その性質をひとつひとつ確かめていこう。

\subsection{εで「一致」をどう表現するか}

「限りなく近づく」という表現では、「限りなく」の部分に無限という概念が含まれてしまう。

有限の値$\varepsilon$を使って、無限を表現しようとするのがε-δ論法である。

\froufrou

ε-δ論法で極限を定義する前に、有限値$\varepsilon$を使った議論の例を見てみよう。

\begin{theorem}{有限値$\varepsilon $の不等式による一致の表現}\label{theorem:有限値εの不等式による一致の表現}
  \titlegap
  $a$、$b$を実数とするとき、任意の$\varepsilon >0$に対して、次のことがいえる。
  \LARGE
  \begin{equation}
    |a-b|<\varepsilon \quad \Longrightarrow  \quad a=b
  \end{equation}
\end{theorem}

実数は連続である（数直線には穴がない）ため、$a$と$b$が異なる実数であれば、$a$と$b$の間には無数の実数が存在する。

つまり、$a$と$b$が異なる限り、その間の距離$|a-b|$は絶対に$0$にはならない。

\begin{center}
  \begin{tikzpicture}[
      _txtnode/.style={text height=1em},
      _term/.style={RoyalBlue},
      _midterm/.style={lavendermagenta},
      _distance/.style={RoyalBlue, thick}
    ]
    \def\xmin{-3}
    \def\xmax{5}
    \def\a{0}
    \def\b{3}
    \def\pointr{2.5pt}
    \def\h{3}
    \def\dh{-2}
    \def\center#1#2{#1 + (#2-#1)/2}

    \draw[->] (\xmin,\h) -- (\xmax,\h) node[right] {$\mathbb{R} $};
    \fill[_term] (\a,\h) circle (\pointr) node[below, _txtnode] {$a$};
    \fill[_term] (\b,\h) circle (\pointr) node[below, _txtnode] {$b$};
    \fill[_midterm] ({\center{\a}{\b}}, \h) circle (\pointr) node[below, _txtnode] {$x$};
    \draw[<->, yshift=1em, _distance] (\a,\h) -- (\b,\h) node[midway, above, _txtnode] {$|a-b|$};

    \tikzmath{
      real \b;
      \b = \center{\a}{\b};
    }

    \draw[->] (\xmin,\h+\dh) -- (\xmax,\h+\dh) node[right] {$\mathbb{R} $};
    \fill[_term] (\a,\h+\dh) circle (\pointr) node[below, _txtnode] {$a$};
    \fill[_term] (\b,\h+\dh) circle (\pointr) node[below, _txtnode] {$b$};
    \fill[_midterm] ({\center{\a}{\b}}, \h+\dh) circle (\pointr) node[below, _txtnode] {$x$};
    \draw[<->, yshift=1em, _distance] (\a,\h+\dh) -- (\b,\h+\dh) node[midway, above, _txtnode] {$|a-b|$};

    \tikzmath{
      real \b;
      \b = \center{\a}{\b};
    }

    \draw[->] (\xmin,\h+\dh*2) -- (\xmax,\h+\dh*2) node[right] {$\mathbb{R} $};
    \fill[_term] (\a,\h+\dh*2) circle (\pointr) node[below, _txtnode] {$a$};
    \fill[_term] (\b,\h+\dh*2) circle (\pointr) node[below, _txtnode] {$b$};
    \fill[_midterm] ({\center{\a}{\b}}, \h+\dh*2) circle (\pointr) node[below, _txtnode] {$x$};
    \draw[<->, yshift=1em, _distance] (\a,\h+\dh*2) -- (\b,\h+\dh*2) node[midway, above, _txtnode] {$|a-b|$};
  \end{tikzpicture}
\end{center}

\vskip\baselineskip

$|a-b|$が$0$にならないということは、ここでも実数の連続性によって、$|a-b|$より小さい実数が存在してしまう。

たとえば、$a$と$b$の間の中点$x= \dfrac{|a-b|}{2}$は、$|a-b|$よりも小さい。

\begin{supplnote}
  $a$と$b$の間の中点というと$\dfrac{a-b}{2}$だが、正の数$\varepsilon$と比較するため、絶対値をつけて$\dfrac{|a-b|}{2}$としている。
\end{supplnote}

\vskip\baselineskip

$|a-b|$より小さい実数が存在してしまうと、「任意の」$\varepsilon >0$に対して、$|a-b|<\varepsilon$を成り立たせることができない。

$\varepsilon$はなんでもよいのだから、$|a-b|$より小さい実数を$\varepsilon$として選ぶこともできてしまう。

しかし、$|a-b|$より小さい実数を$\varepsilon$としたら、$|a-b|<\varepsilon$は満たされない。

\vskip\baselineskip

$|a-b|$が$0$でないという状況下では、あらゆる実数$\varepsilon$より$|a-b|$を小さくすることは不可能である。

したがって、$|a-b| < \varepsilon$を常に成り立たせるなら、$|a-b|=0$、すなわち$a=b$となる。

\froufrou

ここまでの考察から直観を取り除いて、この定理の数学的な証明をまとめておこう。

\vskip\baselineskip

\begin{proof}{有限値$\varepsilon $の不等式による一致の表現}
  $a\ne b$と仮定する。

  \vskip\baselineskip

  $\varepsilon_0 = \dfrac{|a-b|}{2}$とおくと、絶対値$|a-b|$が正の数であることから、$\varepsilon_0$も正の数となる。

  よって、$|a-b|<\varepsilon_0$が成り立つので、

  \begin{equation}
    \begin{WithArrows}
      |a-b| &< \dfrac{|a-b|}{2} \Arrow{両辺$\times 2$} \\
      2|a-b| &< |a-b| \\
      2|a-b| - |a-b| &< 0 \\
      |a-b| &< 0
    \end{WithArrows}
  \end{equation}

  絶対値が負になることはありえないので、$a \ne b$の仮定のもとでは矛盾が生じる。

  したがって、$a=b$でなければならない。$\qed$
\end{proof}

なお、$|a-b|<\varepsilon$の右辺を定数倍し、$|a-b|<k\varepsilon$などとしても、この定理は成り立つ。

\begin{emphabox}
  定理「有限値$\varepsilon $の不等式による一致の表現」は、定数を$k$として、次のように書き換えることもできる。
  \large
  \begin{equation}
    |a-b|<k\varepsilon \quad \Longrightarrow  \quad a=b
  \end{equation}
\end{emphabox}

この場合、証明で$\varepsilon_0 = \dfrac{|a-b|}{2k}$とおけば、まったく同様の議論が成り立つからだ。

\vskip\baselineskip

実際に、$|a-b|<2\varepsilon$とした場合のこの定理を、後に登場する数列の極限の一意性の証明で使うことになる。

\subsection{ε- N論法による数列の収束}

$\varepsilon - \delta$論法は、数列の極限に適用する場合、$\varepsilon - N$論法と呼ばれることが多い。

「数列が$\{a_n\}$が$\alpha$に収束する」ことの$\varepsilon - N$論法による表現を、まずはイメージで掴んでみよう。

\froufrou

まず、$\alpha$の周りに、両側それぞれ$\varepsilon$だけ広げた区間を考える。

$\varepsilon$は正の数ならなんでもよいとすれば、$\varepsilon$を小さな数に設定し、いくらでも区間を狭めることができる。

そして、「ここから先の項はすべて区間内に収まる」といえる位置に、$N$という印をつけておく。

\begin{center}
  \begin{tikzpicture}
    \def\ep{0.5} % ε
    \def\N{3.75} % N

    \def\xmax{9} % max x axis
    \def\ymax{3.5}
    \def\A{2.75} % 振幅を大きく
    \def\om{(7.5*360/(0.94*\xmax))} % 周期を短く（振動数を上げる）
    \def\t{1800/(0.94*\xmax)}
    \def\T{2.0} % 減衰をやや速める
    \def\samp{100} % number of samples
    %\def\tick#1#2{\draw[thick] (#1)++(#2:0.12) --++ (#2-180:0.24)}

    % AXIS
    \draw[axis] (0,-\ymax) -- (0,\ymax) node[above] {\large$a_n$};
    \draw[axis] (-0.2*\ymax,-\ymax + 1) -- (\xmax,-\ymax +1) node[right] {\large$n$};
    %\tick{0,\A}{0} node[left=-1,scale=0.9] {$A_0$};
    %\tick{0,-\A}{0} node[left=-1,scale=0.9] {$-A_0$};

    % ε区間
    \fill[carnationpink, fill opacity=0.5] ($($(0,\A)!.5!(0,-\A)$) + (0, \ep)$) rectangle ($($(\xmax,\A)!.5!(\xmax,-\A)$) - (0, \ep)$);
    \draw[magenta, thick] ($(0,\A)!.5!(0,-\A)$) --++ (\xmax,0);
    \draw[carnationpink] ($(0,\A)!.5!(0,-\A) - (0,\ep)$) --++ (\xmax,0);
    \draw[carnationpink] ($(0,\A)!.5!(0,-\A) + (0,\ep)$) --++ (\xmax,0);

    % ε
    \draw[<->, hotpink, xshift=0.5em] ($(\xmax,\A)!.5!(\xmax,-\A)$) -- ($(\xmax,\A)!.5!(\xmax,-\A) - (0,\ep)$) node[midway, right] {$\varepsilon$};
    \draw[<->, hotpink, xshift=0.5em] ($(\xmax,\A)!.5!(\xmax,-\A)$) -- ($(\xmax,\A)!.5!(\xmax,-\A) + (0,\ep)$) node[midway, right] {$\varepsilon$};

    % 縦軸上のラベル
    \node[left, magenta] at ($(0,\A)!.5!(0,-\A)$) {$\alpha$};
    \node[left, carnationpink] at ($(0,\A)!.5!(0,-\A) - (0,\ep)$) {$\alpha - \varepsilon$};
    \node[left, carnationpink] at ($(0,\A)!.5!(0,-\A) + (0,\ep)$) {$\alpha + \varepsilon$};

    % PLOT
    %\draw[dashed,samples=\samp,smooth,variable=\t,domain=0:0.96*\xmax]
    %plot(\t,{\A*exp(-\t/\T)}) plot(\t,{-\A*exp(-\t/\T)});
    \draw[dotted, cyan, thick, samples=100+\samp, smooth, variable=\t, domain=0:\xmax]
    plot(\t,{\A*exp(-\t/\T)*cos(\om*\t)});

    %%% 以下、重いのでデバッグ中はコメントアウト推奨 %%%

    \path[name path=ExpAbove,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)});
    \path[name path=ExpBelow,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{-\A*exp(-\t/\T)});
    \path[name path=Wave,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)*cos(\om*\t)});

    \fill[ProcessBlue,name intersections={of=ExpAbove and Wave, name=i, total=\t}]
    \foreach \s in {1,...,\t}{(i-\s) circle (2pt)};

    \fill[ProcessBlue,name intersections={of=ExpBelow and Wave, name=i, total=\t}]
    \foreach \s in {1,...,\t}{(i-\s) circle (2pt)};

    %%% 以上、重いのでデバッグ中はコメントアウト推奨 %%%

    % N以降を表す矢印
    \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-2) -- (\xmax,-2);

    % N以降を表す空間
    \fill[lawngreen, opacity=0.2] (\N,-\ymax) rectangle (\xmax,\ymax);

    % N直線
    \draw[malachite, thick] (\N,-\ymax) -- (\N,\ymax);
    \node[malachite] at (\N,-\ymax) [below] {\Large$N$};
  \end{tikzpicture}
\end{center}

$\varepsilon$を小さくしていくと、$\varepsilon$による$\alpha$周辺の区間に入る項は少なくなる。

それでも、$N$をずらしていけば、$N$以降はこの区間に収まる項だけになる。

これこそが「収束」という現象だと定義するのが、$\varepsilon - N$論法の考え方である。

\begin{center}
  \begin{tikzpicture}
    \def\ep{0.15} % ε
    \def\N{6.5} % N

    \def\xmax{9} % max x axis
    \def\ymax{3.5}
    \def\A{2.75} % 振幅を大きく
    \def\om{(7.5*360/(0.94*\xmax))} % 周期を短く（振動数を上げる）
    \def\t{1800/(0.94*\xmax)}
    \def\T{2.0} % 減衰をやや速める
    \def\samp{100} % number of samples
    %\def\tick#1#2{\draw[thick] (#1)++(#2:0.12) --++ (#2-180:0.24)}

    % AXIS
    \draw[axis] (0,-\ymax) -- (0,\ymax) node[above] {\large$a_n$};
    \draw[axis] (-0.2*\ymax,-\ymax + 1) -- (\xmax,-\ymax +1) node[right] {\large$n$};
    %\tick{0,\A}{0} node[left=-1,scale=0.9] {$A_0$};
    %\tick{0,-\A}{0} node[left=-1,scale=0.9] {$-A_0$};

    % ε区間
    \fill[carnationpink, fill opacity=0.5] ($($(0,\A)!.5!(0,-\A)$) + (0, \ep)$) rectangle ($($(\xmax,\A)!.5!(\xmax,-\A)$) - (0, \ep)$);
    \draw[magenta, thick] ($(0,\A)!.5!(0,-\A)$) --++ (\xmax,0);
    \draw[carnationpink] ($(0,\A)!.5!(0,-\A) - (0,\ep)$) --++ (\xmax,0);
    \draw[carnationpink] ($(0,\A)!.5!(0,-\A) + (0,\ep)$) --++ (\xmax,0);

    % ε
    %\draw[<->, magenta, xshift=-0.5em] ($(0,\A)!.5!(0,-\A)$) -- ($(0,\A)!.5!(0,-\A) - (0,\ep)$) node[midway, left] {$\varepsilon$};
    %\draw[<->, magenta, xshift=-0.5em] ($(0,\A)!.5!(0,-\A)$) -- ($(0,\A)!.5!(0,-\A) + (0,\ep)$) node[midway, left] {$\varepsilon$};

    % PLOT
    %\draw[dashed,samples=\samp,smooth,variable=\t,domain=0:0.96*\xmax]
    %plot(\t,{\A*exp(-\t/\T)}) plot(\t,{-\A*exp(-\t/\T)});
    \draw[dotted, cyan, thick, samples=100+\samp, smooth, variable=\t, domain=0:\xmax]
    plot(\t,{\A*exp(-\t/\T)*cos(\om*\t)});

    %%% 以下、重いのでデバッグ中はコメントアウト推奨 %%%

    \path[name path=ExpAbove,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)});
    \path[name path=ExpBelow,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{-\A*exp(-\t/\T)});
    \path[name path=Wave,samples=375+\samp, variable=\t, domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)*cos(\om*\t)});

    \fill[ProcessBlue,name intersections={of=ExpAbove and Wave, name=i, total=\t}]
    \foreach \s in {1,...,\t}{(i-\s) circle (1.75pt)};

    \fill[ProcessBlue,name intersections={of=ExpBelow and Wave, name=i, total=\t}]
    \foreach \s in {1,...,\t}{(i-\s) circle (1.75pt)};

    %%% 以上、重いのでデバッグ中はコメントアウト推奨 %%%

    % N以降を表す矢印
    \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-2) -- (\xmax,-2);

    % N以降を表す空間
    \fill[lawngreen, opacity=0.2] (\N,-\ymax) rectangle (\xmax,\ymax);

    % N直線
    \draw[malachite, thick] (\N,-\ymax) -- (\N,\ymax);
    \node[malachite] at (\N,-\ymax) [below] {\Large$N$};
  \end{tikzpicture}
\end{center}

区間幅（の半分）となる$\varepsilon$をどんなに小さくしても、「$N$番目以降は区間内に収まる項だけになる」といえるような$N$を設定できるか？が肝心で、そのような$N$が存在するなら、数列は収束するといえる。

このことを、数学の言葉でまとめておこう。

\begin{definition}{数列の収束と極限値}
  \titlegap
  数列$\{a_n\}_{n=1}^{\infty}$と実数$\alpha$について、次の条件を考える。
  \begin{spacebox}
    任意の正の数$\varepsilon$に対して
    \Large
    \begin{equation}
      n \geq N \quad \Longrightarrow \quad |a_n - \alpha| < \varepsilon
    \end{equation}
    \normalsize
    が成り立つような自然数$N$が存在する
  \end{spacebox}
  この条件が成り立つとき、数列$\{a_n\}$は$\alpha$に\hl{収束}するといい、次のように表す。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} a_n = \alpha \quad \text{\normalsize または} \quad a_n \to \alpha \quad (n \to \infty)
  \end{equation}
  \normalsize
  このとき、$\alpha$を数列$\{a_n\}$の\hl{極限値}という。
\end{definition}

$\varepsilon-\delta$論法によるこの定義を用いることで、数列の収束に関する諸性質を証明できるようになる。

\subsection{数列の極限の一意性}

数列が最終的に複数の極限値に散らばるとしたら、それは収束と呼べるだろうか？

$\varepsilon-\delta$論法による収束の定義は、そのような状況をきちんと除外するようになっている。

\vskip\baselineskip

数列が複数の値に収束することはない。このことを示すのが、次の定理である。

\begin{theorem}{数列の極限の一意性}
  \titlegap
  数列$\{a_n\}$が収束するならば、その極限値はただ1つに定まる。
\end{theorem}

\begin{proof}{数列の極限の一意性}
  数列$\{a_n\}$が$\alpha$と$\beta$の2つの極限値を持つと仮定する。

  \vskip\baselineskip

  このとき、任意の正の数$\varepsilon$に対して、
  \begin{align}
    n \geq N_1 \quad & \Longrightarrow \quad |a_n - \alpha| < \varepsilon \\
    n \geq N_2 \quad & \Longrightarrow \quad |a_n - \beta| < \varepsilon
  \end{align}
  が成り立つような自然数$N_1$と$N_2$が存在する。

  \vskip\baselineskip

  ここで、$N = \max\{N_1, N_2\}$とおくと、$n \geq N$のとき、$N_1$と$N_2$の大きい方が$n$以下に収まることから、$n \geq N_1$と$n \geq N_2$がともに成り立つ。

  \vskip\baselineskip

  よって、$n \geq N$のとき、$|\alpha - \beta|$を考えると、
  \begin{equation}
    \begin{WithArrows}
      |\alpha - \beta| & = |\alpha - \beta + \wavelabelmath{a_n - a_n}{$0$}| \\
      & = |(\alpha - a_n) + (a_n - \beta)| \Arrow{三角不等式} \\
      & \leq |\alpha - a_n| + |a_n - \beta| \\
      &= |-(a_n - \alpha)| + |a_n - \beta| \Arrow{$|-A| = |A|$} \\
      &= |a_n - \alpha| + |a_n - \beta| \Arrow{$n_1 \geq N$と$n_2 \geq N$より} \\
      & < \varepsilon + \varepsilon \\
      & = 2\varepsilon \\
      \therefore \quad |\alpha - \beta| & < 2\varepsilon
    \end{WithArrows}
  \end{equation}

  したがって、\hyperref[theorem:有限値εの不等式による一致の表現]{有限値εの不等式による一致の表現}より、
  \begin{equation}
    \alpha = \beta
  \end{equation}

  これで、数列$\{a_n\}$の極限値はただ1つに定まることが示された。$\qed$
\end{proof}

\subsection{定数数列の極限}

最も単純な数列の極限値を、$\varepsilon-N$論法で考えてみよう。

\vskip\baselineskip

ここでは、同じ数だけを並べた数列（定数数列）の極限を考える。

定数数列の極限を考えておくことで、のちに数列の定数倍の極限へと発展させることができる。

\begin{definition}{定数数列}
  任意の$n$に対して$a_n = c$となる数列$\{a_n\}$を定数数列という。
\end{definition}

\begin{center}
  \begin{tikzpicture}
    \def\xmax{9} % max x axis
    \def\ymax{2.5}
    \def\c{0.25}

    % AXIS
    \draw[axis] (0,-\ymax) -- (0,\ymax) node[above] {\large$a_n$};
    \draw[axis] (-0.2*\ymax,-\ymax + 1) -- (\xmax,-\ymax +1) node[right] {\large$n$};

    % 縦軸上のラベル
    \node[left, magenta, xshift=-0.5em] at (0, \c) {\Large$c$};

    % PLOT
    \draw[dotted, cyan, thick] (0,\c) -- (\xmax,\c);

    % 項を表す点を打つ
    \foreach \n in {0,1,2,...,\xmax}{
        \fill[ProcessBlue] (\n,\c) circle (2pt);
      }
  \end{tikzpicture}
\end{center}

定数$c$を並べた数列では、$n$を大きくしたときの$a_n$の値も変わらず$c$なのだから、極限値も当然$c$となりそうである。

\begin{theorem}{定数数列の極限}
  \titlegap
  任意の$n$に対して$a_n = c$となる定数数列$\{a_n\}$は収束し、その極限値は$c$となる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} a_n = c
  \end{equation}
\end{theorem}

このような当たり前に聞こえる事実も、$\varepsilon-N$論法では「当たり前」という直観を排除して議論できる。

\begin{proof}{定数数列の極限}
  $\varepsilon$を任意の正の数とする。

  $a_n$は$n$の値によらず$c$であるから、任意の$n$に対して次の式が成り立つ。
  \begin{align}
    |a_n - c|                  & = |c - c| = 0 < \varepsilon \\
    \therefore \quad |a_n - c| & < \varepsilon
  \end{align}

  したがって、
  \begin{equation}
    n \geq N \quad \Rightarrow \quad |a_n - c| < \varepsilon
  \end{equation}
  となるような自然数$N$は存在する（というか$N$はなんでもよい）。

  よって、$\{a_n\}$は収束し、その極限値は$c$である。$\qed$
\end{proof}

\subsection{数列の極限の線形性}

数列の極限についても、線形性が成り立つ。

\begin{theorem}{数列の極限の線形性}
  \titlegap
  数列$\{a_n\}$と$\{b_n\}$がともに収束するとき、$c$を実数とすると、数列$\{ca_n + cb_n\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} (ca_n + cb_n) = c\lim_{n \to \infty} a_n + c\lim_{n \to \infty} b_n
  \end{equation}
\end{theorem}

この線形性の式は、数列の和の極限と、数列の定数倍の極限を組み合わせたものになっている。

それぞれ証明することで、この線形性の式が成り立つことを確認しよう。

\subsubsection{数列の和の極限}

\begin{theorem}{数列の和の極限}
  \titlegap
  数列$\{a_n\}$と$\{b_n\}$がともに収束するとき、数列$\{a_n + b_n\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} (a_n + b_n) = \lim_{n \to \infty} a_n + \lim_{n \to \infty} b_n
  \end{equation}
\end{theorem}

$\{a_n\}$の極限値を$\alpha$、$\{b_n\}$の極限値を$\beta$とすると、最終的に次のような関係を導くことで、この定理が証明される。

\begin{equation}
  n \geq N \quad \Longrightarrow \quad |(a_n + b_n) - (\alpha + \beta)| < \varepsilon
\end{equation}

$|(a_n + b_n) - (\alpha + \beta)|$は、$a_n + b_n$と$\alpha + \beta$がどれだけ近いか、すなわち$a_n + b_n$と$\alpha + \beta$の誤差を表している。
そして、この誤差を$\varepsilon$より小さくする必要がある。

そのためには、$a_n$と$\alpha$の誤差を$\dfrac{\varepsilon}{2}$より小さくし、$b_n$と$\beta$の誤差も$\dfrac{\varepsilon}{2}$より小さくできればよい。

\begin{proof}{数列の和の極限}
  $\displaystyle\lim_{n \to \infty} a_n = \alpha$、$\displaystyle\lim_{n \to \infty} b_n = \beta$とおき、$\varepsilon$を任意の正の数とする。

  \vskip\baselineskip

  このとき、$\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N_1$が存在する。
  \begin{equation}
    n \geq N_1 \quad \Longrightarrow \quad |a_n - \alpha| < \frac{\varepsilon}{2}
  \end{equation}

  同様に、$\displaystyle\lim_{n \to \infty} b_n = \beta$より、次のような自然数$N_2$が存在する。
  \begin{equation}
    n \geq N_2 \quad \Longrightarrow \quad |b_n - \beta| < \frac{\varepsilon}{2}
  \end{equation}

  ここで、$N = \max\{N_1, N_2\}$とおくと、$n \geq N$のとき、$n \geq N_1$と$n \geq N_2$がともに成り立つ。
  \begin{equation}
    n \geq N \quad \Longrightarrow \quad |a_n - \alpha| < \frac{\varepsilon}{2} \quad \text{かつ} \quad |b_n - \beta| < \frac{\varepsilon}{2}
  \end{equation}

  よって、$n \geq N$のとき、三角不等式より、
  \begin{align}
    |(a_n + b_n) - (\alpha + \beta)|                  & = |(a_n - \alpha) + (b_n - \beta)|              \\
                                                      & \leq |a_n - \alpha| + |b_n - \beta|             \\
                                                      & < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} \\
                                                      & = \varepsilon                                   \\
    \therefore \quad |(a_n + b_n) - (\alpha + \beta)| & < \varepsilon
  \end{align}
  という不等式が成り立つことで、$\displaystyle\lim_{n \to \infty} (a_n + b_n) = \alpha + \beta$が示された。$\qed$
\end{proof}

数列$\{a_n\}$が$\alpha$に収束するということは、$\varepsilon-N$論法による数列の収束の定義より、

\begin{equation}
  n \geq N \Longrightarrow |a_n - \alpha| < \varepsilon
\end{equation}

という関係が成り立つということである。

ここでの$\varepsilon$は「任意の」正の数であるから、$\varepsilon$の部分にどんな正の数を当てはめても、この関係が成り立つことになる。

数列の和の極限の証明では、$\varepsilon$の部分に$\dfrac{\varepsilon}{2}$を当てはめた関係を利用している。

\subsubsection{数列の定数倍の極限}

\begin{theorem}{数列の定数倍の極限}
  \titlegap
  数列$\{a_n\}$が収束するとき、$c$を実数とすると、数列$\{ca_n\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} (ca_n) = c\lim_{n \to \infty} a_n
  \end{equation}
\end{theorem}

$\{a_n\}$の極限値を$\alpha$とすれば、$ca_n$と$c\alpha$の誤差を$\varepsilon$より小さくする必要がある。

あとから誤差が最大$|c|$倍されても大丈夫なように、$a_n$と$\alpha$の誤差は$\dfrac{\varepsilon}{|c|}$より小さくできればよい。

\begin{supplnote}
  $c$は正の数とは限らない。誤差は任意の正の数$\varepsilon$と比較するために正の数として評価したいので、絶対値をつけている。
\end{supplnote}

$|c|$が分母にあるので、$c=0$の場合は除外して考える必要がある。

$c=0$の場合は、定数数列の極限として考えることで、$0$に収束することがわかる。

\begin{proof}{数列の定数倍の極限}
  $c=0$と$c\neq 0$の場合に分けて証明する。

  \begin{subpattern}{$c=0$の場合}
    $c=0$のとき、右辺は、
    \begin{equation}
      c \lim_{n \to \infty} a_n = 0 \cdot \lim_{n \to \infty} a_n = 0
    \end{equation}

    また、左辺は、定数数列の極限として考えて、
    \begin{equation}
      \lim_{n \to \infty} (ca_n) = \lim_{n \to \infty} 0 = 0
    \end{equation}

    したがって、$c=0$の場合は、$\displaystyle\lim_{n \to \infty} (ca_n) = c\lim_{n \to \infty} a_n = 0$が成り立つ。
  \end{subpattern}

  \begin{subpattern}{$c\neq 0$の場合}
    $\displaystyle\lim_{n \to \infty} a_n = \alpha$とおき、$\varepsilon$を任意の正の数とする。

    \vskip\baselineskip

    このとき、$\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N$が存在する。
    \begin{equation}
      n \geq N \quad \Longrightarrow \quad |a_n - \alpha| < \frac{\varepsilon}{|c|}
    \end{equation}

    よって、$n \geq N$のとき、
    \begin{equation}
      \begin{WithArrows}
        |ca_n - c\alpha| & = |c(a_n -\alpha)|               \Arrow{$|AB|=|A||B|$}   \\
        & = |c||a_n - \alpha|             \Arrow{$|a_n - \alpha| < \dfrac{\varepsilon}{|c|}$}  \\
        & < |c| \cdot \dfrac{\varepsilon}{|c|} \\
        & = \varepsilon
      \end{WithArrows}
    \end{equation}
    \begin{equation}
      \therefore \quad |ca_n - c\alpha| < \varepsilon
    \end{equation}
    という不等式が成り立つことで、$\displaystyle\lim_{n \to \infty} ca_n = c\alpha$がいえる。
  \end{subpattern}

  以上より、いずれの場合も、数列$\{ca_n\}$は$c\alpha$に収束することが示された。$\qed$
\end{proof}

\subsection{数列の積の極限}

\begin{theorem}{数列の積の極限}
  \titlegap
  数列$\{a_n\}$と$\{b_n\}$がともに収束するとき、数列$\{a_n b_n\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} a_n b_n = \lim_{n \to \infty} a_n \cdot \lim_{n \to \infty} b_n
  \end{equation}
\end{theorem}

$\{a_n\}$の極限値を$\alpha$、$\{b_n\}$の極限値を$\beta$とすると、最終的に次のような関係を導くことで、この定理が証明される。

\begin{equation}
  n \geq N \quad \Longrightarrow \quad |a_n b_n - \alpha \beta| < \varepsilon
\end{equation}

$a_n b_n$と$\alpha \beta$の誤差$|a_n b_n - \alpha \beta|$を、三角不等式で見積もっておこう。
\begin{align*}
  |a_n b_n - \alpha \beta| & = |a_n b_n - a_n \beta + a_n \beta - \alpha \beta| \\
                           & = |a_n(b_n - \beta) + \beta(a_n - \alpha)|         \\
                           & \leq |a_n||b_n - \beta| + |\beta||a_n - \alpha|
\end{align*}

ここで、$\{a_n\}$の極限値が$\alpha$、$\{b_n\}$の極限値が$\beta$であることから、任意の正の数を$\varepsilon'$として、$|a_n - \alpha| < \varepsilon'$、$|b_n - \beta| < \varepsilon'$という関係を使うことができる。

\vskip\baselineskip

ここまでで得られた不等式において、$|a_n|$の部分も$|\alpha|$に置き換えたいが、このときに$a_n$と$\alpha$の誤差$\varepsilon'$を考慮する必要がある。
\begin{align*}
  |a_n| - |\alpha| & \leq |a_n - \alpha| < \varepsilon' \\
  |a_n|            & < |\alpha| + \varepsilon'
\end{align*}
これを使うことで、
\begin{align*}
  |a_n b_n - \alpha \beta| & \leq |a_n||b_n - \beta| + |\beta||a_n - \alpha|                  \\
                           & < (|\alpha| + \varepsilon')|b_n - \beta| + |\beta||a_n - \alpha| \\
                           & = (|\alpha| + \varepsilon')\varepsilon' + |\beta|\varepsilon'    \\
                           & < |\alpha|\varepsilon' + \varepsilon'^2 + |\beta|\varepsilon'    \\
                           & = (|\alpha| + |\beta| + \varepsilon')\varepsilon'
\end{align*}
また、$\varepsilon'$は任意の正の数であるが、結局はどんどん小さな数に狭めていくものなので、最初から$1$未満に設定して$0 < \varepsilon' < 1$としてもよい。
\begin{align*}
  |a_n b_n - \alpha \beta| & < (|\alpha| + |\beta| + \varepsilon')\varepsilon' \\
                           & < (|\alpha| + |\beta| + 1)\varepsilon'
\end{align*}
以上の考察を、次のような証明として落とし込む。

\vskip\baselineskip

\begin{proof}{数列の積の極限}
  $\displaystyle\lim_{n \to \infty} a_n = \alpha$、$\displaystyle\lim_{n \to \infty} b_n = \beta$とおき、$\varepsilon$を任意の正の数とする。

  \vskip\baselineskip

  極限を考えるので、$0 < \varepsilon < |\alpha| + |\beta| + 1$としてもよい。

  そこで、
  \begin{equation*}
    \varepsilon' = \dfrac{\varepsilon}{|\alpha| + |\beta| + 1}
  \end{equation*}
  とおくと、$0 < \varepsilon' < 1$である。

  \vskip\baselineskip

  このとき、$\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N_1$が存在する。
  \begin{equation}
    n \geq N_1 \quad \Longrightarrow \quad |a_n - \alpha| < \varepsilon'
  \end{equation}

  同様に、$\displaystyle\lim_{n \to \infty} b_n = \beta$より、次のような自然数$N_2$が存在する。
  \begin{equation}
    n \geq N_2 \quad \Longrightarrow \quad |b_n - \beta| < \varepsilon'
  \end{equation}

  ここで、$N = \max\{N_1, N_2\}$とおくと、$n \geq N$のとき、$n \geq N_1$と$n \geq N_2$がともに成り立つ。
  \begin{equation}
    n \geq N \quad \Longrightarrow \quad |a_n - \alpha| < \varepsilon' \quad \text{かつ} \quad |b_n - \beta| < \varepsilon'
  \end{equation}

  よって、$n \geq N$のとき、三角不等式と$0 < \varepsilon' < 1$より、
  \begin{align*}
    |a_n b_n - \alpha \beta|                  & \leq |a_n||b_n - \beta| + |\beta||a_n - \alpha|               \\
                                              & < (|\alpha| + \varepsilon')\varepsilon' + |\beta|\varepsilon' \\
                                              & = (|\alpha| + |\beta| + \varepsilon')\varepsilon'             \\
                                              & < (|\alpha| + |\beta| + 1)\varepsilon'                        \\
                                              & = \varepsilon                                                 \\
    \therefore \quad |a_n b_n - \alpha \beta| & < \varepsilon
  \end{align*}
  という不等式が成り立つことで、$\displaystyle\lim_{n \to \infty} (a_n b_n) = \alpha \beta$が示された。$\qed$
\end{proof}

\subsection{数列の商の極限}

\begin{theorem}{数列の逆数の極限}
  \titlegap
  数列$\{a_n\}$がともに収束し、$\displaystyle\lim_{n \to \infty} a_n \neq 0$のとき、数列$\left\{\dfrac{1}{a_n}\right\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} \dfrac{1}{a_n} = \dfrac{1}{\displaystyle\lim_{n \to \infty} a_n}
  \end{equation}
\end{theorem}

$\{a_n\}$の極限値を$\alpha$とすると、最終的に次のような関係を導くことで、上の式は証明される。
\begin{equation}
  n \geq N \quad \Longrightarrow \quad \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right| < \varepsilon
\end{equation}
ここでも、$\dfrac{1}{a_n}$と$\dfrac{1}{\alpha}$の誤差$\left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right|$を、三角不等式で見積もっておく。
\begin{align*}
  \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right| & = \left|\dfrac{\alpha - a_n}{a_n \alpha}\right| \\
                                                  & = \dfrac{|a_n - \alpha|}{|a_n \alpha|}
\end{align*}
ここで、$0< \varepsilon' < \dfrac{|\alpha|}{2}$とすると、
\begin{gather*}
  \left|a_n - \alpha\right| < \varepsilon' < \dfrac{|\alpha|}{2} \\
  \therefore \quad \left|a_n-\alpha\right| < \dfrac{\left|\alpha\right|}{2}
\end{gather*}
また、三角不等式より、
\begin{gather*}
  \left| |a_n| - |\alpha| \right| \leq |a_n - \alpha| < \dfrac{\left|\alpha\right|}{2} \\
  - \dfrac{|\alpha|}{2} < |a_n| - |\alpha| < \dfrac{|\alpha|}{2} \\
  |\alpha| - \dfrac{|\alpha|}{2} < |a_n| \\
  \dfrac{2|\alpha|}{2} - \dfrac{|\alpha|}{2} < |a_n| \\
  \therefore \quad \dfrac{|\alpha|}{2} < |a_n|
\end{gather*}
が成り立つことを利用して、
\begin{align*}
  \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right| & < \dfrac{|a_n - \alpha|}{|a_n \alpha|}                                             \\
                                                  & < \dfrac{|a_n - \alpha|}{\dfrac{\left|\alpha\right|}{2} \cdot \left|\alpha\right|} \\
                                                  & = \dfrac{2}{|\alpha|^2}|a_n - \alpha|                                              \\
\end{align*}
このような不等式から、次のように証明を組み立てる。

\begin{proof}{数列の逆数の極限}
  $\displaystyle\lim_{n \to \infty} a_n = \alpha$、$\displaystyle\lim_{n \to \infty} b_n = \beta$とおき、$\varepsilon$を任意の正の数とする。

  \vskip\baselineskip

  $\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N_1$が存在する。
  \begin{equation}
    n \geq N_1 \quad \Longrightarrow \quad |a_n - \alpha| < \dfrac{|\alpha|}{2}
  \end{equation}
  このとき、$n \geq N_1$ならば、三角不等式より次のような不等式が成り立つ。
  \begin{equation*}
    \dfrac{|\alpha|}{2} < |a_n|
  \end{equation*}
  よって、$n \geq N_1$とすると、$a_n \neq 0$である。

  このとき、次のような不等式も得られる。
  \begin{align*}
    \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right| & < \dfrac{|a_n - \alpha|}{|a_n \alpha|} \\
                                                    & < \dfrac{2}{|\alpha|^2}|a_n - \alpha|
  \end{align*}

  \vskip\baselineskip

  一方、$\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N_2$も存在する。
  \begin{equation*}
    n \geq N_2 \quad \Longrightarrow \quad |a_n - \alpha| < \dfrac{\varepsilon}{\dfrac{2}{|\alpha|^2}}
  \end{equation*}

  ここで、$N = \max\{N_1, N_2\}$とおくと、$n \geq N$のとき、$n \geq N_1$と$n \geq N_2$がともに成り立つ。

  よって、$n \geq N$のとき、
  \begin{align*}
    \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right|                  & < \dfrac{2}{|\alpha|^2}|a_n - \alpha|                                    \\
                                                                     & < \dfrac{2}{|\alpha|^2} \cdot \dfrac{\varepsilon}{\dfrac{2}{|\alpha|^2}} \\
                                                                     & = \varepsilon                                                            \\
    \therefore \quad \left|\dfrac{1}{a_n} - \dfrac{1}{\alpha}\right| & < \varepsilon
  \end{align*}
  という不等式が成り立つことで、$\displaystyle\lim_{n \to \infty} \dfrac{1}{a_n} = \dfrac{1}{\alpha}$が示された。$\qed$
\end{proof}

今示した数列の逆数の極限と、数列の積の極限を組み合わせることで、数列の商の極限も求めることができる。
\begin{equation*}
  \lim_{n \to \infty} \dfrac{b_n}{a_n} = \lim_{n\to\infty}\dfrac{1}{a_n} \cdot \lim_{n\to\infty} b_n
\end{equation*}

\begin{theorem}{数列の商の極限}
  \titlegap
  数列$\{a_n\}$と$\{b_n\}$がともに収束し、$\displaystyle\lim_{n \to \infty} a_n \neq 0$のとき、数列$\left\{\dfrac{b_n}{a_n}\right\}$も収束する。\\
  そして、その極限値は次のようになる。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} \dfrac{b_n}{a_n} = \dfrac{\displaystyle\lim_{n \to \infty} b_n}{\displaystyle\lim_{n \to \infty} a_n}
  \end{equation}
\end{theorem}

\subsection{数列の極限の大小関係の保存}

\todo{定理2.5}

\subsection{はさみうちの原理}

はさみうちの原理は、

\begin{emphabox}
  ある数列が2つの数列に挟まれていて、その2つの数列の極限値が同じなら、挟まれた数列の極限値も同じになる。
\end{emphabox}

という内容の定理である。

この定理により、直接極限を求めにくい数列でも、簡単な数列で挟むことで極限値を求めることが容易になる。

\begin{center}
  \begin{tikzpicture}
    \def\xmax{8.6} % max x axis
    \def\ymax{3.25}
    \def\A{2.5} % 振幅を大きく
    \def\om{(7.5*360/(0.94*\xmax))} % 周期を短く（振動数を上げる）
    \def\t{1800/(0.94*\xmax)}
    \def\T{2.0} % 減衰をやや速める
    \def\samp{100} % number of samples

    % AXIS
    \draw[axis] (0,-\ymax-0.2*\ymax) -- (0,\ymax) node[above] {\large$a_n$};
    \draw[axis] (-0.2*\ymax,-\ymax+0.25) -- (\xmax,-\ymax+0.25) node[right] {\large$n$};

    % 極限値を表す直線
    \draw[BurntOrange, very thick] ($(0,\A)!.5!(0,-\A)$) --++ (\xmax,0);
    \node[left, BurntOrange] at ($(0,\A)!.5!(0,-\A)$) {\Large$\alpha$};

    % PLOT
    \draw[dotted, rosebonbon, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)});
    \draw[dotted, robineggblue, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{-\A*exp(-\t/\T)});
    \draw[dotted, Goldenrod!80!gray, thick, samples=100+\samp, smooth, variable=\t, domain=0:\xmax] plot(\t,{\A*exp(-\t/\T)*cos(\om*\t)});

    % 一定周期で関数上に点を打つ
    \foreach \i in {0,0.2,0.4,...,\xmax}{
        \fill[Goldenrod] ({\i}, {\A*exp(-\i/\T)*cos(\om*\i)}) circle (1.8pt);
      }
    \foreach \i in {0,0.4,0.8,...,\xmax}{
        \fill[rosebonbon] ({\i}, {\A*exp(-\i/\T)}) circle (1.8pt);
        \fill[robineggblue] ({\i}, {-\A*exp(-\i/\T)}) circle (1.8pt);
      }
  \end{tikzpicture}
\end{center}

\begin{theorem}{数列の極限に関するはさみうちの定理}
  \titlegap
  数列$\{a_n\}$、$\{b_n\}$、$\{c_n\}$が、ある自然数$n_0$について、
  \Large
  \begin{equation}
    a_n \leq c_n \leq b_n \quad (n \geq n_0)
  \end{equation}
  \normalsize
  という関係が成り立つとする。
  このうち、$\{a_n\}$と$\{b_n\}$が収束し、
  \Large
  \begin{equation}
    \lim_{n \to \infty} a_n = \lim_{n \to \infty} b_n = \alpha
  \end{equation}
  \normalsize
  が成り立つならば、$\{c_n\}$も収束し、
  \Large
  \begin{equation}
    \lim_{n \to \infty} c_n = \alpha
  \end{equation}
  \normalsize
  が成り立つ。
\end{theorem}

すべての自然数$n$に対して$a_n \leq c_n \leq b_n$である必要はない。

たとえば、$5$以上の$n$に対して$a_n \leq c_n \leq b_n$が成り立つ場合（$n_0 = 5$の場合）にも、はさみうちの定理は適用できる。

\begin{proof}{数列の極限に関するはさみうちの定理}
  $\varepsilon$を任意の正の数とする。

  \vskip\baselineskip

  このとき、$\displaystyle\lim_{n \to \infty} a_n = \alpha$より、次のような自然数$N_1$が存在する。
  \begin{equation}
    n \geq N_1 \quad \Longrightarrow \quad |a_n - \alpha| < \varepsilon
  \end{equation}

  同様に、$\displaystyle\lim_{n \to \infty} b_n = \beta$より、次のような自然数$N_2$が存在する。
  \begin{equation}
    n \geq N_2 \quad \Longrightarrow \quad |b_n - \beta| < \varepsilon
  \end{equation}

  ここで、$N = \max\{N_1, N_2, n_0\}$とおくと、$n \geq N$のとき、$n \geq n_0$、$n \geq N_1$、$n \geq N_2$がすべて成り立つ。

  よって、$n \geq N$のとき、

  \wip
\end{proof}

\subsection{ε- N論法による数列の発散}

数列がどんな実数にも収束しないとき、その数列は\keyword{発散}するという。

\subsubsection{正の無限大への発散}

数列の項が先に進むにつれて限りなく大きくなる場合に、その数列は\keyword{正の無限大に発散}するという。

\vskip\baselineskip

「ここから先の項はすべて$K$より大きくなる」といえる位置に、$N$という印をつけるようにしよう。

\begin{center}
  \scalebox{0.8}{
    \begin{tikzpicture}
      \def\N{3.5} % N
      \def\K{-1.25} % K

      \def\xmax{8.25} % max x axis
      \def\ymax{3.25}
      \def\ymin{-\ymax-0.2*\ymax}
      \def\samp{100} % number of samples
      \def\fn#1{exp(0.25*#1)-3.5}

      % AXIS
      \draw[axis] (0,\ymin) -- (0,\ymax) node[above] {\large$a_n$};
      \draw[axis] (-0.2*\ymax,-\ymax+0.25) -- (\xmax,-\ymax+0.25) node[right] {\large$n$};

      % Nより右で、Kより上の空間
      \fill[carnationpink, opacity=0.4] (\N,\K) rectangle (\xmax,\ymax);

      % PLOT
      \begin{scope}
        \clip (-1,-\ymax) rectangle (\xmax,\ymax);
        \draw[dotted, BurntOrange, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{\fn{\t}});

        % 一定周期で関数上に点を打つ
        \foreach \i in {0,0.4,0.8,...,\xmax}{
            \fill[BurntOrange] ({\i}, {\fn{\i}}) circle (1.8pt);
          }
      \end{scope}

      % N以降を表す矢印
      \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-2) -- (\xmax,-2);

      % N直線
      \draw[malachite, very thick] (\N,\ymin) -- (\N,\ymax);
      \node[malachite] at (\N,\ymin) [below] {\Large$N$};

      % K直線
      \draw[magenta, thick] (-0.2*\ymax,\K) -- (\xmax,\K);
      \node[magenta] at (-0.2*\ymax,\K) [left] {\Large$K$};
    \end{tikzpicture}
  }
\end{center}

どれだけ$K$を大きくしても、$N$をずらしていけば、$N$以降は$K$を超える項だけになる。

\begin{center}
  \scalebox{0.8}{
    \begin{tikzpicture}
      \def\N{6.5} % N
      \def\K{1.75} % K

      \def\xmax{8.25} % max x axis
      \def\ymax{3.25}
      \def\ymin{-\ymax-0.2*\ymax}
      \def\samp{100} % number of samples
      \def\fn#1{exp(0.25*#1)-3.5}

      % AXIS
      \draw[axis] (0,\ymin) -- (0,\ymax) node[above] {\large$a_n$};
      \draw[axis] (-0.2*\ymax,-\ymax+0.25) -- (\xmax,-\ymax+0.25) node[right] {\large$n$};

      % Nより右で、Kより上の空間
      \fill[carnationpink, opacity=0.4] (\N,\K) rectangle (\xmax,\ymax);

      % PLOT
      \begin{scope}
        \clip (-1,-\ymax) rectangle (\xmax,\ymax);
        \draw[dotted, BurntOrange, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{\fn{\t}});

        % 一定周期で関数上に点を打つ
        \foreach \i in {0,0.4,0.8,...,\xmax}{
            \fill[BurntOrange] ({\i}, {\fn{\i}}) circle (1.8pt);
          }
      \end{scope}

      % N以降を表す矢印
      \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-2) -- (\xmax,-2);

      % N直線
      \draw[malachite, very thick] (\N,\ymin) -- (\N,\ymax);
      \node[malachite] at (\N,\ymin) [below] {\Large$N$};

      % K直線
      \draw[magenta, thick] (-0.2*\ymax,\K) -- (\xmax,\K);
      \node[magenta] at (-0.2*\ymax,\K) [left] {\Large$K$};
    \end{tikzpicture}
  }
\end{center}

このような状況が、正の無限大への発散である。

\vskip\baselineskip

$K$をどんなに大きくしても、「$N$番目以降の項は$K$よりも大きくなる」といえるような$N$を設定できるか？が肝心で、そのような$N$が存在するなら、数列は正の無限大に発散すると定義する。

\begin{definition}{数列の正の無限大への発散}
  \titlegap
  数列$\{a_n\}_{n=1}^{\infty}$について、次の条件を考える。
  \begin{spacebox}
    任意の正の実数$K$に対して
    \Large
    \begin{equation}
      n \geq N \quad \Longrightarrow \quad a_n > K
    \end{equation}
    \normalsize
    が成り立つような自然数$N$が存在する
  \end{spacebox}
  この条件が成り立つとき、数列$\{a_n\}$は\hl{正の無限大に発散}するといい、次のように表す。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} a_n = \infty
  \end{equation}
\end{definition}

\subsubsection{負の無限大への発散}

逆に、数列の項が先に進むにつれて限りなく小さくなる場合には、その数列は\keyword{負の無限大に発散}するという。

\vskip\baselineskip

「ここから先の項はすべて$K$より小さくなる」といえる位置に、$N$という印をつけるようにする。

\begin{center}
  \scalebox{0.8}{
    \begin{tikzpicture}
      \def\N{4.5} % N
      \def\K{-2.75} % K

      \def\xmin{-1}
      \def\xmax{7.5} % max x axis
      \def\ymax{1}
      \def\ymin{-6}
      \def\samp{100} % number of samples
      \def\fn#1{-exp(0.25*#1)+0.5}

      % AXIS
      \draw[axis] (0,\ymin) -- (0,\ymax) node[above] {\large$a_n$};
      \draw[axis] (\xmin,-\ymax-1) -- (\xmax,-\ymax-1) node[right] {\large$n$};

      % Nより右で、Kより上の空間
      \fill[columbiablue, opacity=0.5] (\N,\K) rectangle (\xmax,\ymin);

      % PLOT
      \begin{scope}
        \clip (-1,\ymin) rectangle (\xmax,\ymax);
        \draw[dotted, BurntOrange, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{\fn{\t}});

        % 一定周期で関数上に点を打つ
        \foreach \i in {0,0.4,0.8,...,\xmax}{
            \fill[BurntOrange] ({\i}, {\fn{\i}}) circle (1.8pt);
          }
      \end{scope}

      % N以降を表す矢印
      \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-1) -- (\xmax,-1);

      % N直線
      \draw[malachite, very thick] (\N,\ymin) -- (\N,\ymax);
      \node[malachite] at (\N,\ymax) [above] {\Large$N$};

      % K直線
      \draw[Cerulean, thick] (-0.2*\ymax,\K) -- (\xmax,\K);
      \node[Cerulean] at (-0.2*\ymax,\K) [left] {\Large$K$};
    \end{tikzpicture}
  }
\end{center}

どれだけ$K$を小さくしても、$N$をずらしていけば、$N$以降は$K$より小さい項だけになる。

\begin{center}
  \scalebox{0.8}{
    \begin{tikzpicture}
      \def\N{6.5} % N
      \def\K{-4.75} % K

      \def\xmin{-1}
      \def\xmax{7.5} % max x axis
      \def\ymax{1}
      \def\ymin{-6}
      \def\samp{100} % number of samples
      \def\fn#1{-exp(0.25*#1)+0.5}

      % AXIS
      \draw[axis] (0,\ymin) -- (0,\ymax) node[above] {\large$a_n$};
      \draw[axis] (\xmin,-\ymax-1) -- (\xmax,-\ymax-1) node[right] {\large$n$};

      % Nより右で、Kより上の空間
      \fill[columbiablue, opacity=0.5] (\N,\K) rectangle (\xmax,\ymin);

      % PLOT
      \begin{scope}
        \clip (-1,\ymin) rectangle (\xmax,\ymax);
        \draw[dotted, BurntOrange, thick, samples=\samp,smooth,variable=\t,domain=0:\xmax] plot(\t,{\fn{\t}});

        % 一定周期で関数上に点を打つ
        \foreach \i in {0,0.4,0.8,...,\xmax}{
            \fill[BurntOrange] ({\i}, {\fn{\i}}) circle (1.8pt);
          }
      \end{scope}

      % N以降を表す矢印
      \draw[lawngreen, opacity=0.8, -{Triangle[width = 18pt, length = 8pt]}, line width = 9pt] (\N,-1) -- (\xmax,-1);

      % N直線
      \draw[malachite, very thick] (\N,\ymin) -- (\N,\ymax);
      \node[malachite] at (\N,\ymax) [above] {\Large$N$};

      % K直線
      \draw[Cerulean, thick] (-0.2*\ymax,\K) -- (\xmax,\K);
      \node[Cerulean] at (-0.2*\ymax,\K) [left] {\Large$K$};
    \end{tikzpicture}
  }
\end{center}

このような状況が、負の無限大への発散である。

\begin{definition}{数列の負の無限大への発散}
  \titlegap
  数列$\{a_n\}_{n=1}^{\infty}$について、次の条件を考える。
  \begin{spacebox}
    任意の負の実数$K$に対して
    \Large
    \begin{equation}
      n \geq N \quad \Longrightarrow \quad a_n < K
    \end{equation}
    \normalsize
    が成り立つような自然数$N$が存在する
  \end{spacebox}
  この条件が成り立つとき、数列$\{a_n\}$は\hl{負の無限大に発散}するといい、次のように表す。
  \LARGE
  \begin{equation}
    \lim_{n \to \infty} a_n = -\infty
  \end{equation}
\end{definition}

\subsection{追い出しの原理}

\todo{定理2.18}

\subsection{発散数列の和と積}

\todo{定理2.18}

\subsection{数列の偶数番目と奇数番目の極限による判定}

\todo{命題2.13}

\subsection{数列の極限と絶対値}

\todo{定理2.15}

\subsection{逆数の数列の発散条件}

\todo{定理2.16}
\todo{定理2.17}

\subsection{等比数列の極限}

\todo{命題3.1}

\subsection{項の比による収束判定}

\todo{定理3.8}

\subsection{発散数列の増加速度の比較}

\todo{例題3.9}

\end{document}
