\documentclass[../book_jiriki_calc]{subfiles}

\begin{document}

\section{微分しても変わらない不思議な関数}

この式をぼんやりと眺めていると、
\begin{equation}
  \dfrac{d}{dx}x^n = nx^{n-1}
\end{equation}

\begin{itemize}
  \item 左辺における$\dfrac{d}{dx}$という記号に呼応して、右辺では$n$が飛び出すというふうにも見える
  \item 左辺では$x$の$n$乗だったものが、右辺では$n-1$乗になっている
\end{itemize}

\sectionline

$x^n$を$n$の階乗で割った$\dfrac{x^n}{n!}$という関数を考える

\br

この関数を微分すると、$\dfrac{1}{n!}$は微分の外に出せる
\begin{equation}
  \dfrac{d}{dx}\left(\dfrac{x^n}{n!}\right) = \dfrac{1}{n!}\left(\dfrac{d}{dx}x^n\right) = \dfrac{nx^{n-1}}{n!} = \dfrac{x^{n-1}}{(n-1)!}
\end{equation}

この式では、左辺と右辺で似た形が現れている

文字は左辺の$n$から右辺の$n-1$に化けるが、形は同じ

\br

$n$に具体的な数を入れて確かめてみる
\begin{itemize}
  \item $n=0$のとき、$\dfrac{d}{dx}\left(\dfrac{x^0}{0!}\right) = 0$
  \item $n=1$のとき、$\dfrac{d}{dx}\left(\dfrac{x^1}{1!}\right) = \dfrac{x^0}{0!}$
  \item $n=2$のとき、$\dfrac{d}{dx}\left(\dfrac{x^2}{2!}\right) = \dfrac{x^1}{1!}$
  \item $n=3$のとき、$\dfrac{d}{dx}\left(\dfrac{x^3}{3!}\right) = \dfrac{x^2}{2!}$
  \item $n=4$のとき、$\dfrac{d}{dx}\left(\dfrac{x^4}{4!}\right) = \dfrac{x^3}{3!}$
  \item $n=5$のとき、$\dfrac{d}{dx}\left(\dfrac{x^5}{5!}\right) = \dfrac{x^4}{4!}$
\end{itemize}
微分すると斜め右下にまったく同じ形の式が現れるというパターンが続く

上のリストでは$n=5$で止めているが、たとえば$n=100$までいっても同じパターンが続く

\br

そこで、$\dfrac{x^n}{n!}$を$n=0$から順に全部足すことを考え、それを$f(x)$とおく
\begin{align}
  f(x)              & = \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \dfrac{x^3}{3!} + \cdots \\
  \dfrac{d}{dx}f(x) & = 0 + \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \cdots
\end{align}
下の式は1個右にずれているので、途中で打ち切れば1個足りなくなるが、無限に足すと、上の式と下の式はぴったり一致している

したがって、
\begin{equation}
  \dfrac{d}{dx}f(x) = f(x)
\end{equation}
が成り立つことがわかる

つまり、\keyword{関数$f(x)$は微分したものが自分自身になっている！}

\br

いま無限級数として定義した関数$f(x)$を何通りかの記法で表しておく
\begin{align}
  f(x) & = \sum_{n=0}^{\infty} \dfrac{x^n}{n!}                                            \\
       & = \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \dfrac{x^3}{3!} + \cdots \\
       & = 1 + x + \dfrac{x^2}{2} + \dfrac{x^3}{6} + \cdots
\end{align}
後にこの関数は、\keyword{指数関数}として$e^x$と書くことになる

\section{ネイピアの数}

次の関数に$x=0$と$x=1$を代入してみる
\begin{equation}
  f(x) = 1 + x + \dfrac{1}{2!}x^2 + \dfrac{1}{3!}x^3 + \cdots
\end{equation}

\sectionline

\subparagraph{$x=0$を代入すると}

最初の$1$だけが残り、
\begin{equation}
  f(0) = 1
\end{equation}

\sectionline

\subparagraph{$x=1$を代入すると}

$1$を何乗しても$1$であるから、
\begin{equation}
  f(1) = 1 + 1 + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots
\end{equation}

\br

この$f(1)$の数値はどのくらいになるだろうか？
\begin{enumerate}
  \item 第1項は$1$
  \item 第2項も$1$
  \item 第3項は$0.5$
  \item 次は前の項を$3$で割るわけだから$0.166\ldots$
  \item 次はさらに$4$で割るから$0.041\ldots$
  \item 次はさらにそれを$5$で割って$0.008\ldots$
\end{enumerate}
ここまでの$6$項の和で$2.716\ldots$となる

\br

加える項は急速に$0$に近づく

項が100個くらいまで進むと、次に加える$\dfrac{1}{100!}$は小数点以下に$0$が150個以上並ぶくらい小さな数になる（$10^{152}<100!<10^{164}$という不等式より）

\br

このように、無限級数$f(1)$は収束がとても速く、
\begin{equation}
  f(1) = 2.71828\ldots
\end{equation}
という数になる

\sectionline

\paragraph{定理}

\begin{equation}
  \lim_{n\to\infty}\left(1+\dfrac{1}{n}\right)^n = \sum_{k=0}^{\infty} \dfrac{1}{k!}
\end{equation}

\br

\subparagraph{証明のスケッチ}

二項展開を用いて、
\begin{align}
  \left(1+\dfrac{1}{n}\right)^n
   & = \sum_{k=0}^{n} \frac{n!}{k!(n-k)!} \cdot \frac{1}{n^k}
  %& = 1 + 1 + \dfrac{1}{2!}\left(1-\dfrac{1}{n}\right)                                             \\\\
  %& \phantom{=====} + \dfrac{1}{3!}\left(1-\dfrac{1}{n}\right)\left(1-\dfrac{2}{n}\right) + \cdots
\end{align}

ここで、$k=2$以降の各項は次のように展開する
\begin{align}
  \frac{n!}{2!(n-2)!} \cdot \frac{1}{n^2}
   & = \frac{n(n-1)}{2!} \cdot \frac{1}{n^2}       \\
   & = \dfrac{1}{2!} \cdot \dfrac{n-1}{n}          \\
   & = \frac{1}{2!} \left( 1 - \frac{1}{n} \right)
\end{align}

\begin{align}
  \frac{n!}{3!(n-3)!} \cdot \frac{1}{n^3}
   & = \frac{n(n-1)(n-2)}{3!} \cdot \frac{1}{n^3}                                 \\
   & = \dfrac{1}{3!} \cdot \dfrac{n-1}{n} \cdot \dfrac{n-2}{n}                    \\
   & = \frac{1}{3!} \left( 1 - \frac{1}{n} \right) \left( 1 - \frac{2}{n} \right)
\end{align}

これらを用いると、
\begin{multline}
  \left(1+\dfrac{1}{n}\right)^n = 1 + 1 + \dfrac{1}{2!}\left(1-\dfrac{1}{n}\right) \\
  + \dfrac{1}{3!}\left(1-\dfrac{1}{n}\right)\left(1-\dfrac{2}{n}\right) + \cdots
\end{multline}
$n$が大きくなると$\dfrac{1}{n}$は$0$に近づくので、$1-\dfrac{1}{n}$は$1$に近づき、
\begin{equation}
  \left(1+\dfrac{1}{n}\right)^n = 1 + 1 + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots
\end{equation}
となる$\qed$

\section{無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$の収束}

$n$を大きくすると$n!$は急速に大きくなるので、$x=1$のときには無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}=\sum_{n=0}^{\infty} \dfrac{1}{n!}$が収束することは納得できる

\br

では、$x>1$のときもこの無限級数は収束するといえるのだろうか？

\sectionline

そもそも数列の各項が$0$に近づかないと、その数列の総和は収束しないため、まず次の問いを考える
（以下では$x$を固定しておく）

\br

\paragraph{問題}

$n$をどんどん大きくしたとき、$\dfrac{x^n}{n!}$は$0$に近づくか？

\br

この問いは、$x^n$と$n!$の大きさを比べようという問題である

たとえば$n=100$とすると、実は$100!$の方が$10^{100}$よりも圧倒的に大きくなることをすでに示している

\br

$n=100$に限らず、「$x$を止めたとき、$x^n$と$n!$の比である$\dfrac{x^n}{n!}$は、$n$を大きくすると分母が圧倒的に大きくなり、比は$0$に近づく」ことが同様の議論で示される

\sectionline

無限級数の各項が$0$に近づいたとしても、「塵も積もれば山となる」（足し合わせると発散する）ことも起こり得る

\br

では、次の問題はどうだろうか？

\br

\paragraph{問題}

無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$は収束するか？

\br

実はこの無限級数は、等比級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{1}{2^n}$よりももっと速く収束する

\br

\subparagraph{証明のスケッチ}\quad

$x$は固定して、$n$に関する和を考える

\br

整数$n$が十分に大きければ、
\begin{equation}
  \dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}
\end{equation}

これは、「無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$が等比級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{1}{2^n}$より速く収束する」という1つの表現

\br

正確には、$8x^2+1$より大きいすべての自然数$n$に対して、
\begin{equation}
  \dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}
\end{equation}
が成り立つ

このことがいえれば、$8x^2$より大きい整数$N$に対して、無限級数$\displaystyle\sum_{n=N+1}^{\infty} \dfrac{x^n}{n!}$は次のように等比級数$\displaystyle\sum_{n=N+1}^{\infty} \dfrac{1}{2^n}$より速く収束する
\begin{align}
  \left| \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!} \right|
   & \leq \sum_{n=N+1}^{\infty} \dfrac{\left| x \right|^n}{2^n} \\
   & < \sum_{n=N+1}^{\infty} \dfrac{1}{2^n}                     \\
   & = \dfrac{1}{2^{N}}
\end{align}

上の計算のうち、$\displaystyle\left| \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!} \right| \leq \sum_{n=N+1}^{\infty} \dfrac{\left| x \right|^n}{2^n}$では、次のような三角不等式を利用している
\begin{align}
  \left| a_1 + a_2 + \dots + a_m \right|   & \leq |a_1| + |a_2| + \dots + |a_m| \\
  \left| \sum_{n=N+1}^{\infty} a_n \right| & \leq \sum_{n=N+1}^{\infty} |a_n|
\end{align}

\br

そこで、無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$を、$n=N$までの有限和と、$n=N+1$からの無限級数に分けて考える
\begin{equation}
  \sum_{n=0}^{\infty} \dfrac{x^n}{n!} = \sum_{n=0}^{N} \dfrac{x^n}{n!} + \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!}
\end{equation}
このように考えると、左辺の無限級数が、右辺の有限和に収束することがわかる

\br

\subparagraph{不等式$\dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}$の証明}\quad\\

一般に$A \leq 0$のとき、$n > 2A^2 + 1$ならば、
\begin{equation}
  A^n < n!
\end{equation}
という不等式が成り立つことを示す

\br

$A=2|x|$の場合$\left( 2|x| \right)^n < n!$が、$\dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}$となる

\br

$n$が偶数（$=2m$）の場合、$n > 2A^2$の$n$を$2m$に置き換えることで、$m > A^2$となり、
\begin{align}
  n! & = (2m)! = 2m \cdot (2m-1) \cdots 2 \cdot 1   \\
     & > m \cdot m \cdots m = m^m = m^{\frac{n}{2}} \\
     & > \left( A^2 \right)^{\frac{n}{2}} = A^n
\end{align}
が成り立つ

\br

$n$が奇数の場合、$n-1$は偶数なので、偶数の場合の結果から$(n-1)! > A^{n-1}$がいえる

さらに、$n > 2A^2 + 1 > A$なので、
\begin{align}
  n! & = n \cdot (n-1)!        \\
     & > n \cdot A^{n-1}       \\
     & > A \cdot A^{n-1} = A^n
\end{align}
となり、いずれの場合も$A^n < n!$が成り立つ$\qed$

\section{関数等式}

無限級数$\displaystyle f(x) = \sum_{n=0}^{\infty} \dfrac{x^n}{n!}$に$x+y$を代入し、$f(x+y)$を計算してみる
\begin{align}
  f(x+y) & = \sum_{n=0}^{\infty} \dfrac{(x+y)^n}{n!}                                                          \\
         & = \sum_{n=0}^{\infty} \dfrac{1}{n!} \left( \sum_{k=0}^{n} \dfrac{n!}{k!(n-k)!} x^k y^{n-k} \right) \\
         & = \sum_{n=0}^{\infty} \left( \sum_{k=0}^{n} \dfrac{1}{k!(n-k)!} x^k y^{n-k} \right)                \\
         & = \sum_{n=0}^{\infty} \left( \sum_{k=0}^{n} \dfrac{x^k}{k!} \dfrac{y^{n-k}}{(n-k)!} \right)
\end{align}

\sectionline

\subparagraph{2重和}

何かを算出したいとき、一旦小計を取ることがある

小計を取ってから、小計を足し合わせて総計を取るのが\keyword{2重和}

\br

小計として何を選ぶかには自由度がある

たとえば、1ヶ月の支出を計算するときに、
\begin{itemize}
  \item 食費や本代などの品目ごとの小計をを取り、それを足し合わせる
  \item 日々の支出を計算し、それを足し合わせる
\end{itemize}
どちらの方法を選んでも、まったく同じ総額が得られる

一般の2重和の計算においても、何を小計として選んでも総和は同じになる

\br

多重積分における累次積分の計算法は、2重和$\sum\sum$を一般化したものになっている

\sectionline

$f(x+y)$で現れる2重和は、そもそも全体として何を算出しようとしているのか？

\br

$a, b$という自然数（$0$を含む）を固定して、$x^ay^b$という項が$f(x+y)$の2重和の中にどのように出現しているのか探す
\begin{align}
  f(x+y) = \sum_{n=0}^{\infty} \left( \sum_{k=0}^{n} \dfrac{x^k}{k!} \dfrac{y^{n-k}}{(n-k)!} \right)
\end{align}

この式において、
\begin{itemize}
  \item $x^ky^{n-k}$が$x^ay^b$となるのは、$a=k, b=n-k$の場合
  \item $(k,n)$の組は$a,b$によって$k=a, n=a+b$とただ1つ定まる
  \item このとき$0 \leq k \leq n$を満たしている（$\displaystyle\sum_{k=0}^{n}$より）
\end{itemize}

まとめると、$(a,b)=(k,n-k)$すなわち$(k, n) = (a, a+b)$という等式の下で、組$(a,b)$と組$(k,n)$が1対1に対応している

\br

そのため、$x^ay^b$は、$f(x+y)$の2重和の中で、
\begin{equation}
  \dfrac{x^a}{a!} \cdot \dfrac{y^b}{b!} = \dfrac{x^k}{k!} \cdot \dfrac{y^{n-k}}{(n-k)!}
\end{equation}
という形で現れることがわかる

\br

また、
\begin{itemize}
  \item $a=0,1,2,\ldots$かつ$b=0,1,2,\ldots$
  \item $n=0,1,2,\ldots$かつ$0 \leq k \leq n$
\end{itemize}
という数の範囲の条件も、1対1に対応している

\br

このことから、$\displaystyle\sum_{n=0}^{\infty}\sum_{k=0}^{n}$を$\displaystyle\sum_{a=0}^{\infty}\sum_{b=0}^{\infty}$に書き換えることができて、
\begin{align}
  f(x+y) & = \sum_{n=0}^{\infty} \left( \sum_{k=0}^{n} \dfrac{x^k}{k!} \dfrac{y^{n-k}}{(n-k)!} \right) \\
         & = \sum_{a=0}^{\infty} \sum_{b=0}^{\infty} \dfrac{x^a}{a!} \dfrac{y^b}{b!}
\end{align}
が成り立つ

このように書き換えると、2重和の計算の順序は入れ替えてもよいことがわかる

\sectionline

ここでさらに、かけ算の分配法則（有限個の場合と同様に、和がきちんと収束すれば分配法則が成り立つ
）を使って書き直すと、
\begin{align}
  f(x+y) & = \sum_{a=0}^{\infty} \sum_{b=0}^{\infty} \dfrac{x^a}{a!} \dfrac{y^b}{b!}                           \\
         & = \left(\sum_{a=0}^{\infty} \dfrac{x^a}{a!}\right) \left(\sum_{b=0}^{\infty} \dfrac{y^b}{b!}\right)
\end{align}

$f(x)$の定義式$\displaystyle f(x) = \sum_{n=0}^{\infty} \dfrac{x^n}{n!}$より、
\begin{align}
  f(x+y) & = f(x)f(y)
\end{align}

$f(x+y)$を二項展開を使って2重和として書き表し、「小計の取り方を変えても、結局は同じ総和が計算できる」という2重和のトリックを使うと、$f(x)f(y)$という積になった

\sectionline

\paragraph{定理}

無限級数$\displaystyle f(x) = \sum_{n=0}^{\infty} \dfrac{x^n}{n!}$は次の関数等式を満たす
\begin{equation}
  f(x+y) = f(x)f(y)
\end{equation}

\section{指数関数の拡張}

先ほど示した関数等式は、\keyword{指数法則}ともいう

\sectionline

$f(x)$が無限級数として定義されていたことは一旦忘れて、
\begin{itemize}
  \item $x>0$のとき$f(x)>0$
  \item $f(x+y)=f(x)f(y)$
  \item $f(0)=1,\quad f(1) = e$
\end{itemize}
という性質だけを用いて何が言えるか見ていく

\sectionline

\paragraph{定理}

$m$を自然数とするとき、
\begin{equation}
  f(mx) = f(x)^m
\end{equation}
が成り立つ

\br

\subparagraph{$m=0$の場合}

$f(0)=1$より、$f(0x)=f(0)=1$

また、$f(x)^0=1$より、$f(x)^0=f(0x)$が成り立つ

\subparagraph{$m=1$の場合}

$f(x)=f(x)^1$が成り立つ

\br

\subparagraph{一般の場合の証明}

$m+1$の場合を考える

$y=mx$とおくと、$x+y=(m+1)x$となり、関数等式が使える

よって、$f(mx) = f(x)^m$が$m$で成り立つなら、
\begin{align}
  f((m+1)x) & = f(mx)f(x)   \\
            & = f(x)^m f(x) \\
            & = f(x)^{m+1}
\end{align}
となり、$m+1$でも成り立つ

これで、数学的帰納法によって、すべての自然数$m$に対して$f(mx)=f(x)^m$が成り立つことが示された$\qed$

\sectionline

\subparagraph{$x=1$の場合}

$n$が自然数のとき、
\begin{equation}
  f(n) = f(1)^n = e^n
\end{equation}

\subparagraph{$x$が正の有理数の場合}

$x$を正の有理数$x=\dfrac{n}{m}$とする

$m$は自然数なので、先ほど示した$f(x)^m = f(mx)$が成り立ち、
\begin{align}
  f(x)^m = f(mx) = f\left(m\cdot\dfrac{n}{m}\right) = f(n)
\end{align}
さらに$n$も自然数なので、$f(n) = e^n$となり、
\begin{equation}
  f(x)^m = e^n
\end{equation}
$f(x) > 0$に注意して、両辺の$m$乗根を取れば、
\begin{equation}
  f(x) = e^{\frac{n}{m}} = e^x
\end{equation}
となり、$x$が正の有理数のときも$f(x)=e^x$が成り立つ

\subparagraph{$x$が負の有理数の場合}

関数等式より、
\begin{align}
  f(-x)f(x) = f(-x+x) = f(0) = 1
\end{align}
なので、$f(-x)$は$f(x)$の逆数となる

したがって、$f(-x)=\dfrac{1}{f(x)}$であり、$f(x)=e^x$より、
\begin{align}
  f(-x) = \dfrac{1}{f(x)} = \dfrac{1}{e^x} = e^{-x}
\end{align}
$x$を$-x$に置き換えても、$f(x)=e^x$が成り立つことがわかる

\sectionline

以上の議論から、$x$が有理数のとき$f(x)=e^x$となることがわかった

\br

$x$が有理数以外のときに、$e^x$はどうやって定義すればよいだろうか？

\br

\subparagraph{有理数での近似による定義}

1つの考え方として、\keyword{どんな実数でも有理数を使っていくらでも近似できる}ということを用いる

たとえば、実数$x$を小数点以下$3$桁まで表示して得られる数$y$は、$y=\dfrac{\text{整数}}{1000}$と表せるので有理数であり、しかも$x$との誤差が$10^{-3}$未満になる

\br

$e^x$の値が変数$x$について連続的に動くと考えると、実数$x$を有理数$\dfrac{n}{m}$で近似すれば、$e^{\frac{n}{m}}$は$e^x$を近似できるだろう

そこで、近似をどんどん精密にしたときの極限として$e^x$の値を定義する

\br

\subparagraph{べき級数展開による定義}

$x$が有理数とは限らない場合に指数関数$e^x$を定義する別の方法として、次の\keyword{べき級数展開}を用いるという考え方もある
\begin{equation}
  e^x = \sum_{k=0}^{\infty} \dfrac{x^k}{k!}
\end{equation}
$x$が有理数でなくても、右辺の無限級数で定義した関数を$e^x$と表記しよう、という発想

\br

べき乗という1つの観点にこだわっていると、$x$が複素数の場合に$e$の$x$乗が何を意味するのかは、哲学的な問題となってしまう

無限級数であれば、$x$が複素数であっても意味を持つ

\br

$x$が複素数の場合も含めて、無限級数で指数関数$e^x$を定義しておくと、指数関数と三角関数も結びつき、さらに世界が拡がる

\end{document}
