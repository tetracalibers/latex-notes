\documentclass[../book_jiriki_calc]{subfiles}

\begin{document}

\section*{関数の局所的な様子を見る}

簡単な関数のグラフは拡大していくと急に様子が変わったりせず、むしろ、だんだん安定したものになると考えられる

局所的な部分を拡大すると安定した姿になるとき、その様子を数学的にとらえる概念が\keyword{微分}

\vskip\baselineskip

ものによっては、拡大するとどんどん見え方が変わるものもある

拡大を何度繰り返しても同じ複雑さを保つ数学的構造（フラクタル）も自然界には現れる

\vskip\baselineskip

拡大すれば何でも簡単になるわけではないが、微分では、拡大したとき安定していく「素直」なものを主な対象とする

つまり、\keyword{微分は局所を分析するのに強力な手法だが、万能ではない}

\section*{微分の定義}

\keyword{関数}は変化の法則性をとらえる数学的言語

数$x$に対して数$f(x)$が定まるとき、$f(x)$を変数$x$の関数という

\sectionline

座標$(x,f(x))$を$xy$平面でプロットした曲線を関数$f(x)$の\keyword{グラフ}という

これは、$x$座標の点$x$における高さが$f(x)$となる曲線

\sectionline

この曲線の局所的な様子を見るのに、変数$x$を$x+h$に動かしてみる

そうすると、関数の値は$f(x)$から$f(x+h)$に変わる

\vskip\baselineskip

「素直」な関数のグラフをどんどん拡大すると、拡大部分はだんだん直線のように見えるだろう、と考えられる

$h$が小さいとき、斜めの曲線がほぼ一定の傾きの直線に見えるというのは、関数の値の変化量$f(x+h)-f(x)$が$h$にほぼ正比例するということ

\vskip\baselineskip

式で表すと、$x$から$x+h$の区間のグラフを直線とみなしたときの勾配
\begin{equation}
  \dfrac{f(x+h)-f(x)}{h}
\end{equation}
は、$h$が$0$に近づくとある1つの数に近づく、すなわち、収束するはずである

\sectionline

\paragraph{定義}

$h$を$0$に近づけると、$\dfrac{f(x+h)-f(x)}{h}$がある数に収束するとき、$f(x)$は$x$において\keyword{微分可能}であるという

このとき、極限値を
\begin{equation}
  f'(x) = \lim_{h \to 0} \dfrac{f(x+h)-f(x)}{h}
\end{equation}
と書き、$f(x)$の\keyword{微分}または\keyword{微分係数（微係数）}という

\sectionline

\subparagraph{定数関数の微分}

「収束する」ことを「限りなく近づく」と言うこともある

日常的な言葉だと「限りなく近づく」には「その値に達していない」というニュアンスを感じるが、数学では、最初からずっと同じ値のときも「収束する」場合に含める

\vskip\baselineskip

$f(x)$が$x$の値によらないとき、$f(x)$を\keyword{定数関数}という

このときは$h$がどんな数でも$f(x+h)-f(x)=0$となるので、定数関数の微分は$0$である

\sectionline

\subparagraph{微分係数が定まらない例}

\begin{equation}
  \lim_{h\to 0}\dfrac{f(x+h)-f(x)}{h}
\end{equation}
が収束しない状況の例として、$y=\left|x\right|$を考える

$f(x)=|x|$の場合、$x=0$で
\begin{equation}
  \lim_{h\to 0}\dfrac{f(x+h)-f(x)}{h}
\end{equation}
を計算しようとすると、

$h>0$のときは
\begin{equation}
  \dfrac{f(h)-f(0)}{h} = \dfrac{h}{h} = 1
\end{equation}
$h<0$のときは
\begin{equation}
  \dfrac{f(h)-f(0)}{h} = \dfrac{-h}{h} = -1
\end{equation}
となり、$h$を正から$0$に近づけるときと、負から$0$に近づけるときとで、$\dfrac{f(h)-f(0)}{h}$の極限の値が異なってしまうので、微分係数$f'(0)$が定まらない

\sectionline

\paragraph{定理}

$a<x<b$で定義された、微分可能な関数$f(x)$が$x=c$で最大値または最小値をとるならば、$f'(c)=0$である

\sectionline

\subparagraph{$f'(c)$が最大値となる場合の証明}

\begin{equation}
  f'(c) = \lim_{h\to 0}\dfrac{f(c+h)-f(c)}{h}
\end{equation}
において、$f(c)$が最大値であることから、
\begin{align}
  f(c)        & \geq f(c+h) \\
  f(c+h)-f(c) & \leq 0
\end{align}
したがって、$h>0$のときは、
\begin{equation}
  \dfrac{f(c+h)-f(c)}{h} \leq 0
\end{equation}
となり、$h$を正の側から$0$に近づけた極限値として$f'(c) \leq 0$が成り立つ

一方、$h<0$のときは、
\begin{equation}
  \dfrac{f(c+h)-f(c)}{h} \geq 0
\end{equation}
となり、$h$を負の側から$0$に近づけた極限値として$f'(c) \geq 0$が成り立つ

$f'(c) \leq 0$かつ$f'(c) \geq 0$なので、$f'(c)=0$が導かれた$\qed$

\sectionline

\subparagraph{$f'(c)$が最小値となる場合の証明}

$f'(c)$が最大値となる場合と同様に示される$\qed$

\section*{導関数}

$x$を止めて考えると、$f(x)$の微分は1つの数
\begin{equation}
  \dfrac{df}{dx}(x) = \lim_{h\to 0}\dfrac{f(x+h)-f(x)}{h}
\end{equation}

\vskip\baselineskip

また別の視点として、
\begin{itemize}
  \item $x$に数を与えると、何か1個、数が出てくる
  \item また別の$x$に対しては、別の数が出る
\end{itemize}
そう思うと、$x$から$\dfrac{df}{dx}(x)$への対応は1つの関数を与えていると考えることができる

\vskip\baselineskip

このように、$\dfrac{df}{dx}(x)$を$x$の関数と見たとき、それを$f(x)$の\keyword{導関数}という

\sectionline

「微分」と「導関数」は視点の違いで使い分けられる言葉

\begin{itemize}
  \item $x$を止めて$\dfrac{df}{dx}(x)$という1個の数（微分係数）に注目するのか
  \item $x$を変数と思って$\dfrac{df}{dx}(x)$を関数とみなす（導関数として扱う）のか
\end{itemize}

後者の立場に立って、$\dfrac{df}{dx}(x)$を関数だと思うと、さらに微分を考えることができる

\sectionline

微分できないからといってそこで終わりではない

\vskip\baselineskip

たとえば、関数概念を拡張した\keyword{超関数}の理論は、極限
\begin{equation}
  \lim_{h\to 0}\dfrac{f(x+h)-f(x)}{h}
\end{equation}
が存在しない場合にも、より広く「微分」という概念をとらえる枠組みを与えるもの

\section*{単項式$x^n$の微分}

$f(x+h)=(x+h)^n$の二項展開
\begin{equation}
  f(x+h) = x^n + nx^{n-1}h + {}_n C_2 x^{n-2}h^2 + \cdots + h^n
\end{equation}
を用いると、
\begin{align}
  f(x+h)-f(x) & = (x+h)^n - x^n                                      \\
              & = x^n + nx^{n-1}h + {}_n C_2 x^{n-2}h^2              \\
              & \phantom{=====} + \cdots + h^n - x^n                 \\
              & = nx^{n-1}h + {}_n C_2 x^{n-2}h^2 + \cdots + h^{n-1}
\end{align}
上の式変形で、最初の$x^n$は最後の$-x^n$と相殺されている

両辺を$h$で割ると、
\begin{align}
  \dfrac{f(x+h)-f(x)}{h}
   & = \dfrac{nx^{n-1}h + {}_n C_2 x^{n-2}h^2 + \cdots + h^{n-1}}{h} \\
   & = nx^{n-1} + {}_n C_2 x^{n-2}h + \cdots + h^{n-1}
\end{align}

$h$が$0$に近づくと、
\begin{itemize}
  \item $h$に無関係な最初の項$nx^{n-1}$はそのまま残る
  \item 次の$h$の項は$0$に近づく
  \item その後の$h^2, h^3, \cdots, h^{n-1}$の項はさらに速く$0$に近づく
\end{itemize}

というわけで、$h$を$0$に近づけると$nx^{n-1}$に収束し、
\begin{equation}
  \dfrac{d}{dx}x^n = nx^{n-1}
\end{equation}
が成り立つ

\section*{微分しても変わらない不思議な関数}

この式をぼんやりと眺めていると、
\begin{equation}
  \dfrac{d}{dx}x^n = nx^{n-1}
\end{equation}

\begin{itemize}
  \item 左辺における$\dfrac{d}{dx}$という記号に呼応して、右辺では$n$が飛び出すというふうにも見える
  \item 左辺では$x$の$n$乗だったものが、右辺では$n-1$乗になっている
\end{itemize}

\sectionline

$x^n$を$n$の階乗で割った$\dfrac{x^n}{n!}$という関数を考える

\vskip\baselineskip

この関数を微分すると、$\dfrac{1}{n!}$は微分の外に出せる
\begin{equation}
  \dfrac{d}{dx}\left(\dfrac{x^n}{n!}\right) = \dfrac{1}{n!}\left(\dfrac{d}{dx}x^n\right) = \dfrac{nx^{n-1}}{n!} = \dfrac{x^{n-1}}{(n-1)!}
\end{equation}

この式では、左辺と右辺で似た形が現れている

文字は左辺の$n$から右辺の$n-1$に化けるが、形は同じ

\vskip\baselineskip

$n$に具体的な数を入れて確かめてみる
\begin{itemize}
  \item $n=0$のとき、$\dfrac{d}{dx}\left(\dfrac{x^0}{0!}\right) = 0$
  \item $n=1$のとき、$\dfrac{d}{dx}\left(\dfrac{x^1}{1!}\right) = \dfrac{x^0}{0!}$
  \item $n=2$のとき、$\dfrac{d}{dx}\left(\dfrac{x^2}{2!}\right) = \dfrac{x^1}{1!}$
  \item $n=3$のとき、$\dfrac{d}{dx}\left(\dfrac{x^3}{3!}\right) = \dfrac{x^2}{2!}$
  \item $n=4$のとき、$\dfrac{d}{dx}\left(\dfrac{x^4}{4!}\right) = \dfrac{x^3}{3!}$
  \item $n=5$のとき、$\dfrac{d}{dx}\left(\dfrac{x^5}{5!}\right) = \dfrac{x^4}{4!}$
\end{itemize}
微分すると斜め右下にまったく同じ形の式が現れるというパターンが続く

上のリストでは$n=5$で止めているが、たとえば$n=100$までいっても同じパターンが続く

\vskip\baselineskip

そこで、$\dfrac{x^n}{n!}$を$n=0$から順に全部足すことを考え、それを$f(x)$とおく
\begin{align}
  f(x)              & = \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \dfrac{x^3}{3!} + \cdots \\
  \dfrac{d}{dx}f(x) & = 0 + \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \cdots
\end{align}
下の式は1個右にずれているので、途中で打ち切れば1個足りなくなるが、無限に足すと、上の式と下の式はぴったり一致している

したがって、
\begin{equation}
  \dfrac{d}{dx}f(x) = f(x)
\end{equation}
が成り立つことがわかる

つまり、\keyword{関数$f(x)$は微分したものが自分自身になっている！}

\vskip\baselineskip

いま無限級数として定義した関数$f(x)$を何通りかの記法で表しておく
\begin{align}
  f(x) & = \sum_{n=0}^{\infty} \dfrac{x^n}{n!}                                            \\
       & = \dfrac{x^0}{0!} + \dfrac{x^1}{1!} + \dfrac{x^2}{2!} + \dfrac{x^3}{3!} + \cdots \\
       & = 1 + x + \dfrac{x^2}{2} + \dfrac{x^3}{6} + \cdots
\end{align}
後にこの関数は、\keyword{指数関数}として$e^x$と書くことになる

\section*{ネイピアの数}

次の関数に$x=0$と$x=1$を代入してみる
\begin{equation}
  f(x) = 1 + x + \dfrac{1}{2!}x^2 + \dfrac{1}{3!}x^3 + \cdots
\end{equation}

\sectionline

\subparagraph{$x=0$を代入すると}

最初の$1$だけが残り、
\begin{equation}
  f(0) = 1
\end{equation}

\sectionline

\subparagraph{$x=1$を代入すると}

$1$を何乗しても$1$であるから、
\begin{equation}
  f(1) = 1 + 1 + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots
\end{equation}

\vskip\baselineskip

この$f(1)$の数値はどのくらいになるだろうか？
\begin{enumerate}
  \item 第1項は$1$
  \item 第2項も$1$
  \item 第3項は$0.5$
  \item 次は前の項を$3$で割るわけだから$0.166\ldots$
  \item 次はさらに$4$で割るから$0.041\ldots$
  \item 次はさらにそれを$5$で割って$0.008\ldots$
\end{enumerate}
ここまでの$6$項の和で$2.716\ldots$となる

\vskip\baselineskip

加える項は急速に$0$に近づく

項が100個くらいまで進むと、次に加える$\dfrac{1}{100!}$は小数点以下に$0$が150個以上並ぶくらい小さな数になる（$10^{152}<100!<10^{164}$という不等式より）

\vskip\baselineskip

このように、無限級数$f(1)$は収束がとても速く、
\begin{equation}
  f(1) = 2.71828\ldots
\end{equation}
という数になる

\sectionline

\paragraph{定理}

\begin{equation}
  \lim_{n\to\infty}\left(1+\dfrac{1}{n}\right)^n = \sum_{k=0}^{\infty} \dfrac{1}{k!}
\end{equation}

\vskip\baselineskip

\subparagraph{証明のスケッチ}

二項展開を用いて、
\begin{align}
  \left(1+\dfrac{1}{n}\right)^n
   & = \sum_{k=0}^{n} \frac{n!}{k!(n-k)!} \cdot \frac{1}{n^k}
  %& = 1 + 1 + \dfrac{1}{2!}\left(1-\dfrac{1}{n}\right)                                             \\\\
  %& \phantom{=====} + \dfrac{1}{3!}\left(1-\dfrac{1}{n}\right)\left(1-\dfrac{2}{n}\right) + \cdots
\end{align}

ここで、$k=2$以降の各項は次のように展開する
\begin{align}
  \frac{n!}{2!(n-2)!} \cdot \frac{1}{n^2}
   & = \frac{n(n-1)}{2!} \cdot \frac{1}{n^2}       \\
   & = \dfrac{1}{2!} \cdot \dfrac{n-1}{n}          \\
   & = \frac{1}{2!} \left( 1 - \frac{1}{n} \right)
\end{align}

\begin{align}
  \frac{n!}{3!(n-3)!} \cdot \frac{1}{n^3}
   & = \frac{n(n-1)(n-2)}{3!} \cdot \frac{1}{n^3}                                 \\
   & = \dfrac{1}{3!} \cdot \dfrac{n-1}{n} \cdot \dfrac{n-2}{n}                    \\
   & = \frac{1}{3!} \left( 1 - \frac{1}{n} \right) \left( 1 - \frac{2}{n} \right)
\end{align}

これらを用いると、
\begin{multline}
  \left(1+\dfrac{1}{n}\right)^n = 1 + 1 + \dfrac{1}{2!}\left(1-\dfrac{1}{n}\right) \\
  + \dfrac{1}{3!}\left(1-\dfrac{1}{n}\right)\left(1-\dfrac{2}{n}\right) + \cdots
\end{multline}
$n$が大きくなると$\dfrac{1}{n}$は$0$に近づくので、$1-\dfrac{1}{n}$は$1$に近づき、
\begin{equation}
  \left(1+\dfrac{1}{n}\right)^n = 1 + 1 + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots
\end{equation}
となる$\qed$

\section*{無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$の収束}

$n$を大きくすると$n!$は急速に大きくなるので、$x=1$のときには無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}=\sum_{n=0}^{\infty} \dfrac{1}{n!}$が収束することは納得できる

\vskip\baselineskip

では、$x>1$のときもこの無限級数は収束するといえるのだろうか？

\sectionline

そもそも数列の各項が$0$に近づかないと、その数列の総和は収束しないため、まず次の問いを考える
（以下では$x$を固定しておく）

\vskip\baselineskip

\paragraph{問題}

$n$をどんどん大きくしたとき、$\dfrac{x^n}{n!}$は$0$に近づくか？

\vskip\baselineskip

この問いは、$x^n$と$n!$の大きさを比べようという問題である

たとえば$n=100$とすると、実は$100!$の方が$10^{100}$よりも圧倒的に大きくなることをすでに示している

\vskip\baselineskip

$n=100$に限らず、「$x$を止めたとき、$x^n$と$n!$の比である$\dfrac{x^n}{n!}$は、$n$を大きくすると分母が圧倒的に大きくなり、比は$0$に近づく」ことが同様の議論で示される

\sectionline

無限級数の各項が$0$に近づいたとしても、「塵も積もれば山となる」（足し合わせると発散する）ことも起こり得る

\vskip\baselineskip

では、次の問題はどうだろうか？

\vskip\baselineskip

\paragraph{問題}

無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$は収束するか？

\vskip\baselineskip

実はこの無限級数は、等比級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{1}{2^n}$よりももっと速く収束する

\vskip\baselineskip

\subparagraph{証明のスケッチ}\quad

$x$は固定して、$n$に関する和を考える

\vskip\baselineskip

整数$n$が十分に大きければ、
\begin{equation}
  \dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}
\end{equation}

これは、「無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$が等比級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{1}{2^n}$より速く収束する」という1つの表現

\vskip\baselineskip

正確には、$8x^2+1$より大きいすべての自然数$n$に対して、
\begin{equation}
  \dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}
\end{equation}
が成り立つ

このことがいえれば、$8x^2$より大きい整数$N$に対して、無限級数$\displaystyle\sum_{n=N+1}^{\infty} \dfrac{x^n}{n!}$は次のように等比級数$\displaystyle\sum_{n=N+1}^{\infty} \dfrac{1}{2^n}$より速く収束する
\begin{align}
  \left| \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!} \right|
   & \leq \sum_{n=N+1}^{\infty} \dfrac{\left| x \right|^n}{2^n} \\
   & < \sum_{n=N+1}^{\infty} \dfrac{1}{2^n}                     \\
   & = \dfrac{1}{2^{N}}
\end{align}

上の計算のうち、$\displaystyle\left| \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!} \right| \leq \sum_{n=N+1}^{\infty} \dfrac{\left| x \right|^n}{2^n}$では、次のような三角不等式を利用している
\begin{align}
  \left| a_1 + a_2 + \dots + a_m \right|   & \leq |a_1| + |a_2| + \dots + |a_m| \\
  \left| \sum_{n=N+1}^{\infty} a_n \right| & \leq \sum_{n=N+1}^{\infty} |a_n|
\end{align}

\vskip\baselineskip

そこで、無限級数$\displaystyle\sum_{n=0}^{\infty} \dfrac{x^n}{n!}$を、$n=N$までの有限和と、$n=N+1$からの無限級数に分けて考える
\begin{equation}
  \sum_{n=0}^{\infty} \dfrac{x^n}{n!} = \sum_{n=0}^{N} \dfrac{x^n}{n!} + \sum_{n=N+1}^{\infty} \dfrac{x^n}{n!}
\end{equation}
このように考えると、左辺の無限級数が、右辺の有限和に収束することがわかる

\vskip\baselineskip

\subparagraph{不等式$\dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}$の証明}\quad\\

一般に$A \leq 0$のとき、$n > 2A^2 + 1$ならば、
\begin{equation}
  A^n < n!
\end{equation}
という不等式が成り立つことを示す

\vskip\baselineskip

$A=2|x|$の場合$\left( 2|x| \right)^n < n!$が、$\dfrac{\left|x\right|^n}{n!} < \dfrac{1}{2^n}$となる

\vskip\baselineskip

$n$が偶数（$=2m$）の場合、$n > 2A^2$の$n$を$2m$に置き換えることで、$m > A^2$となり、
\begin{align}
  n! & = (2m)! = 2m \cdot (2m-1) \cdots 2 \cdot 1   \\
     & > m \cdot m \cdots m = m^m = m^{\frac{n}{2}} \\
     & > \left( A^2 \right)^{\frac{n}{2}} = A^n
\end{align}
が成り立つ

\vskip\baselineskip

$n$が奇数の場合、$n-1$は偶数なので、偶数の場合の結果から$(n-1)! > A^{n-1}$がいえる

さらに、$n > 2A^2 + 1 > A$なので、
\begin{align}
  n! & = n \cdot (n-1)!        \\
     & > n \cdot A^{n-1}       \\
     & > A \cdot A^{n-1} = A^n
\end{align}
となり、いずれの場合も$A^n < n!$が成り立つ$\qed$

\end{document}
