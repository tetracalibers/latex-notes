\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{階数と単射性・全射性}
\marginnote{\refbookA p67〜68}

線型写像の単射性・全射性は、その表現行列の階数によって判定することもできる。

また、その判定条件は、連立一次方程式の解の性質とも結びつく。

\subsection{単射な線形写像と階数}

$A$の階数が元の空間（定義域）の次元と同じ場合、$A$が表す線形写像は\keyword{単射}となる。
\begin{equation*}
  \rank A = n
\end{equation*}

元の$n$次元空間が写した先でも$n$次元の広がりを保っているのなら、潰れていないはずだからである。

\begin{theorem}{線形写像の単射性と表現行列}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の表現行列を$A$とするとき、次はすべて同値である。
  \begin{enumerate}[label=\romanlabel]
    \item $f$は単射
    \item $A\vb*{x} = \vb*{o}$は自明な解しか持たない
    \item $\rank A = n$
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{subpattern}{(\romannum{i}) $\Longleftrightarrow$ (\romannum{ii})}
    線形写像$f$は、表現行列$A$を用いて次のように表せる
    \begin{equation*}
      f(\vb*{x}) = A\vb*{x}
    \end{equation*}

    $f$が単射であることの言い換えは、
    \begin{equation*}
      f(\vb*{x}) = \vb*{o} \Longrightarrow \vb*{x} = \vb*{o}
    \end{equation*}
    であり、$A\vb*{x} = \vb*{o}$が自明解しか持たないことは、
    \begin{equation*}
      A\vb*{x} = \vb*{o} \Longrightarrow \vb*{x} = \vb*{o}
    \end{equation*}
    が成り立つということである

    $f(\vb*{x}) = A\vb*{x}$であるから、これらの2つの条件は同値である $\qed$
  \end{subpattern}

  \begin{subpattern}{(\romannum{ii}) $\Longleftrightarrow$ (\romannum{iii})}
    \hyperref[thm:homogeneous-trivial-iff-full-col-rank]{斉次形の非自明解の存在条件}より、斉次形の方程式$A\vb*{x} = \vb*{o}$に自明解しか存在しないことと
    \begin{equation*}
      \rank A = n
    \end{equation*}
    と同値である。 $\qed$
  \end{subpattern}
\end{proof}

\subsection{全射な線形写像と階数}

$A$の階数が行き先の空間（値域）の次元と同じ場合、$A$が表す線形写像は\keyword{全射}となる。
\begin{equation*}
  \rank A = m
\end{equation*}

写した先でその空間全体と同じ$m$次元の広がりを持っているのなら、空間全体をカバーしているはずだからである。

\begin{theorem}{線形写像の全射性と表現行列}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の表現行列を$A$とするとき、次はすべて同値である。
  \begin{enumerate}[label=\romanlabel]
    \item $f$は全射
    \item 任意の$\vb*{b} \in \mathbb{R}^m$に対して、$A\vb*{x} = \vb*{b}$には解が存在する
    \item $\rank A = m$
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{subpattern}{(\romannum{i}) $\Longleftrightarrow$ (\romannum{ii})}
    線形写像$f$は、表現行列$A$を用いて次のように表せる
    \begin{equation*}
      f(\vb*{x}) = A\vb*{x}
    \end{equation*}

    $f$が全射であることの言い換えは、
    \begin{equation*}
      \forall \vb*{b} \in \mathbb{R}^m, \exists \vb*{x} \in \mathbb{R}^n, f(\vb*{x}) = \vb*{b}
    \end{equation*}
    であり、これは
    \begin{equation*}
      \forall \vb*{b} \in \mathbb{R}^m, A\vb*{x} = \vb*{b} \text{に解が存在する}
    \end{equation*}
    と同値である

    よって、これらの2つの条件は同値である $\qed$

  \end{subpattern}

  \begin{subpattern}{(\romannum{ii}) $\Longleftrightarrow$ (\romannum{iii})}
    \hyperref[thm:full-row-rank-solvable]{連立方程式の解の存在条件}より、$\rank A = m$は、次の条件
    \begin{equation*}
      ^{\forall}\vb*{b} \in \mathbb{R}^m, A\vb*{x} = \vb*{b} \text{の解が存在する}
    \end{equation*}
    ことと同値である。 $\qed$
  \end{subpattern}
\end{proof}

\subsection{全単射な線形変換と階数}
\marginnote{\refbookA p70}

一般の線形写像と対比して、線形変換の大きな特徴は次が成り立つことである。

単射と全射は、一般には一方から他方が導かれるわけではない2つの性質だが、$\mathbb{R}^n$からそれ自身への線形写像（線形変換）の場合は同値になる。

\begin{theorem}{線形代数における鳩の巣原理}\label{thm:linear-pigeonhole}
  $f$を$\mathbb{R}^n$の線形変換とし、$A$を$f$の表現行列とするとき、次はすべて同値である。
  \begin{enumerate}[label=\romanlabel]
    \item $f$は単射
    \item $f$は全射
    \item $f$は全単射
    \item $\rank A = n$
  \end{enumerate}
\end{theorem}

\begin{proof}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$において、表現行列を$A$とすると、
  \begin{align*}
    f\text{が単射} & \Longleftrightarrow \rank A = n \\
    f\text{が全射} & \Longleftrightarrow \rank A = m
  \end{align*}
  である。

  \br

  線形変換は、線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の$m=n$の場合であるので、$f$が単射であることも、全射であることも、
  \begin{equation*}
    \rank A = n
  \end{equation*}
  という条件と同値になる。

  \br

  つまり、線形変換は単射かつ全射であり、これは全単射であることも意味する。 $\qed$
\end{proof}

\br

この定理は、いわば線形代数版「鳩の巣原理」である。

\begin{theorem}{鳩の巣原理}
  有限集合$X = \{ 1, 2, \dots, n \}$からそれ自身への写像$f$に対して、単射と全射は同値である
\end{theorem}

\br

鳩の巣原理は、歴史的には\keyword{部屋割り論法}とも呼ばれ、
\begin{emphabox}
  \begin{spacebox}
    \begin{center}
      $n$個のものを$m$個の箱に入れるとき、$n > m$であれば、\\
      少なくとも1個の箱には1個より多いものが中にある
    \end{center}
  \end{spacebox}
\end{emphabox}
ことを指す。

\br

ここで鳩の巣原理と呼んだのはこの命題そのものではないが、その変種と考えてよい。

\end{document}
