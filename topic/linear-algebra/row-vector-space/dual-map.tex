\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{双対写像}
\marginnote{\refbookR p237〜238 \\ \refbookG p61〜62 \\ \refbookA p122〜123}

線形空間の間の線形写像が与えられると、双対空間の間の線形写像を定めることができる。

\br

線形空間$V,W$の間の線形写像$f \colon V \to W$が与えられたとする。

$W$上の線形汎関数を$\varphi \in W^*$とすると、次のような関係になっている。
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \normalsize}]
    V \arrow[r,"f"] & W \arrow[d,"\varphi"]\\
    & \mathbb{R}
  \end{tikzcd}
\end{equation*}

このとき、合成写像$\varphi \circ f \colon V \to \mathbb{R}$を考えることができる。
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \normalsize}]
    V \arrow[r,"f"]\arrow[rd, "\varphi \circ f"'] & W \arrow[d,"\varphi"]\\
    & \mathbb{R}
  \end{tikzcd}
\end{equation*}

\hyperref[thm:linear-map-composition]{線形写像の合成もまた線形写像になる}ので、$\varphi \circ f$は$V$上の線形汎関数である。
これを$f^*(\varphi) \in V^*$と書くことにする。
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \normalsize}]
    V \arrow[r,"f"]\arrow[rd, "f^*(\varphi)"'] & W \arrow[d,"\varphi"]\\
    & \mathbb{R}
  \end{tikzcd}
\end{equation*}

$f^*(\varphi)$は$V$上の線形汎関数なので、$\vb*{v} \in V$を入力するとスカラーを返す。

合成写像の記法より、$(\varphi \circ f)(\vb*{v})$は、$\varphi(f(\vb*{v}))$とも書けるので、
\begin{equation*}
  f^*(\varphi)(\vb*{v}) = \varphi(f(\vb*{v})) = \langle \varphi, f(\vb*{v}) \rangle
\end{equation*}
と整理できる。

\br

また、$f^*$は$W^*$上の線形汎関数$\varphi$を入力として、$V^*$上の線形汎関数$f^*(\varphi)$を返す線形写像である。
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \normalsize}]
    V \arrow[r,"f"]\arrow[rd, "f^*(\varphi)"'{name=v}] & W \arrow[d,"\varphi"{name=w}] \arrow[from=w,to=v,out=-60, in=-70,looseness=2,"f^*"]\\
    & \mathbb{R}
  \end{tikzcd}
\end{equation*}

\br

\begin{handout}[補足：なぜ$f^*$は線形写像といえるのか]
  $W^* = \Hom(W, \mathbb{R})$における\hyperref[def:linear-map-addition-scalar]{和とスカラー倍の定義}から示すことができる。
  
  \br
  
  $\varphi_1, \varphi_2 \in W^*$に対して、
  \begin{align*}
    f^*(\varphi_1 + \varphi_2)(\vb*{v}) & = (\varphi_1 + \varphi_2)(f(\vb*{v})) \\
                                & = \varphi_1(f(\vb*{v})) + \varphi_2(f(\vb*{v})) \\
                                & = f^*(\varphi_1)(\vb*{v}) + f^*(\varphi_2)(\vb*{v}) \\
                                & = (f^*(\varphi_1) + f^*(\varphi_2))(\vb*{v})
  \end{align*}
  また、$c \in \mathbb{R}$に対して、
  \begin{align*}
    f^*(c\varphi)(\vb*{v}) & = (c\varphi)(f(\vb*{v})) \\
                            & = c\cdot\varphi(f(\vb*{v})) \\
                            & = c\cdot f^*(\varphi)(\vb*{v}) \\
                            & = (c f^*(\varphi))(\vb*{v})
  \end{align*}
  
  以上より、
  \begin{align*}
    f^*(\varphi_1 + \varphi_2) & = f^*(\varphi_1) + f^*(\varphi_2) \\
    c f^*(\varphi)             & = f^*(c\varphi)
  \end{align*}
  となり、写像$f^*$は線形性を満たすことがわかる。$\qed$
\end{handout}

このように定まる線形写像$f^* \colon W^* \to V^*$を、$f$の\keyword{双対写像}という。
\begin{equation*}
  \begin{array}{cccc}
    f^*\colon & W^*         & \longrightarrow & V^*          \\
            & \rotatebox{90}{$\in$} &                 & \rotatebox{90}{$\in$} \\
            & \varphi               & \longmapsto     & f^*(\varphi)
  \end{array}
\end{equation*}

\begin{definition}{双対写像}
  $V,W$を線形空間とし、$f \colon V \to W$を線形写像とするとき、$f$の\keyword{双対写像}$f^* \colon W^* \to V^*$を次のように定義する。
  \begin{equation*}
    f^*(\varphi) \coloneq \varphi \circ f \quad (\varphi \in W^*)
  \end{equation*}
\end{definition}

双対を表すペアリングの記法を用いると、次のように整理できる。
\begin{equation*}
  f^*(\varphi)(\vb*{v}) = \langle f^*(\varphi), \vb*{v} \rangle = \langle \varphi, f(\vb*{v}) \rangle = \varphi(f(\vb*{v})) \quad (\vb*{v} \in V)
\end{equation*}

\end{document}
