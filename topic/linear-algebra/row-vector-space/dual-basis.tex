\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{双対基底}
\marginnote{\refbookA p120〜121 \\ \refbookG p58〜59 \\ \refbookR p234〜235}

線形空間が有限次元の場合は、選んでおいた基底に対して、\keywordJE{双対基底}{dual basis}という双対空間の基底を考えることができる。

\br

$V$を$n$次元の線形空間とし、$\vb*{v}_1,\ldots,\vb*{v}_n$を$V$の1つの基底とする。

このとき、$V$の任意のベクトル$\vb*{v}$は、基底の線形結合
\begin{equation*}
  \vb*{v} = c_1 \vb*{v}_1 + \cdots + c_n \vb*{v}_n
\end{equation*}
として表すことができる。

各係数$c_i$は、$\vb*{v}$の基底$\vb*{v}_1,\ldots,\vb*{v}_n$に関する第$i$成分（第$i$座標）である。

\br

$V$の任意のベクトルを引数にとり、基底$\vb*{v}_1,\ldots,\vb*{v}_n$に関する第$i$座標$c_i$を返す関数を$\phi_i \colon V \to \mathbb{R}$とおこう。

$\phi_i \in V^*$は線形なので、
\begin{equation*}
  \phi_i(\vb*{v}) = \phi\left(\sum_{j=1}^{n} c_j \vb*{v}_j\right) = \sum_{j=1}^{n} c_j \phi_i(\vb*{v}_j)
\end{equation*}

ここで、$\phi_i(\vb*{v})= c_i$となるためには、
\begin{equation*}
  \phi_i(\vb*{v}_j) = \delta_{ij} \quad (i,j=1,\ldots,n)
\end{equation*}
である必要がある。

\br

このように定めた$\phi_i$は、$V$の双対空間$V^*$の基底となっている。

\begin{theorem}{双対基底の構成と双対空間の次元}
  $V$を$n$次元の線形空間とし、$\vb*{v}_1,\ldots,\vb*{v}_n$を$V$の基底とする。
  
  $i = 1,\dots, n$に対して、$\phi_i \in V^*$を
  \begin{equation*}
    \phi_i(\vb*{v}_j) = \delta_{ij} \quad (j=1,\ldots,n)
  \end{equation*}
  により定めると、$\phi_1,\ldots,\phi_n$は$V^*$の基底をなす。
  
  特に、次が成り立つ。
  \begin{equation*}
    \dim V = \dim V^* = n
  \end{equation*}
\end{theorem}

\begin{proof}
  \begin{subpattern}{\bfseries $\phi_1,\ldots,\phi_n$が線型独立}
    線形関係式
    \begin{equation*}
      \sum_{j=1}^{n} c_j \phi_j = 0
    \end{equation*}
    があるとすると、
    \begin{equation*}
      \begin{WithArrows}
        \left( \displaystyle\sum_{j=1}^{n} c_j \phi_j \right)(\vb*{v}_i) & = 0 \Arrow{$\phi$の線形性} \\
        \displaystyle\sum_{j=1}^{n} c_j \phi_j(\vb*{v}_i) & = 0 \Arrow{$\phi_j(\vb*{v}_i) = \delta_{ij}$} \\
        \displaystyle\sum_{j=1}^{n} c_j \delta_{ij} & = 0
      \end{WithArrows}
    \end{equation*}
    左辺の和は、$\delta_{ij}$の定義より、$j=i$の項のみ生き残って、
    \begin{equation*}
      c_i = 0 \quad (i=1,\ldots,n)
    \end{equation*}
    が得られる。 $\qed$
  \end{subpattern}

  \begin{subpattern}{$\langle \phi_1, \ldots, \phi_n \rangle = V^*$}
    任意の$\vb*{v} \in V$に対して、
    \begin{equation*}
      \vb*{v} =\sum_{i=1}^{n} c_i \vb*{v}_i
    \end{equation*}
    と書く。

    \br

    $\psi \in V^*$を任意にとると、$\psi$と$\phi$の線形性により、
    \begin{align*}
      \psi(\vb*{v}) & = \psi\left(\sum_{i=1}^{n} c_i \vb*{v}_i\right)              \\
                    & = \sum_{i=1}^{n} c_i \psi(\vb*{v}_i)                         \\
                    & = \sum_{i=1}^{n} \phi_i(\vb*{v}) \psi(\vb*{v}_i)             \\
                    & = \sum_{i=1}^{n} \psi(\vb*{v}_i) \phi_i(\vb*{v})             \\
                    & = \left( \sum_{i=1}^n \psi(\vb*{v}_i)\phi_i\right) (\vb*{v})
    \end{align*}

    よって、
    \begin{equation*}
      \psi = \sum_{i=1}^{n} \psi(\vb*{v}_i) \phi_i
    \end{equation*}

    上式で、任意の$\psi \in V^*$を$\phi_1,\ldots,\phi_n$の線形結合で書けることが示せたので、$\langle \phi_1, \ldots, \phi_n \rangle$は$V^*$を張ることがわかる。 $\qed$
  \end{subpattern}
\end{proof}

\br

このようにして得られる$V^*$の基底$\{ \phi_1,\ldots,\phi_n \}$を、$V$の基底$\{ \vb*{v}_1,\ldots,\vb*{v}_n \}$の\keyword{双対基底}という。

\subsection{例：数ベクトル空間と双対基底}

$V = \mathbb{R}^n$の場合を考えてみよう。

\br

任意の縦ベクトルは、標準基底の線形結合として書くことができる。
\begin{equation*}
  \begin{pmatrix}
    c_1 \\
    \vdots \\
    c_n
  \end{pmatrix} = c_1 \vb*{e}_1 + \cdots + c_n \vb*{e}_n \in \mathbb{R}^n
\end{equation*}

また、任意の横ベクトルは、標準基底を転置したものの線形結合として書くことができる。
\begin{equation*}
  \begin{pmatrix}
    c_1 & \cdots & c_n
  \end{pmatrix} = c_1 {}^t\vb*{e}_1 + \cdots + c_n {}^t\vb*{e}_n \in {}^t\mathbb{R}^n
\end{equation*}

つまり、縦ベクトル空間の基底$\{ \vb*{e}_1, \ldots, \vb*{e}_n \}$に対して、横ベクトル空間の基底は$\{ {}^t\vb*{e}_1, \ldots, {}^t\vb*{e}_n \}$となる。

\br

また、${}^t\vb*{e}_i$を縦ベクトル$\vb*{v}$にかけることで、$\vb*{v}$の$i$番目の成分が得られるのだった。
\begin{equation*}
  {}^t\vb*{e}_i \vb*{v} = \begin{pmatrix}
    0 & \cdots & 1 & \cdots & 0
  \end{pmatrix} \begin{pmatrix}
    v_1 \\
    \vdots \\
    v_n
  \end{pmatrix} = v_i
\end{equation*}

つまり、${}^t\vb*{e}_i$は座標関数$\phi_i \colon \mathbb{R}^n \to \mathbb{R}$の表現行列になっている。

$\phi_i$を表す${}^t\vb*{e}_i$が、$\mathbb{R}^n$の双対空間${}^t\mathbb{R}^n$の基底をなしていることになる。

\br

$\phi_i(\vb*{e}_j)$についても考えておこう。

$\vb*{e}_j$は$j$番目の成分が1で他は0の縦ベクトルであり、${}^t\vb*{e}_i$は$i$番目の成分が1で他は0の横ベクトルである。

\begin{equation*}
  \phi_i(\vb*{e}_j) = {}^t\vb*{e}_i \vb*{e}_j = \begin{pmatrix}
    0 & \cdots & 1 & \cdots & 0
  \end{pmatrix} \begin{pmatrix}
    0 \\
    \vdots \\
    1 \\
    \vdots \\
    0
  \end{pmatrix}
\end{equation*}

この結果が1（$\vb*{e}_j$の$j$番目の成分）となるのは、$i=j$の場合のみである。

$i$と$j$がずれていれば、$0 \cdot 0$か$1 \cdot 0$しか現れないので、それらの和は0になってしまう。

\br

よって、$\mathbb{R}^n$の基底$\{ \vb*{e}_1, \ldots, \vb*{e}_n \}$とその双対基底$\{ \phi_1, \ldots, \phi_n \}$は、
\begin{equation*}
  \phi_i(\vb*{e}_j) = \delta_{ij} \quad (i,j=1,\ldots,n)
\end{equation*}
という関係にあることがわかる。

\end{document}
