\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{グラム・シュミットの直交化法}
\marginnote{\refbookC p119〜120 \\ \refbookF p182〜184 \\ \refbookA p82〜83 \\ \refbookO p34〜35、p53〜54}

\keyword{正規化}と\keyword{直交化}を連鎖させることで正規直交系をつくろうとするのが、\keyword{グラム・シュミットの直交化法}である。

\br

具体的には、次の手順を繰り返すことで、計量空間$V$の線型独立なベクトル$\vb*{a}_1, \ldots, \vb*{a}_n$から正規直交系$\vb*{e}_1, \ldots, \vb*{e}_n$をつくることができる。

\begin{enumerate}
  \item ノルムが1のベクトルをつくる
  \item ノルムが1のベクトルとの内積で、正射影をつくる
  \item 元のベクトルから正射影を引くことで、直交ベクトルをつくる
\end{enumerate}

\subsection{正規化}

まずは、$\vb*{a}_1$から、ノルムが1であるベクトルをつくる。

ベクトルのノルムを1にすることを\keyword{正規化}という。

\br

$\vb*{a}_1$を正規化したベクトルは、次のように求められる。
\begin{equation*}
  \vb*{e}_1 = \frac{\vb*{a}_1}{\|\vb*{a}_1\|}
\end{equation*}

ここで、$\vb*{e}_1$は$\vb*{a}_1$をスカラー$\dfrac{1}{\|\vb*{a}_1\|}$倍しただけなので、$\vb*{e}_1$と$\vb*{a}_1$は平行である。

\subsection{正射影による直交化}

次に、$\vb*{e}_1$と直交するような$\vb*{u}_2$をつくる。

そのために、$\vb*{a}_2$から$\vb*{a}_2$の$\vb*{e}_1$への正射影を引いたものは、$\vb*{e}_1$と直交することを利用する。

\br

$\vb*{a}_2$の$\vb*{e}_1$への正射影は、次のように計算できる。
\begin{equation*}
  (\vb*{a}_2, \vb*{e}_1) \vb*{e}_1
\end{equation*}

そこで、
\begin{equation*}
  \vb*{u}_2 = \vb*{a}_2 - (\vb*{a}_2, \vb*{e}_1) \vb*{e}_1
\end{equation*}
とおくと、$\vb*{u}_2$は$\vb*{e}_1$と直交する。

\subsection{再び正規化}

ここで、もし$\vb*{u}_2 = \vb*{o}$ならば、$\vb*{a}_2$は$\vb*{a}_1$の線形結合で表されることになり、$\vb*{a}_1, \vb*{a}_2$は線型従属になってしまう。
\begin{equation*}
  \vb*{a}_2 = (\vb*{a}_2, \vb*{e}_1) \vb*{e}_1 = (\vb*{a}_2, \vb*{e}_1) \frac{1}{\|\vb*{a}_1\|} \vb*{a}_1
\end{equation*}

ここでは、$\vb*{a}_1, \vb*{a}_2$は線型独立なベクトルと仮定しているので、$\vb*{u}_2 \neq \vb*{o}$である。

\br

よって、$\vb*{u}_2$を次のように正規化することができる。
\begin{equation*}
  \vb*{e}_2 = \frac{\vb*{u}_2}{\|\vb*{u}_2\|}
\end{equation*}
$\vb*{u}_2$は$\vb*{e}_1$と直交するベクトルであるので、$\vb*{e}_2$も$\vb*{e}_1$と直交する。

さらに、$\vb*{e}_2$はノルムが1のベクトルになっている。

\br

そこで、前工程「正射影への直交化」に戻って、今度は$\vb*{e}_2$と直交するようなベクトル$\vb*{u}_3$をつくることができる。

\subsection{正規化と直交化の連鎖}

以上の手順を繰り返すことで、線型独立なベクトル$\vb*{a}_1, \ldots, \vb*{a}_n$から、正規直交系$\vb*{e}_1, \ldots, \vb*{e}_n$を得ることができる。

\br

このような方法を\keyword{グラム・シュミットの直交化法}という。

\begin{theorem*}{グラム・シュミットの直交化法}
  計量空間$V$の線型独立なベクトル$\vb*{a}_1, \ldots, \vb*{a}_n$から、正規直交系$\vb*{e}_1, \ldots, \vb*{e}_n$を次のように構成できる。
  \begin{gather*}
    \vb*{u}_k = \vb*{a}_k - \sum_{j=1}^{k-1} (\vb*{a}_k, \vb*{e}_j) \vb*{e}_j \\
    \vb*{e}_k = \frac{\vb*{u}_k}{\|\vb*{u}_k\|}
  \end{gather*}
  ここで、$k = 1, 2, \ldots, n$である。
\end{theorem*}

\sectionline
\section{正規直交基底の構成}

次の定理により、\keyword{グラム・シュミットの直交化法}は、線型独立なベクトルから正規直交系を得るだけでなく、任意の基底から正規直交基底を得る手法としても利用できる。

\begin{theorem}{グラム・シュミットの直交化と生成空間の不変性}{gram-schmidt-span-invariance}
  計量空間$V$の線型独立なベクトル$\vb*{a}_1, \ldots, \vb*{a}_n$から、グラム・シュミットの直交化法を用いて得られた正規直交系を$\vb*{e}_1, \ldots, \vb*{e}_n$とする。
  
  このとき、$\vb*{a}_1,\ldots,\vb*{a}_n$が張る空間と$\vb*{e}_1,\ldots,\vb*{e}_n$が張る空間は一致する。
  \begin{equation*}
    \langle \vb*{a}_1, \ldots, \vb*{a}_n \rangle = \langle \vb*{e}_1, \ldots, \vb*{e}_n \rangle
  \end{equation*}
\end{theorem}

\begin{proof}
  グラム・シュミットの直交化法では、各ステップ$k$において、まず$\vb*{a}_k$からその前に得られた直交ベクトル$\vb*{e}_1, \ldots, \vb*{e}_{k-1}$への射影を引くことで、$\vb*{a}_k$に直交するベクトルを構成する。

  すなわち、
  \begin{equation*}
    \vb*{u}_k = \vb*{a}_k - \sum_{j=1}^{k-1} (\vb*{a}_k, \vb*{e}_j) \vb*{e}_j
  \end{equation*}
  と定義し、その後これを正規化して$\vb*{e}_k$とする。

  \br

  ここで、$\vb*{u}_k$は右辺の形から明らかなように、$\vb*{a}_k$と$\vb*{e}_1, \ldots, \vb*{e}_{k-1}$の線型結合である。

  そしてさらに各$\vb*{e}_j$（$j < k$）は、それ以前の$\vb*{a}_1, \ldots, \vb*{a}_j$の線型結合であることから、$\vb*{u}_k$は結局$\vb*{a}_1, \ldots, \vb*{a}_k$の線型結合として書ける。

  したがって、$\vb*{e}_k$も$\vb*{a}_1, \ldots, \vb*{a}_k$の線型結合となり、$\vb*{e}_1, \ldots, \vb*{e}_n$はすべて$\vb*{a}_1, \ldots, \vb*{a}_n$の線型結合である。

  \br

  よって、すべての$\vb*{e}_k$は$\langle \vb*{a}_1, \ldots, \vb*{a}_n \rangle$に属することになり、
  \begin{equation*}
    \langle \vb*{e}_1, \ldots, \vb*{e}_n \rangle \subset \langle \vb*{a}_1, \ldots, \vb*{a}_n \rangle
  \end{equation*}
  が成り立つ。

  \br

  両辺の部分空間の次元を考えると、$\vb*{a}_1, \ldots, \vb*{a}_n$が線型独立であるため、$\langle \vb*{a}_1, \ldots, \vb*{a}_n \rangle$の次元は$n$である。

  一方、$\vb*{e}_1, \ldots, \vb*{e}_n$も\hyperref[thm:orthogonal-set-is-independent]{直交系であることから線型独立}であるため、$\langle \vb*{e}_1, \ldots, \vb*{e}_n \rangle$の次元も$n$である。

  よって、\hyperref[thm:equal-dim-implies-equal-subspace]{部分空間の次元が等しいことから、両者は一致}する。 $\qed$
\end{proof}

\subsection{正規直交基底の存在}

このように、グラム・シュミットの直交化法によって、任意の基底から正規直交基底をつくることができる。

つまり、グラム・シュミットの直交化法は、内積が定められている空間（計量空間）には正規直交基底が必ず存在することを示している。

\begin{theorem*}{正規直交基底の存在}
  $\{\vb*{o}\}$でない任意の計量空間は正規直交基底を持つ。
\end{theorem*}

\sectionline
\section{線形従属なベクトルの正規直交化}\label{sec:gram-schmidt-with-dependent-vectors}

与えられたベクトルが線型独立でない場合にグラム・シュミットの直交化法を適用すると、いずれ射影を引いたベクトルが$\vb*{o}$になる。

\br

ある$\vb*{a}_k$が、前のベクトルたち$\vb*{a}_1,\ldots,\vb*{a}_{k-1}$の線形結合として表される、すなわち線形従属であるとする。

ここで、$\vb*{a}_1, \ldots, \vb*{a}_{k-1}$から得られた正規直交系を$\vb*{e}_1, \ldots, \vb*{e}_{k-1}$とすると、\hyperref[thm:gram-schmidt-span-invariance]{これらの張る空間は一致}する。
\begin{equation*}
  \langle \vb*{a}_1, \ldots, \vb*{a}_{k-1} \rangle = \langle \vb*{e}_1, \ldots, \vb*{e}_{k-1} \rangle
\end{equation*}

よって、$\vb*{a}_k$は、すでに得られた正規直交系$\vb*{e}_1,\ldots,\vb*{e}_{k-1}$の線形結合として表すこともできる。
\begin{equation*}
  \vb*{a}_k = \sum_{i = 1}^{k-1}(\vb*{a}_k, \vb*{e}_i) \vb*{e}_i
\end{equation*}

そのため、射影をすべて引くと、次のように残りが$\vb*{o}$になってしまう。
\begin{equation*}
  \vb*{u}_k = \vb*{a}_k - \sum_{i=1}^{k-1}(\vb*{a}_k, \vb*{e}_i) \vb*{e}_i = \vb*{o}
\end{equation*}

\br

このように、グラム・シュミットの直交化法における射影を引く操作は、すでにある正規直交基底に重なっている成分（従属部分）を消し去ってしまう。

この性質により、グラム・シュミットの直交化法は線形従属な場合でも破綻せずに使える。

\br

しかし、結果として新しい成分がゼロになる（つまり新しい情報がない）ため、得られる直交系は完全な基底にはならない。

\end{document}
