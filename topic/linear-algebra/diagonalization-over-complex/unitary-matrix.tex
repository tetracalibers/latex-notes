\documentclass[../../../topic_linear-algebra]{subfiles}

\usepackage{xr-hyper}
\externaldocument{../../../.tex_intermediates/topic_linear-algebra}

\begin{document}

\sectionline
\section{ユニタリ行列と直交行列}
\marginnote{\refbookF p275〜276、p279〜282 \\ \refbookA p204}

\begin{definition}{ユニタリ行列}\label{def:unitary-matrix}
  複素正方行列$A$が次を満たすとき、$A$を\keyword{ユニタリ行列}という
  \begin{equation*}
    A^* = A^{-1}
  \end{equation*}
\end{definition}

\subsection{ユニタリ行列と内積}

2つのベクトルそれぞれにユニタリ行列を左からかけても、それらの内積は変わらない

\begin{theorem}{ユニタリ行列の特徴づけとしての内積不変性}{unitary-characterized-by-inner-product-invariance}
  $n$次複素行列$A$がユニタリ行列であることと、任意の$\vb*{u},\,\vb*{v} \in \mathbb{C}^n$に対し、
  \begin{equation*}
    (A\vb*{u}, A\vb*{v}) = (\vb*{u}, \vb*{v})
  \end{equation*}
  が成り立つことは同値である
\end{theorem}

\begin{proof}
  \begin{subpattern}{\bfseries ユニタリ行列ならば内積を保つ}
    随伴公式より、
    \begin{equation*}
      (A\vb*{u}, A\vb*{v}) = (\vb*{u}, A^*A\vb*{v})
    \end{equation*}
    ここで、$A$がユニタリ行列であることは、
    \begin{equation*}
      A^*A = E
    \end{equation*}
    と言い換えられるので、これを用いると、
    \begin{equation*}
      (A\vb*{u}, A\vb*{v}) = (\vb*{u}, \vb*{v})
    \end{equation*}
    が成り立つ $\qed$
  \end{subpattern}

  \begin{subpattern}{\bfseries 内積を保つならばユニタリ行列}
    転置を用いて内積を表すと、
    \begin{align*}
      (A\vb*{u}, A\vb*{v}) & = {}^t(A\vb*{u}) \overline{(A\vb*{v})} \\
      (\vb*{u}, \vb*{v})   & = {}^t\vb*{u} \overline{\vb*{v}}
    \end{align*}
    これらが一致するというのが仮定なので、
    \begin{equation*}
      {}^t(A\vb*{u}) \overline{(A\vb*{v})} = {}^t\vb*{u} \overline{\vb*{v}}
    \end{equation*}
    この関係を用いて、行列${}^tA\overline{A}$の$(i,j)$成分を考えると、
    \begin{align*}
      {}^t(A\vb*{e}_i) \overline{(A\vb*{e}_j)} & = {}^t\vb*{e}_i \overline{\vb*{e}_j} \\
                                               & = \delta_{ij}
    \end{align*}
    となり、これはすなわち、
    \begin{equation*}
      {}^tA\overline{A} = E
    \end{equation*}
    よって、両辺の複素共役をとることで、
    \begin{equation*}
      A^*A = E
    \end{equation*}
    を得る

    したがって、$A$はユニタリ行列である $\qed$
  \end{subpattern}
\end{proof}

\br

この定理において、$\vb*{u} =  \vb*{v}$の場合を考えると、ユニタリ行列とノルムに関する性質が導かれる

\subsection{ユニタリ行列とノルム}

ユニタリ行列を左からかけても、ベクトルのノルムは変わらない

\begin{theorem}{ユニタリ行列の特徴づけとしてのノルム不変性}{unitary-characterized-by-norm-invariance}
  $n$次複素行列$A$がユニタリ行列であることと、任意の$\vb*{v} \in \mathbb{C}^n$に対し、
  \begin{equation*}
    \|A\vb*{v}\| = \|\vb*{v}\|
  \end{equation*}
  が成り立つことは同値である
\end{theorem}

\begin{proof}
  $A$がユニタリ行列であることと、任意の$\vb*{u},\,\vb*{v} \in \mathbb{C}^n$に対し、
  \begin{equation*}
    (A\vb*{u}, A\vb*{v}) = (\vb*{u}, \vb*{v})
  \end{equation*}
  が成り立つことは同値であった

  ここで、$\vb*{u} = \vb*{v}$とすると、
  \begin{equation*}
    (A\vb*{v}, A\vb*{v}) = (\vb*{v}, \vb*{v})
  \end{equation*}
  が成り立つことになり、ノルムの定義より、
  \begin{equation*}
    \|A\vb*{v}\|^2                 = \|\vb*{v}\|^2
  \end{equation*}
  すなわち、
  \begin{equation*}
    \|A\vb*{v}\| = \|\vb*{v}\|
  \end{equation*}
  がしたがう $\qed$
\end{proof}

\subsection{ユニタリ行列と直交性}

$A$が実正方行列のときは、
\begin{equation*}
  A\text{がユニタリ行列} \Longleftrightarrow {}^tA = A^{-1}
\end{equation*}
となり、このような$A$は\keyword{直交行列}と呼ばれる

\begin{definition}{直交行列}
  実正方行列$A$が次を満たすとき、$A$を\keyword{直交行列}という
  \begin{equation*}
    {}^t A = A^{-1}
  \end{equation*}
\end{definition}

直交行列という名前の由来は、次のように考えられる

\br

$A$を$n$個の列ベクトルを横一列に並べたものとみなし、
\begin{equation*}
  A = (\vb*{a}_1, \vb*{a}_2, \ldots, \vb*{a}_n)
\end{equation*}
とおくと、${}^t A = A^{-1}$、すなわち${}^tAA = E$は、
\begin{equation*}
  \begin{pmatrix}
    {}^t \vb*{a}_1 \\
    {}^t \vb*{a}_2 \\
    \vdots         \\
    {}^t \vb*{a}_n
  \end{pmatrix} \left(
  \vb*{a}_1, \vb*{a}_2, \ldots, \vb*{a}_n
  \right) = \begin{pmatrix}
    1      & 0      & \cdots & 0      \\
    0      & 1      & \cdots & 0      \\
    \vdots & \vdots & \ddots & \vdots \\
    0      & 0      & \cdots & 1
  \end{pmatrix}
\end{equation*}
と表される

\br

これは、ベクトル$\vb*{a}_1, \vb*{a}_2, \ldots, \vb*{a}_n$が、次の性質
\begin{equation*}
  {}^t \vb*{a}_i \vb*{a}_j =(\vb*{a}_i, \vb*{a}_j) = \delta_{ij}
\end{equation*}
を満たすことを意味する

\br

すなわち、直交行列$A$の列ベクトル$\vb*{a}_1, \vb*{a}_2, \ldots, \vb*{a}_n$は、互いに直交する単位ベクトルである

\br

この事実は、複素行列に対しても成立する

\begin{theorem}{ユニタリ行列の列ベクトルの直交正規性}{unitary-iff-columns-orthonormal}
  複素正方行列$A$を$A = (\vb*{a}_1, \ldots, \vb*{a}_n)$と列ベクトル分解するとき、
  \begin{equation*}
    A\text{がユニタリ行列} \Longleftrightarrow (\vb*{a}_i, \vb*{a}_j) = \delta_{ij}
  \end{equation*}
  すなわち、ユニタリ行列の列ベクトルは、互いに直交する単位ベクトルである
\end{theorem}

\begin{proof}
  $A$がユニタリ行列であることは、任意の$\vb*{u},\,\vb*{v} \in \mathbb{C}^n$に対し、
  \begin{equation*}
    (A\vb*{u}, A\vb*{v}) = (\vb*{u}, \vb*{v})
  \end{equation*}
  が成り立つことと同値であった

  ここで、$\vb*{u} = \vb*{e}_i,\, \vb*{v} = \vb*{e}_j$とすると、
  \begin{equation*}
    (A\vb*{e}_i, A\vb*{e}_j) = (\vb*{e}_i, \vb*{e}_j)
  \end{equation*}
  が成り立つことになる

  \br

  左辺の$A\vb*{e}_i$について考えると、
  \begin{align*}
    A\vb*{e}_i & = \left( \vb*{a}_1, \ldots, \vb*{a}_i, \ldots, \vb*{a}_n \right)
    \begin{pNiceMatrix}[last-col]
      0      &              \\
      \vdots &              \\
      1      & \leftarrow i \\
      \vdots &              \\
      0      &
    \end{pNiceMatrix}                                                  \\
               & = \vb*{a}_i
  \end{align*}
  $A\vb*{e}_j$についても同様なので、
  \begin{align*}
    (A\vb*{e}_i, A\vb*{e}_j) = (\vb*{a}_i, \vb*{a}_j) & = (\vb*{e}_i, \vb*{e}_j) = \delta_{ij} \\
    \therefore \quad (\vb*{a}_i, \vb*{a}_j)           & = \delta_{ij}
  \end{align*}
  となり、$A$がユニタリ行列であることは、$(\vb*{a}_i, \vb*{a}_j) = \delta_{ij}$へと同値変形できる $\qed$
\end{proof}

\subsection{ユニタリ行列と随伴・転置}

\begin{theorem*}{ユニタリ行列の随伴不変性}
  ユニタリ行列$U$の随伴行列$U^*$もユニタリ行列である
\end{theorem*}

\begin{proof}
  \thmref{thm:adjoint-involution}より、随伴行列を二回とると元に戻るので、
  \begin{equation*}
    (U^*)^* = U
  \end{equation*}
  また、ユニタリ行列の定義より、
  \begin{equation*}
    U^* = U^{-1}
  \end{equation*}
  したがって、
  \begin{align*}
    (U^*)^* & = U          \\
    U       & = (U^*)^{-1}
  \end{align*}
  すなわち、
  \begin{equation*}
    U^* = (U^*)^{-1}
  \end{equation*}
  となるので、$U^*$もユニタリ行列である $\qed$
\end{proof}

\br

上の定理は、実行列の世界では、次の定理に対応する

\begin{theorem}{直交行列の転置不変性}{transpose-of-orthogonal}
  直交行列$Q$の転置行列${}^tQ$も直交行列である
\end{theorem}

\end{document}
