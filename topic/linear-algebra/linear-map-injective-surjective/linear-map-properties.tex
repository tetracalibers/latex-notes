\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{線形写像とベクトルの線型独立性}
\marginnote{\refbookA p65〜66 \\ \refbookC p71〜73}

\begin{theorem}{線形写像と線形独立性}
  $f\colon \mathbb{R}^n \to \mathbb{R}^m$を線形写像、$\vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n \in \mathbb{R}^n$とする

  ベクトル$\vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n$の$f$による像
  \begin{equation*}
    f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n)
  \end{equation*}
  が線型独立であるとき、$\{ \vb*{v}_1, \dots, \vb*{v}_n \}$も線型独立である
\end{theorem}

\begin{proof}
  $\vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n$の線形結合
  \begin{equation*}
    c_1 \vb*{v}_1 + c_2 \vb*{v}_2 + \dots + c_n \vb*{v}_n = \vb*{0}
  \end{equation*}
  を考える

  この両辺を$f$で写すと、$f$の線形性と零ベクトルの像$f(\vb*{0}) = \vb*{0}$を使って
  \begin{equation*}
    c_1 f(\vb*{v}_1) + c_2 f(\vb*{v}_2) + \dots + c_n f(\vb*{v}_n) = f(\vb*{0}) = \vb*{0}
  \end{equation*}

  仮定より$f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n)$は線型独立なので、$c_1 = c_2 = \dots = c_n = 0$である

  よって、
  \begin{equation*}
    c_1 \vb*{v}_1 + c_2 \vb*{v}_2 + \dots + c_n \vb*{v}_n = \vb*{0}
  \end{equation*}
  を満たす$c_1, c_2, \dots, c_n$は0しかないので、$\{ \vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n \}$は線型独立である $\qed$
\end{proof}

\sectionline

次の定理は、平行なベクトルを線型写像で写した結果、平行でなくなったりはしないということを述べている

\begin{theorem}{線形写像と線形従属性}
  $f\colon \mathbb{R}^n \to \mathbb{R}^m$を線形写像、$\vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n \in \mathbb{R}^n$とする

  $\{\vb*{v}_1, \dots, \vb*{v}_n\}$が線形従属ならば、$\{ f(\vb*{v}_1),  \dots, f(\vb*{v}_n) \}$は線形従属である
\end{theorem}

\begin{proof}
  $\{\vb*{v}_1, \dots, \vb*{v}_n\}$が線形従属であるとは、少なくとも1つは0でないある定数$k_1, k_2, \dots, k_n$が存在して
  \begin{equation*}
    k_1 \vb*{v}_1 + k_2 \vb*{v}_2 + \dots + k_n \vb*{v}_n = \vb*{0}
  \end{equation*}
  が成り立つことを意味する

  この両辺を$f$で写すと、線形性より
  \begin{equation*}
    k_1 f(\vb*{v}_1) + k_2 f(\vb*{v}_2) + \dots + k_n f(\vb*{v}_n) = f(\vb*{0}) = \vb*{0}
  \end{equation*}
  が成り立つ

  よって、$\{ f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n) \}$も線形従属である $\qed$
\end{proof}

\sectionline

たとえば平行四辺形の像が線分や1点になったりしないことなどは、「$\{ \vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n \}$が線型独立ならば、$\{ f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n) \}$も線型独立である」と表現できる

\begin{theorem}{単射な線型写像と線型独立性}
  線型写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$が単射であるとき、$\{ \vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n \}$が線型独立ならば、$\{ f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n) \}$も線型独立である
\end{theorem}

\begin{proof}
  $f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n)$の線形結合
  \begin{equation*}
    c_1 f(\vb*{v}_1) + c_2 f(\vb*{v}_2) + \dots + c_n f(\vb*{v}_n) = \vb*{0}
  \end{equation*}
  を考える

  $f$の線形性と零ベクトルの像$f(\vb*{0}) = \vb*{0}$より、次のように書き換えられる
  \begin{equation*}
    f(c_1 \vb*{v}_1 + c_2 \vb*{v}_2 + \dots + c_n \vb*{v}_n) = \vb*{0} = f(\vb*{0})
  \end{equation*}

  $f$は単射だから、上式より
  \begin{equation*}
    c_1 \vb*{v}_1 + c_2 \vb*{v}_2 + \dots + c_n \vb*{v}_n = \vb*{0}
  \end{equation*}
  が成り立つ

  ここで、$\vb*{v}_1, \vb*{v}_2, \dots, \vb*{v}_n$は線型独立なので、$c_1 = c_2 = \dots = c_n = 0$である

  よって、$f(\vb*{v}_1), f(\vb*{v}_2), \dots, f(\vb*{v}_n)$は線型独立である $\qed$
\end{proof}

\sectionline

零写像と射影を除けば、$f$によってベクトルが「つぶれない」という性質は、次のように表せる
\begin{equation*}
  \vb*{v} \neq 0 \Longrightarrow f(\vb*{v}) \neq \vb*{0}
\end{equation*}

\todo{\refbookA p55 例2.1.15}

この条件は、実は線形写像が単射であることを意味している

対偶をとって、次のように表現できる

\begin{theorem}{線形写像の単射性}
  線形写像$f$が単射であることと次は同値である
  \begin{equation*}
    f(\vb*{v}) = \vb*{0} \Longrightarrow \vb*{v} = \vb*{0}
  \end{equation*}
\end{theorem}

\begin{proof}
  \begin{enumerate}[label=\romanlabel]
    \item $f$が単射
    \item $f(\vb*{v}) = \vb*{0} \Longrightarrow \vb*{v} = \vb*{0}$
  \end{enumerate}

  \begin{subpattern}{(\romannum{i}) $\Longrightarrow$ (\romannum{ii})}
    零ベクトルの像は零ベクトルであることから、$f(\vb*{v}) = \vb*{0}$は、
    \begin{equation*}
      f(\vb*{v}) = f(\vb*{0})
    \end{equation*}
    と書き換えられる

    $f$の単射性により、この式から、
    \begin{equation*}
      \vb*{v} = \vb*{0}
    \end{equation*}
    がしたがう $\qed$
  \end{subpattern}

  \begin{subpattern}{(\romannum{ii}) $\Longrightarrow$ (\romannum{i})}
    $f(\vb*{v}_1) = f(\vb*{v}_2)$を満たす$\vb*{v}_1, \vb*{v}_2 \in \mathbb{R}^n$を考える

    このとき、$f$の線形性から、
    \begin{equation*}
      f(\vb*{v}_1 - \vb*{v}_2) = f(\vb*{v}_1) - f(\vb*{v}_2)
    \end{equation*}
    となる

    仮定(\romannum{ii})より、
    \begin{equation*}
      f(\vb*{v}_1 - \vb*{v}_2) = \vb*{0} \Longrightarrow \vb*{v}_1 - \vb*{v}_2 = \vb*{0}
    \end{equation*}
    がいえるので、$\vb*{v}_1 = \vb*{v}_2$が成り立つ

    $f(\vb*{v}_1) = f(\vb*{v}_2)$から$\vb*{v}_1 = \vb*{v}_2$が導かれたことで、$f$は単射であることが示された $\qed$
  \end{subpattern}
\end{proof}

\sectionline
\section{線形写像の単射性と全射性}
\marginnote{\refbookA p67〜68}

線形写像$f$の単射性を表現行列$A$の言葉で述べる

\begin{theorem}{線形写像の単射性と表現行列}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の表現行列を$A$とするとき、次はすべて同値
  \begin{enumerate}[label=\romanlabel]
    \item $f$は単射
    \item $A\vb*{x} = \vb*{0}$は自明な解しか持たない
    \item $\rank(A) = n$
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{subpattern}{(\romannum{i}) $\Longleftrightarrow$ (\romannum{ii})}
    線形写像$f$は、表現行列$A$を用いて次のように表せる
    \begin{equation*}
      f(\vb*{x}) = A\vb*{x}
    \end{equation*}

    $f$が単射であることの言い換えは、
    \begin{equation*}
      f(\vb*{x}) = \vb*{0} \Longrightarrow \vb*{x} = \vb*{0}
    \end{equation*}
    であり、$A\vb*{x} = \vb*{0}$が自明解しか持たないことは、
    \begin{equation*}
      A\vb*{x} = \vb*{0} \Longrightarrow \vb*{x} = \vb*{0}
    \end{equation*}
    が成り立つということである

    $f(\vb*{x}) = A\vb*{x}$であるから、これらの2つの条件は同値である $\qed$
  \end{subpattern}

  \begin{subpattern}{(\romannum{ii}) $\Longleftrightarrow$ (\romannum{iii})}
    斉次形の方程式$A\vb*{x} = \vb*{0}$に自明解しか存在しないことと
    \begin{equation*}
      \rank(A) = n
    \end{equation*}
    と同値であることは\hyperref[thm:homogeneous-trivial-iff-full-col-rank]{以前}証明済み $\qed$
  \end{subpattern}
\end{proof}

\romannum{i}は抽象的な概念、\romannum{ii}は方程式論的な言葉、\romannum{iii}は数値的な条件であり、これらは同値な言い換えである

\sectionline

単射性と対比して、全射性の理解も表現行列の言葉で整理する

\begin{theorem}{線形写像の全射性と表現行列}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の表現行列を$A$とするとき、次はすべて同値
  \begin{enumerate}[label=\romanlabel]
    \item $f$は全射
    \item 任意の$\vb*{b} \in \mathbb{R}^m$に対して、$A\vb*{x} = \vb*{b}$には解が存在する
    \item $\rank(A) = m$
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{subpattern}{(\romannum{i}) $\Longleftrightarrow$ (\romannum{ii})}
    線形写像$f$は、表現行列$A$を用いて次のように表せる
    \begin{equation*}
      f(\vb*{x}) = A\vb*{x}
    \end{equation*}

    $f$が全射であることの言い換えは、
    \begin{equation*}
      \forall \vb*{b} \in \mathbb{R}^m, \exists \vb*{x} \in \mathbb{R}^n, f(\vb*{x}) = \vb*{b}
    \end{equation*}
    であり、これは
    \begin{equation*}
      \forall \vb*{b} \in \mathbb{R}^m, A\vb*{x} = \vb*{b} \text{に解が存在する}
    \end{equation*}
    と同値である

    よって、これらの2つの条件は同値である $\qed$

  \end{subpattern}

  \begin{subpattern}{(\romannum{ii}) $\Longleftrightarrow$ (\romannum{iii})}
    $\rank(A) = m$が、次の条件
    \begin{equation*}
      ^{\forall}\vb*{b} \in \mathbb{R}^m, A\vb*{x} = \vb*{b} \text{の解が存在する}
    \end{equation*}
    ことと同値であることは、\hyperref[thm:full-row-rank-solvable]{以前}証明済み $\qed$
  \end{subpattern}
\end{proof}

\sectionline
\section{像空間と核空間}
\marginnote{\refbookA p68〜69}

線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の\keyword{全射性}は、$\mathbb{R}^m$の部分集合である\keyword{像空間}$\Im(f)$と関係している

$f$が全射であることは、$\Im(f) = \mathbb{R}^m$と同値である

\sectionline

一方、$f$の\keyword{単射性}と関連して、$\mathbb{R}^n$の部分集合
\begin{equation*}
  \Ker(f) = \{ \vb*{v} \in \mathbb{R}^n \mid f(\vb*{v}) = \vb*{0} \}
\end{equation*}
を考え、これを$f$の\keyword{核空間}あるいは\keyword{カーネル}と呼ぶ

\br

線形写像の単射性は、次のようにも言い換えられる

\begin{theorem}{線形写像の単射性}
  線形写像$f$が単射であることと次は同値である
  \begin{equation*}
    \Ker(f) = \{ \vb*{0} \}
  \end{equation*}
\end{theorem}

\sectionline

核空間$\Ker(f)$は、実はすでに馴染みのある概念である

\begin{theorem}{核空間と表現行列}
  線形写像$f\colon \mathbb{R}^n \to \mathbb{R}^m$の表現行列を$A$とするとき、
  \begin{equation*}
    \Ker(f) = \{ \vb*{v} \in \mathbb{R}^n \mid A\vb*{v} = \vb*{0} \}
  \end{equation*}
  と定めると、
  \begin{equation*}
    \Ker(f) = \Ker(A)
  \end{equation*}
\end{theorem}

これは、斉次形の連立線形方程式$A\vb*{x} = \vb*{0}$の\keyword{解空間}そのものである

\br

$\Ker(A)$の元は、$A\vb*{x} = \vb*{0}$の基本解を使ってパラメータ表示できる

\end{document}
