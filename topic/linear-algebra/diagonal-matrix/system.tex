\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{対角行列の嬉しさ：入出力の視点}
\marginnote{\refbookL p42、p51}

ベクトルと行列を使うことで、入力$\vb*{x}$と出力$\vb*{y}$の関係を多次元の場合でも簡潔に表すことができる
\begin{equation*}
  \vb*{y} = A \vb*{x}
\end{equation*}

\subsection{一般の行列による入出力}

たとえば$\vb*{x}$と$\vb*{y}$をともに3次元ベクトルとすると、$\vb*{y} = A \vb*{x}$は、
\begin{align*}
  \begin{pmatrix}
    y_1 \\
    y_2 \\
    y_3
  \end{pmatrix} & = \begin{pmatrix}
                      a_{11} & a_{12} & a_{13} \\
                      a_{21} & a_{22} & a_{23} \\
                      a_{31} & a_{32} & a_{33}
                    \end{pmatrix}
  \begin{pmatrix}
    x_1 \\
    x_2 \\
    x_3
  \end{pmatrix}                                        \\
                  & = \begin{pmatrix}
                        a_{11}x_1 + a_{12}x_2 + a_{13}x_3 \\
                        a_{21}x_1 + a_{22}x_2 + a_{23}x_3 \\
                        a_{31}x_1 + a_{32}x_2 + a_{33}x_3
                      \end{pmatrix}
\end{align*}

\br

ここで、たとえば2行目に注目すると、
\begin{equation*}
  y_2 = a_{21}x_1 + a_{22}x_2 + a_{23}x_3
\end{equation*}
となり、$y_2$の計算に$\vb*{x}$のすべての成分$x_1, x_2, x_3$が使われていることがわかる

\br

\begin{shaded}
  各行に対応する出力$y_i$は、入力$\vb*{x}$のすべての成分に依存している
\end{shaded}

この依存関係を、次のようなダイアグラムで表すことにする

\br

\begin{center}
  \scalebox{1.1}{\begin{tikzpicture}[
      x=2.2cm,y=1.4cm,
      connect arrow/.style={-{Latex},thick}]

      \def\r{0.2cm};

      % input nodes

      \coordinate (N1-1) at (1,1);
      \coordinate (N1-2) at (1,0);
      \coordinate (N1-3) at (1,-1);

      \draw[Rhodamine,thick] (N1-1) circle (\r) node[left=0.7ex,lightslategray] {$x_1$};
      \draw[Cerulean,thick] (N1-2) circle (\r) node[left=0.7ex,lightslategray] {$x_2$};
      \draw[LimeGreen,thick] (N1-3) circle (\r) node[left=0.7ex,lightslategray] {$x_3$};

      % output nodes

      \coordinate (N2-1) at (2,1);
      \coordinate (N2-2) at (2,0);
      \coordinate (N2-3) at (2,-1);

      \draw[Orchid,thick] (N2-1) circle (\r) node[right=0.7ex,lightslategray] {$y_1$};
      \draw[Orchid,thick] (N2-2) circle (\r) node[right=0.7ex,lightslategray] {$y_2$};
      \draw[Orchid,thick] (N2-3) circle (\r) node[right=0.7ex,lightslategray] {$y_3$};

      % Connections from input to output nodes

      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-1.west);
      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-2.west);
      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-3.west);

      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-1.west);
      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-2.west);
      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-3.west);

      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-1.west);
      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-2.west);
      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-3.west);
    \end{tikzpicture}}
\end{center}

\subsection{対角行列による入出力}

$A$が対角行列の場合、$\vb*{y} = A \vb*{x}$は次のような形になる
\begin{align*}
  \begin{pmatrix}
    y_1 \\
    y_2 \\
    y_3
  \end{pmatrix} & = \begin{pmatrix}
                      a_{11} & 0      & 0      \\
                      0      & a_{22} & 0      \\
                      0      & 0      & a_{33}
                    \end{pmatrix}
  \begin{pmatrix}
    x_1 \\
    x_2 \\
    x_3
  \end{pmatrix}                             \\
                  & = \begin{pmatrix}
                        a_{11}x_1 \\
                        a_{22}x_2 \\
                        a_{33}x_3
                      \end{pmatrix}
\end{align*}

ベクトルの各行に注目すると、各出力$y_i$は、入力$\vb*{x}$の対応する成分$x_i$のみに依存していることがわかる

\br

\begin{center}
  \scalebox{1.1}{\begin{tikzpicture}[
      x=2.2cm,y=1.4cm,
      connect arrow/.style={-{Latex},thick}]

      \def\r{0.2cm};

      % input nodes

      \coordinate (N1-1) at (1,1);
      \coordinate (N1-2) at (1,0);
      \coordinate (N1-3) at (1,-1);

      \draw[Rhodamine,thick] (N1-1) circle (\r) node[left=0.7ex,lightslategray] {$x_1$};
      \draw[Cerulean,thick] (N1-2) circle (\r) node[left=0.7ex,lightslategray] {$x_2$};
      \draw[LimeGreen,thick] (N1-3) circle (\r) node[left=0.7ex,lightslategray] {$x_3$};

      % output nodes

      \coordinate (N2-1) at (2,1);
      \coordinate (N2-2) at (2,0);
      \coordinate (N2-3) at (2,-1);

      \draw[Orchid,thick] (N2-1) circle (\r) node[right=0.7ex,lightslategray] {$y_1$};
      \draw[Orchid,thick] (N2-2) circle (\r) node[right=0.7ex,lightslategray] {$y_2$};
      \draw[Orchid,thick] (N2-3) circle (\r) node[right=0.7ex,lightslategray] {$y_3$};

      % Connections from input to output nodes

      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-1.west);

      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-2.west);

      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-3.west);
    \end{tikzpicture}}
\end{center}

このように、$A$が対角行列の場合、$\vb*{y} = A \vb*{x}$は独立な$n$本のサブシステム
\begin{align*}
  y_1 & = a_{11} x_1    \\
      & \vdotswithin{=} \\
  y_n & = a_{nn} x_n
\end{align*}
に分割されている

\br

つまり、対角行列を使って関係を表現できれば、
\begin{shaded}
  見た目は$n$次元問題でも、実質は1次元問題が$n$本あるだけ
\end{shaded}
という状況になり、問題を大きく単純化できる

\subsection{ブロック対角行列による入出力}

ブロック対角行列は、
\begin{shaded}
  各ブロックごとに独立に変換される
\end{shaded}
という形の写像を表している

\br

たとえば、
\begin{equation*}
  \begin{pmatrix}
    y_1 \\
    y_2 \\
    y_3 \\
    y_4
  \end{pmatrix} = \begin{pmatrix}
    a_{11} & a_{12} & 0      & 0      \\
    a_{21} & a_{22} & 0      & 0      \\
    0      & 0      & a_{33} & a_{34} \\
    0      & 0      & a_{43} & a_{44}
  \end{pmatrix}
  \begin{pmatrix}
    x_1 \\
    x_2 \\
    x_3 \\
    x_4
  \end{pmatrix}
\end{equation*}
というブロック対角行列は、次のように分けて考えることができる
\begin{align*}
  \begin{pmatrix}
    y_1 \\
    y_2
  \end{pmatrix} & = \begin{pmatrix}
                      a_{11} & a_{12} \\
                      a_{21} & a_{22}
                    \end{pmatrix}
  \begin{pmatrix}
    x_1 \\
    x_2
  \end{pmatrix}                    \\
  \begin{pmatrix}
    y_3 \\
    y_4
  \end{pmatrix} & = \begin{pmatrix}
                      a_{33} & a_{34} \\
                      a_{43} & a_{44}
                    \end{pmatrix}
  \begin{pmatrix}
    x_3 \\
    x_4
  \end{pmatrix}
\end{align*}

\br

ダイアグラムで表すと、2つの独立なサブシステムに分解されている様子が見える
\begin{center}
  \scalebox{1.1}{\begin{tikzpicture}[
      x=2.2cm,y=1.4cm,
      connect arrow/.style={-{Latex},thick}]

      \def\r{0.2cm};

      % input nodes

      \coordinate (N1-1) at (1,1);
      \coordinate (N1-2) at (1,0);
      \coordinate (N1-3) at (1,-1);
      \coordinate (N1-4) at (1,-2);

      \draw[Rhodamine,thick] (N1-1) circle (\r) node[left=0.7ex,lightslategray] {$x_1$};
      \draw[Cerulean,thick] (N1-2) circle (\r) node[left=0.7ex,lightslategray] {$x_2$};
      \draw[LimeGreen,thick] (N1-3) circle (\r) node[left=0.7ex,lightslategray] {$x_3$};
      \draw[BurntOrange,thick] (N1-4) circle (\r) node[left=0.7ex,lightslategray] {$x_4$};

      % output nodes

      \coordinate (N2-1) at (2,1);
      \coordinate (N2-2) at (2,0);
      \coordinate (N2-3) at (2,-1);
      \coordinate (N2-4) at (2,-2);

      \draw[Orchid,thick] (N2-1) circle (\r) node[right=0.7ex,lightslategray] {$y_1$};
      \draw[Orchid,thick] (N2-2) circle (\r) node[right=0.7ex,lightslategray] {$y_2$};
      \draw[Orchid,thick] (N2-3) circle (\r) node[right=0.7ex,lightslategray] {$y_3$};
      \draw[Orchid,thick] (N2-4) circle (\r) node[right=0.7ex,lightslategray] {$y_4$};

      % Connections from input to output nodes

      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-1.west);
      \draw[connect arrow,Rhodamine!60] (N1-1.east) -- (N2-2.west);

      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-1.west);
      \draw[connect arrow,Cerulean!60] (N1-2.east) -- (N2-2.west);

      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-3.west);
      \draw[connect arrow,LimeGreen!80] (N1-3.east) -- (N2-4.west);

      \draw[connect arrow,BurntOrange!80] (N1-4.east) -- (N2-3.west);
      \draw[connect arrow,BurntOrange!80] (N1-4.east) -- (N2-4.west);
    \end{tikzpicture}}
\end{center}

\end{document}
