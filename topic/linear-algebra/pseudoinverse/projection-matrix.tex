\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{擬似逆行列と行空間・列空間への射影}\label{sec:pseudoinverse-projection}
\marginnote{\refbookI p36〜38}

逆行列は、もとの行列との積が単位行列となるものとして定義された。
\begin{equation*}
  A^{-1} A = A A^{-1} = E
\end{equation*}

一方、ムーア・ペンローズの擬似逆行列ともとの行列との積は、列および行の張る空間への射影行列となる。
\begin{equation*}
  A^+ A = P_{\mathcal{V}}, \quad A A^+ = P_{\mathcal{U}}
\end{equation*}

\begin{theorem*}{ムーア・ペンローズ逆による行空間・列空間への射影}
  $A^+$をムーア・ペンローズの擬似逆行列とするとき、$A^+ A$は行空間$\mathcal{V}$への射影行列、$AA^+$は列空間$\mathcal{U}$への射影行列となる。
\end{theorem*}

\begin{proof}
  \begin{subpattern}{$A^+ A = P_{\mathcal{V}}$}
    $A$と$A^+$を正規直交化された特異ベクトルによる特異値分解で表すと、その積は、
    \begin{align*}
      A^+ A &= \left( \sum_{i=1}^r \frac{\vb*{v}_i \vb*{u}_i^\top}{\sigma_i} \right) \left( \sum_{j=1}^r \sigma_j \vb*{u}_j \vb*{v}_j^\top \right) \\
             &= \sum_{i=1}^r \sum_{j=1}^r \frac{\sigma_j}{\sigma_i} \vb*{v}_i (\vb*{u}_i^\top \vb*{u}_j) \vb*{v}_j^\top \\
             &= \sum_{i=1}^r \sum_{j=1}^r \frac{\sigma_j}{\sigma_i} \delta_{ij} \vb*{v}_i \vb*{v}_j^\top \\
             &= \sum_{i=1}^r \vb*{v}_i \vb*{v}_i^\top = P_{\mathcal{V}}
    \end{align*}
    となり、行空間$\mathcal{V}$への射影行列となる。$\qed$
  \end{subpattern}
  
  \begin{subpattern}{$A A^+ = P_{\mathcal{U}}$}
    同様に、$A A^+$を計算すると、
    \begin{align*}
      A A^+ &= \left( \sum_{i=1}^r \sigma_i \vb*{u}_i \vb*{v}_i^\top \right) \left( \sum_{j=1}^r \frac{\vb*{v}_j \vb*{u}_j^\top}{\sigma_j} \right) \\
            &= \sum_{i=1}^r \sum_{j=1}^r \frac{\sigma_i}{\sigma_j} (\vb*{u}_i^\top \vb*{u}_j) \vb*{v}_i \vb*{v}_j^\top \\
            &= \sum_{i=1}^r \sum_{j=1}^r \frac{\sigma_i}{\sigma_j} \delta_{ij} \vb*{v}_i \vb*{v}_j^\top \\
            &= \sum_{i=1}^r \vb*{v}_i \vb*{v}_i^\top = P_{\mathcal{U}}
    \end{align*}
    となり、列空間$\mathcal{U}$への射影行列となる。$\qed$
  \end{subpattern}
\end{proof}

\subsection{$A$が正則行列の場合}

$A$が正則行列の場合、$A$のムーア・ペンローズの擬似逆行列は、$A$の逆行列に一致する。

すなわち、$A$が正則の場合は、次が成り立つ。
\begin{equation*}
  A^+ A = A A^+ = E
\end{equation*}

この意味で、ムーア・ペンローズの擬似逆行列は逆行列の一般化とみなせる。

\br

また、\hyperref[sec:identity-to-projections]{単位行列は全空間への射影行列}であるので、ムーア・ペンローズの擬似逆行列ともとの行列との積が射影行列になることの特別な場合といえる。

\begin{theorem}{正則行列に対するムーア・ペンローズ逆}{pseudoinverse-of-invertible}
  $A$が正則行列であれば、ムーア・ペンローズの擬似逆行列$A^+$は逆行列$A^{-1}$に一致する。
\end{theorem}

\begin{proof}
  正則行列$A$の逆行列を$A^{-1}$とすると、
  \begin{align*}
    A^+ A &= A^{-1} A = E \\
    A A^+ &= A A^{-1} = E
  \end{align*}
  また、$AA^{-1} = E$と$A^{-1}A = E$より、
  \begin{align*}
    (AA^{-1})^\top & = E^\top = AA^{-1} \\
    (A^{-1}A)^\top & = E^\top = A^{-1}A
  \end{align*}
  以上より、$A^{-1}$はムーア・ペンローズの擬似逆行列$A^+$の定義を満たす。$\qed$
\end{proof}

\end{document}
