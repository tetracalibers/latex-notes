\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{射影行列}
\marginnote{\refbookI p5〜6}

ベクトルの射影の概念は、\keyword{射影行列}を用いて表現できる。

\br

任意のベクトル$\vb*{x} \in \mathbb{R}^n$は、$\vb*{u} \in \mathcal{U}$、$\vb*{u}^\perp \in \mathcal{U}^\perp$を用いて
\begin{equation*}
  \vb*{x} = \vb*{u} + \vb*{u}^\perp
\end{equation*}
と一意的に分解できる（\keyword{直和分解}）。

\br

ここで、$\vb*{x}$の$\mathcal{U}$への射影を表すのは、$\vb*{u}$である。

つまり、$\mathcal{U}$への射影とは$\vb*{x}$のうち、$\mathcal{U}$に含まれる成分$\vb*{u}$だけを取り出す操作といえる。

そこで、部分空間$\mathcal{U}$へ射影する写像を$P_{\mathcal{U}}$とすると、
\begin{equation*}
  P_{\mathcal{U}}\vb*{x} = \vb*{u}
\end{equation*}
という、「$\vb*{x}$に$P_{\mathcal{U}}$を作用させると$\vb*{u}$だけが残る」という形で書ける。

\subsection{部分空間への射影}\label{sec:projection-onto-subspace}

このとき、$\vb*{x}$がもともと$\mathcal{U}$の元である場合は、$\vb*{u}^\perp = \vb*{o}$の場合と考えて、
\begin{equation*}
  \vb*{x} = \vb*{u} + \vb*{o} = \vb*{u}
\end{equation*}
つまり、射影しても変わらないので、
\begin{equation*}
  P_{\mathcal{U}}\vb*{x} = \vb*{u} = \vb*{x} \quad (\vb*{x} \in \mathcal{U})
\end{equation*}
である。

\br

一方、$\vb*{x}$が$\mathcal{U}$の直交補空間$\mathcal{U}^{\perp}$の元の場合は、$\vb*{u} = \vb*{o}$の場合と考えて、
\begin{equation*}
  P_{\mathcal{U}}\vb*{x} = \vb*{u} = \vb*{o} \quad (\vb*{x} \in \mathcal{U}^{\perp})
\end{equation*}
となる。

\br

以上をまとめると、次のように書ける。
\begin{equation*}
  P_{\mathcal{U}}\vb*{x} = \begin{cases}
    \vb*{x} & (\vb*{x} \in \mathcal{U})         \\
    \vb*{o} & (\vb*{x} \in \mathcal{U}^{\perp})
  \end{cases}
\end{equation*}

\br

同様に、直交補空間$\mathcal{U}^\perp$へ射影する写像を$P_{\mathcal{U}^\perp}$とした場合、
\begin{equation*}
  P_{\mathcal{U}^{\perp}}\vb*{x} = \begin{cases}
    \vb*{o} & (\vb*{x} \in \mathcal{U})         \\
    \vb*{x} & (\vb*{x} \in \mathcal{U}^{\perp})
  \end{cases}
\end{equation*}
とまとめられる。

\subsection{射影行列の展開}\label{sec:projection-matrix-expansion}

$\mathbb{R}^n$が$\mathcal{U}$と$\mathcal{U}^\perp$の直和に分解されることから、\hyperref[thm:direct-sum-and-basis]{$\mathbb{R}^n$の基底は$\mathcal{U}$の基底と$\mathcal{U}^\perp$の基底を合わせたもの}になる。

\br

そこで、部分空間$\mathcal{U}$の正規直交基底$\{\vb*{u}_1, \ldots, \vb*{u}_r\}$を選ぶと、これを$\mathbb{R}^n$の正規直交基底$\{ \vb*{u}_1, \ldots, \vb*{u}_r, \vb*{u}_{r+1}, \ldots, \vb*{u}_n \}$に拡張できる。

ここで、$\{ \vb*{u}_{r+1}, \ldots, \vb*{u}_n \}$は$\mathcal{U}^\perp$の正規直交基底になる。

\br

このとき、
\begin{equation*}
  P_{\mathcal{U}}\vb*{x} = \begin{cases}
    \vb*{x} & (\vb*{x} \in \mathcal{U})         \\
    \vb*{o} & (\vb*{x} \in \mathcal{U}^{\perp})
  \end{cases}
\end{equation*}
という式は、$P_{\mathcal{U}}$が$\mathbb{R}^n$の正規直交基底
\begin{equation*}
  \{ \vb*{u}_1, \ldots, \vb*{u}_r, \vb*{u}_{r+1}, \ldots, \vb*{u}_n \}
\end{equation*}
を、それぞれ次のように写像することを意味する。
\begin{equation*}
  \{ \vb*{u}_1, \ldots, \vb*{u}_r, \vb*{o}, \ldots, \vb*{o} \}
\end{equation*}

\br

同様に、
\begin{equation*}
  P_{\mathcal{U}^{\perp}}\vb*{x} = \begin{cases}
    \vb*{o} & (\vb*{x} \in \mathcal{U})         \\
    \vb*{x} & (\vb*{x} \in \mathcal{U}^{\perp})
  \end{cases}
\end{equation*}
という式は、$P_{\mathcal{U}^{\perp}}$が$\mathbb{R}^n$の正規直交基底
\begin{equation*}
  \{ \vb*{u}_1, \ldots, \vb*{u}_r, \vb*{u}_{r+1}, \ldots, \vb*{u}_n \}
\end{equation*}
を、それぞれ次のように写像することを意味する。
\begin{equation*}
  \{ \vb*{o}, \ldots, \vb*{o}, \vb*{u}_{r+1}, \ldots, \vb*{u}_n \}
\end{equation*}

\br

ゆえに、\hyperref[thm:orthobasis-formula-for-rep-matrix]{正規直交基底による表現行列の展開}より、$P_{\mathcal{U}}$と$P_{\mathcal{U}^{\perp}}$は次のように表現できる。
\begin{align*}
  P_{\mathcal{U}}         & = \vb*{u}_1 \vb*{u}_1^\top + \cdots + \vb*{u}_r \vb*{u}_r^\top         \\
  P_{\mathcal{U}^{\perp}} & = \vb*{u}_{r+1} \vb*{u}_{r+1}^\top + \cdots + \vb*{u}_n \vb*{u}_n^\top
\end{align*}

$P_{\mathcal{U}}$と$P_{\mathcal{U}^{\perp}}$をそれぞれ、部分空間$\mathcal{U}$、およびその直交補空間$\mathcal{U}^{\perp}$への\keyword{射影行列}と呼ぶ。

\sectionline
\section{単位行列の射影行列への分解}
\marginnote{\refbookI p6}

\hyperref[sec:orthogonal-projection-and-reflection]{直交射影と反射影}の章で示した、
\begin{gather*}
  \overrightarrow{OP} = \overrightarrow{OQ} + \overrightarrow{QP} \\
  \overrightarrow{OQ} \in \mathcal{U}, \quad \overrightarrow{QP} \in \mathcal{U}^\perp
\end{gather*}
という関係は、射影行列を用いて、次のようにも表せる
\begin{align*}
  \overrightarrow{OP} & = P_{\mathcal{U}}\overrightarrow{OP} + P_{\mathcal{U}^{\perp}}\overrightarrow{OP} \\
                      & = (P_{\mathcal{U}} + P_{\mathcal{U}^{\perp}})\overrightarrow{OP}
\end{align*}

\begin{center}
  \tdplotsetmaincoords{70}{110} % 視点の角度設定
  \begin{tikzpicture}[tdplot_main_coords, scale=3]
    % 平面サイズと傾きの設定
    \def\planesize{1.1}
    \tdplotsetrotatedcoords{-20}{30}{0} % (theta, phi, psi)：傾きの設定

    % 原点と点の定義
    \coordinate (O) at (0, 0, 0);
    \coordinate (P) at (0.75, 0.75, 1.75); % 空間上の点 P
    \coordinate (Q) at (0.75, 0.75, 0.75); % 任意の平面上の点（Pの直交射影として仮置き）

    % 座標軸
    %\draw[axis] (O) -- (2.6, 0, 0) node[anchor=north east]{$x$};
    %\draw[axis] (O) -- (0, 1.4, 0) node[anchor=north west]{$y$};
    %\draw[axis] (O) -- (0, 0, 1.8) node[anchor=south]{$z$};

    % 直角
    \draw pic[
        fill=gray!60,
        draw=gray,
        angle radius=3mm,
        angle eccentricity=1.2,
      ] {right angle = P--Q--O};

    % 傾いた平面の描画（tdplot_rotated_coords環境内）
    \begin{scope}[tdplot_rotated_coords]
      \filldraw[SkyBlue!40, draw=none, opacity=0.6,postaction={pattern=crosshatch dots}, pattern color=SkyBlue!60]
      (-\planesize,-\planesize,0) --
      ( \planesize,-\planesize,0) --
      ( \planesize, \planesize,0) --
      (-\planesize, \planesize,0) -- cycle;
      \node[SkyBlue] at (\planesize*0.85,-\planesize*0.85,0) {$\mathcal{U}$};
    \end{scope}

    \draw[vector, Rhodamine] (O) -- (P) node[midway, left=1pt]{$\overrightarrow{OP}$};
    \draw[vector, Cerulean] (O) -- (Q) node[pos=0.35, right=3pt]{$P_{\mathcal{U}}\overrightarrow{OP}$};
    \draw[vector, Orchid] (Q) -- (P) node[pos=0.6, right=1pt]{$P_{\mathcal{U}^{\perp}}\overrightarrow{OP}$};

    % 点
    \filldraw[Rhodamine] (P) circle (0.5pt) node[anchor=south]{$P$};
    \filldraw[Cerulean] (Q) circle (0.5pt) node[anchor=west]{$Q$};
    \filldraw[gray] (O) circle (0.5pt) node[anchor=north east]{$O$};
  \end{tikzpicture}
\end{center}

$\mathbb{R}^n$内のすべての点$P$に対して、$\overrightarrow{OP} = (P_{\mathcal{U}} + P_{\mathcal{U}^{\perp}})\overrightarrow{OP}$が成り立つことから、
\begin{equation*}
  P_{\mathcal{U}} + P_{\mathcal{U}^{\perp}} = E
\end{equation*}
が成り立っている

\br

これはすなわち、単位行列$E$が、部分空間$\mathcal{U}$その直交補空間$\mathcal{U}^{\perp}$への射影行列の和に分解できることを意味する
\begin{equation*}
  E = \underbrace{\vb*{u}_1 \vb*{u}_1^\top + \cdots + \vb*{u}_r \vb*{u}_r^\top}_{P_{\mathcal{U}}} + \underbrace{\vb*{u}_{r+1} \vb*{u}_{r+1}^\top + \cdots + \vb*{u}_n \vb*{u}_n^\top}_{P_{\mathcal{U}^{\perp}}}
\end{equation*}

この式により、単位行列$E$自体を、空間全体$\mathbb{R}^n$への射影行列と考えることもできる

\sectionline
\section{射影行列とノルム}
\marginnote{\refbookI p6〜7}

$P_{\mathcal{U}}\overrightarrow{OP}$と$P_{\mathcal{U}^{\perp}}\overrightarrow{OP}$は直交するから、三平方の定理より、
\begin{equation*}
  \| \overrightarrow{OP} \|^2 = \| P_{\mathcal{U}}\overrightarrow{OP} \|^2 + \| P_{\mathcal{U}^{\perp}}\overrightarrow{OP} \|^2
\end{equation*}
がいえる

\br

ゆえに、任意のベクトル$\vb*{x} = \overrightarrow{OP}$に対して、
\begin{equation*}
  \| \vb*{x} \|^2 = \| P_{\mathcal{U}}\vb*{x} \|^2 + \| P_{\mathcal{U}^{\perp}}\vb*{x} \|^2
\end{equation*}
が成り立つ

\end{document}
