\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{正則行列}
\marginnote{\refbookA p71}

\begin{definition}{正則}
  線形変換$f$は全単射であるとき、\keyword{正則}な線形変換であるという
\end{definition}

\begin{definition}{正則行列}
  正方行列$A$は、それが正則な線形変換を与えるとき、\keyword{正則行列}であるという
\end{definition}

\sectionline

「線形代数における鳩の巣原理」から、次のことがいえる

\begin{theorem}{正則の判定と階数}\label{thm:invertible-iff-full-rank}
  $n$次正方行列$A$に対して、
  \begin{equation*}
    A \text{が正則行列} \Longleftrightarrow \rank(A) = n
  \end{equation*}
\end{theorem}

この定理は、線形変換$f$（もしくは正方行列$A$）が\keyword{正則}かどうかについて、\keyword{階数}という1つの数値で判定できることを示している

\sectionline

\begin{theorem}{列ベクトルの線型独立性による正則の判定}\label{thm:invertible-iff-col-indep}
  $n$次正方行列
  \begin{equation*}
    A = (\vb*{a}_1 , \cdots , \vb*{a}_n)
  \end{equation*}
  に対して、次が成り立つ
  \begin{equation*}
    A \text{が正則行列} \Longleftrightarrow \vb*{a}_1, \dots, \vb*{a}_n \text{が線型独立}
  \end{equation*}
\end{theorem}

\begin{proof}
  $\vb*{a}_1, \dots, \vb*{a}_n \in \mathbb{R}^n$が線型独立であることは、
  \begin{equation*}
    \rank(A) = n
  \end{equation*}
  と同値であることを\hyperref[thm:lin-indep-iff-rank-n]{以前}示した

  さらに、\hyperref[thm:invertible-iff-full-rank]{先ほど示した定理}より、$\rank(A) =n$は$A$が正則行列であることと同値である $\qed$
\end{proof}

\sectionline
\section{逆行列}
\marginnote{\refbookA p71〜72}

写像$f$が全単射であれば、\keyword{逆写像}$f^{-1}$が存在する

\begin{theorem}{逆写像の線形性}
  $f$を$\mathbb{R}^n$の正則な線形変換とするとき、逆写像$f^{-1}$は線形である
\end{theorem}

\begin{proof}
  $\vb*{x},\vb*{y} \in \mathbb{R}^n,\, c \in \mathbb{R}$とし、次の2つを示せばよい
  \begin{enumerate}[label=\romanlabel]
    \item $f^{-1}(\vb*{x} + \vb*{y}) = f^{-1}(\vb*{x}) + f^{-1}(\vb*{y})$
    \item $f^{-1}(c\vb*{x}) = c f^{-1}(\vb*{x})$
  \end{enumerate}

  \begin{subpattern}{(\romannum{i})}
    $f \circ f^{-1}$は恒等写像であるから、
    \begin{align*}
      \vb*{x}           & = f \circ f^{-1}(\vb*{x})           \\
      \vb*{y}           & = f \circ f^{-1}(\vb*{y})           \\
      \vb*{x} + \vb*{y} & = f \circ f^{-1}(\vb*{x} + \vb*{y})
    \end{align*}
    また、$f$は線形写像であるから、
    \begin{equation*}
      f \circ f^{-1}(\vb*{x} + \vb*{y}) = f(f^{-1}(\vb*{x}) + f^{-1}(\vb*{y}))
    \end{equation*}
    $f \circ f^{-1}(\vb*{v})$は、$f (f^{-1}(\vb*{v}))$を意味する記号なので、
    \begin{equation*}
      f(f^{-1}(\vb*{x}+\vb*{y})) = f(f^{-1}(\vb*{x}) + f^{-1}(\vb*{y}))
    \end{equation*}
    両辺を$f^{-1}$で写すと、
    \begin{equation*}
      f^{-1}(\vb*{x} + \vb*{y}) = f^{-1}(\vb*{x}) + f^{-1}(\vb*{y})
    \end{equation*}
    となり、(\romannum{i})が示された $\qed$
  \end{subpattern}

  \begin{subpattern}{(\romannum{ii})}
    $f \circ f^{-1}$は恒等写像であるから、
    \begin{align*}
      \vb*{x}  & = f \circ f^{-1}(\vb*{x}) = f(f^{-1}(\vb*{x}))   \\
      c\vb*{x} & = f \circ f^{-1}(c\vb*{x}) = f(f^{-1}(c\vb*{x}))
    \end{align*}
    $\vb*{x}= f(f^{-1}(\vb*{x}))$の両辺に$c$をかけた、次も成り立つ
    \begin{equation*}
      c\vb*{x} = c f(f^{-1}(\vb*{x}))
    \end{equation*}
    さらに、$f$は線形写像であるから、
    \begin{equation*}
      c f(f^{-1}(\vb*{x})) = f(c f^{-1}(\vb*{x}))
    \end{equation*}
    ここまでの$c\vb*{x}$の複数の表現により、次式が成り立つ
    \begin{equation*}
      f(f^{-1}(c\vb*{x})) = f(c f^{-1}(\vb*{x}))
    \end{equation*}
    両辺を$f^{-1}$で写すと、
    \begin{equation*}
      f^{-1}(c\vb*{x}) = c f^{-1}(\vb*{x})
    \end{equation*}
    となり、(\romannum{ii})が示された $\qed$
  \end{subpattern}
\end{proof}

\sectionline

$n$次正則行列$A$は、正則な線形変換$f\colon \mathbb{R}^n \to \mathbb{R}^n$と対応している

逆写像$f^{-1}$が存在し、線形であるから、ある$n$次正方行列$B$が対応するはずである

\br

$f \circ f^{-1} = f^{-1} \circ f = \id_{\mathbb{R}^n}$であり、線形写像の合成は行列の積に対応するから、
\begin{equation*}
  AB = BA = E
\end{equation*}
が成り立つ

\br

このような$B$を$A$の\keyword{逆行列}と呼び、$A^{-1}$と書く

\sectionline
\section{逆行列の性質}

\begin{theorem}{逆行列の一意性}
  正方行列$A$に対して、$A$の逆行列が存在するならば、それは一意的である
\end{theorem}

\begin{proof}
  $A$の逆行列が$B_1$と$B_2$の2つあるとする
  \begin{equation*}
    AB_1 = B_1A = E \quad \text{かつ} \quad AB_2 = B_2A = E
  \end{equation*}
  $AB_2 = E$の両辺に$B_1$をかけると、
  \begin{equation*}
    B_1 = B_1 AB_2 = (B_1 A) B_2 = E B_2 = B_2
  \end{equation*}
  よって、$B_1 = B_2$となり、逆行列は一意的である $\qed$
\end{proof}

\sectionline

\begin{theorem}{逆行列に対する逆行列}\label{thm:inverse-of-inverse}
  正則行列$A$の逆行列$A^{-1}$は正則であり、その逆行列は$A$である
  \begin{equation*}
    (A^{-1})^{-1} = A
  \end{equation*}
\end{theorem}

\begin{proof}
  $A$の逆行列が$A^{-1}$であることから、
  \begin{equation*}
    AA^{-1} = A^{-1}A = E
  \end{equation*}
  この式は、$A^{-1}$が正則であり、その逆行列が$A$であることを示す式でもある $\qed$
\end{proof}

\sectionline

\begin{theorem}{正則行列の積に対する逆行列}\label{thm:inverse-of-product}
  正則行列$A,\,B$の積$AB$は正則であり、その逆行列は次のようになる
  \begin{equation*}
    (AB)^{-1} = B^{-1} A^{-1}
  \end{equation*}
\end{theorem}

\begin{proof}
  \begin{align*}
    (AB)(B^{-1} A^{-1}) & = A(B B^{-1}) A^{-1} \\
                        & = A E A^{-1}         \\
                        & = E
  \end{align*}
  であり、同様に
  \begin{align*}
    (B^{-1} A^{-1})(AB) & = B^{-1} (A^{-1} A) B \\
                        & = B^{-1} E B          \\
                        & = E
  \end{align*}
  であるので、
  \begin{equation*}
    (AB)^{-1} = B^{-1} A^{-1}
  \end{equation*}
  が成り立つ $\qed$
\end{proof}

\sectionline
\section{逆行列の計算法と線形方程式}
\marginnote{\refbookA p72〜73}

正則行列$A$に対して、方程式$A\vb*{x} = \vb*{b}$のただ1つの解は次で与えられる
\begin{equation*}
  \vb*{x} = A^{-1} \vb*{b}
\end{equation*}
$A^{-1}$が計算できれば、行列のかけ算によって線型方程式の解が求められる

\sectionline

正則行列$A$の逆行列を計算するために、次の定理に注目しよう

\begin{theorem}{逆行列の計算法の原理}
  正方行列$A$に対して、$AB=E$を満たす正方行列$B$があるならば、$A$は正則であり、$B$は$A$の逆行列である
\end{theorem}

\begin{proof}
  \todo{\refbookA p72 命題2.4.6}
\end{proof}

上の定理の証明は、逆行列の計算法のヒントを含んでいる

$A$の逆行列$B$を求めるには、$n$個の線形方程式
\begin{equation*}
  A\vb*{b}_i = \vb*{e}_i \quad ( 1    \leq i \leq n )
\end{equation*}
を解けばよい

\br

$A$は階数$n$の$n$次正方行列なので、行変形で$A$から$E$に到達することができる

\br

$\vb*{b}_i$を求めるには、行変形により
\begin{equation*}
  (A \mid \vb*{e}_i) \rightarrow \cdots \rightarrow (E \mid \vb*{b}_i)
\end{equation*}
とすればよい

\br

$i$ごとに掃き出し法を何度も実行しないといけないのかと思いきや、一度にまとめられる
\begin{gather*}
  (A \mid E) = (A \mid \vb*{e}_1, \cdots , \vb*{e}_n) \rightarrow \\ \cdots \rightarrow (E \mid \vb*{b}_1 , \cdots , \vb*{b}_n) = (E \mid B)
\end{gather*}
このようにすれば、行変形は1通りで十分である

\sectionline
\section{正則行列と対角行列}
\marginnote{\refbookA p74〜75}

\begin{theorem}{上三角行列の正則性}
  対角成分がすべて0でない上三角行列は正則である
\end{theorem}

\begin{proof}
  \todo{\refbookA p74 命題2.4.9}
\end{proof}

\sectionline

\begin{theorem}{ブロック対角行列の正則性}\label{thm:block-diagonal-invertibility}
  次のようなブロック対角行列$M$において、対角ブロック$A,\,B$が正則であれば、$M$も正則である
  \begin{equation*}
    M = \begin{pNiceArray}{cc|cc}[xdots={horizontal-labels,line-style = <->},first-row,last-col,margin,columns-width =1em]
      \Hdotsfor{2}^{l} & \Hdotsfor{2}^{n-l} \\
      \Block{2-2}<\large>{A} & & \Block{2-2}<\large>{O} && \Vdotsfor{2}^{l}  \\
      &&& \\
      \hline
      \Block{2-2}<\large>{O}& & \Block{2-2}<\large>{B} && \Vdotsfor{2}^{n-l} \\
      &&&
    \end{pNiceArray}
  \end{equation*}
\end{theorem}

\begin{proof}
  $A$と$B$が正則であるから、逆行列$A^{-1}$と$B^{-1}$が存在する

  それらを用いて、次のような積を考える
  \begin{align*}
    \begin{pmatrix}
      A & O \\
      O & B
    \end{pmatrix} \begin{pmatrix}
                    A^{-1} & O      \\
                    O      & B^{-1}
                  \end{pmatrix} & = \begin{pmatrix}
                                      A A^{-1} & O        \\
                                      O        & B B^{-1}
                                    \end{pmatrix} \\
                                  & = \begin{pmatrix}
                                        E_l & O       \\
                                        O   & E_{n-l}
                                      \end{pmatrix}    \\
                                  & = E_n
  \end{align*}
  この等式は、$M$の逆行列の存在を示している
  \begin{equation*}
    M \begin{pmatrix}
      A^{-1} & O      \\
      O      & B^{-1}
    \end{pmatrix} = E_n
  \end{equation*}
  つまり、対角ブロックがそれぞれ正則であれば、それらの逆行列を並べることで全体の逆行列が構成できる

  このようにして、$M$が正則であることがわかる $\qed$
\end{proof}

\sectionline

\begin{theorem}{行基本変形と対角行列}
  正則行列$A$に対して、行のスカラー倍以外の行基本変形を繰り返し行って対角行列にできる
\end{theorem}

\begin{proof}
  \todo{\refbookA p75 命題2.4.12}
\end{proof}

\end{document}
