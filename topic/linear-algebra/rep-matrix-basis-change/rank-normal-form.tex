\documentclass[../../../topic_linear-algebra]{subfiles}

\begin{document}

\sectionline
\section{線形写像の階数標準形}
\marginnote{\refbookA p115〜117}

線形写像に対して、うまく基底を選ぶと、表現行列を\keyword{階数標準形}にできる

\begin{theorem*}{線形写像の階数標準形}
  線形写像$f\colon V \to W$に対し、$r = \rank(f)$とするとき、$V,W$のある基底に関する$f$の表現行列が次の形になる
  \begin{equation*}
    \begin{pmatrix}
      E_r & O \\
      O   & O
    \end{pmatrix}
  \end{equation*}
\end{theorem*}

\begin{proof}
  $V$の基底を次のように分けて構成する
  \begin{enumerate}[label=\romanlabel]
    \item $\Ker(f)$を張るベクトル（これは$f$によって零に写る）
    \item $\Ker(f)$に属さないが、$f$によって像を生成するベクトル（これは$f$によって非零に写る）
  \end{enumerate}

  $V,W$の次元をそれぞれ$n,m$とすると、\hyperref[thm:rank-nullity-theorem]{線形写像の次元定理}より、$\Ker(f)$の次元は$n - r$である

  そこで、$\Ker(f) \subset V$の基底を$\vb*{u}_1,\ldots,\vb*{u}_{n-r}$とする

  さらに、$\vb*{v}_1,\ldots,\vb*{v}_r \in V$を、$\vb*{v}_1,\ldots,\vb*{v}_r,\vb*{u}_1,\ldots,\vb*{u}_{n-r}$が$V$の基底になるように選ぶ（\hyperref[thm:basis-extension]{基底の延長}）

  \br

  このとき、
  \begin{equation*}
    \vb*{w}_i =  f(\vb*{v}_i) \quad (i = 1, \ldots, r)
  \end{equation*}
  とおくと、$\vb*{w}_1,\ldots,\vb*{w}_r$は線形独立である

  実際、線形関係式
  \begin{equation*}
    \sum_{i=1}^r c_i \vb*{w}_i = \vb*{0}
  \end{equation*}
  があるとすると、$f$は線形写像なので、
  \begin{equation*}
    \sum_{i=1}^r c_i \vb*{w}_i = \sum_{i=1}^r c_i f(\vb*{v}_i) = f\left(\sum_{i=1}^r c_i \vb*{v}_i\right) = \vb*{0}
  \end{equation*}
  より、
  \begin{equation*}
    \left(\sum_{i=1}^r c_i \vb*{v}_i\right) \in \Ker(f)
  \end{equation*}
  この線形結合で表されるベクトルを$\vb*{v}$とする
  \begin{equation*}
    \vb*{v} = \sum_{i=1}^r c_i \vb*{v}_i
  \end{equation*}
  すると、$\vb*{v} \in \Ker(f)$より、$\vb*{v}$は$\Ker(f)$の基底$\vb*{u}_1,\ldots,\vb*{u}_{n-r}$の線形結合でも表すことができる
  \begin{equation*}
    \vb*{v} = \sum_{j=1}^{n-r} d_j \vb*{u}_j
  \end{equation*}
  したがって、$\vb*{v}$の2通りの表現から、次の等式が成り立つ
  \begin{equation*}
    \sum_{i=1}^r c_i \vb*{v}_i = \sum_{j=1}^{n-r} d_j \vb*{u}_j
  \end{equation*}
  ここで、$\vb*{v}_1,\ldots,\vb*{v}_r,\vb*{u}_1,\ldots,\vb*{u}_{n-r}$は$V$の基底なので、線型独立である

  よって、等式
  \begin{equation*}
    \sum_{i=1}^r c_i \vb*{v}_i - \sum_{j=1}^{n-r} d_j \vb*{u}_j = \vb*{0}
  \end{equation*}
  が成り立つには、各係数が0でなければならない
  \begin{align*}
    c_i & = 0 \quad (i = 1, \ldots, r)   \\
    d_j & = 0 \quad (j = 1, \ldots, n-r)
  \end{align*}
  したがって、$\vb*{w}_1,\ldots,\vb*{w}_r$は線形独立である

  \br

  $\vb*{w}_1,\ldots,\vb*{w}_r$はすべて$\Im(f)$に属するので、これは$\Im(f) \subset W$の基底となる

  そこで、この基底を延長して、$\vb*{w}_1,\ldots,\vb*{w}_r,\vb*{w}_{r+1},\ldots,\vb*{w}_m$を$W$の基底とする

  \br

  このように構成した$V$と$W$の基底に関する線形写像$f$の表現行列を考える

  $\Ker(f)$を張るベクトル$\vb*{u}_1,\ldots,\vb*{u}_{n-r}$は$f$によって零に写ることと、$\vb*{w}_1,\ldots,\vb*{w}_r$の定義より、
  \begin{equation*}
    \begin{cases}
      f(\vb*{v}_i) = \vb*{w}_i & (i = 1, \ldots, r)   \\
      f(\vb*{u}_j) = \vb*{0}   & (j = 1, \ldots, n-r)
    \end{cases}
  \end{equation*}
  よって、基底$\{ \vb*{v}_1,\ldots,\vb*{v}_r,\vb*{u}_1,\ldots,\vb*{u}_{n-r} \}$における$f$の表現行列は、
  \begin{align*}
     & \phantom{ = } (f(\vb*{v}_1), \ldots, f(\vb*{v}_r), f(\vb*{u}_1), \ldots, f(\vb*{u}_{n-r})) \\
     & = ( \vb*{w}_1, \ldots, \vb*{w}_r, \vb*{0}, \ldots, \vb*{0} )                               \\
     & = (\vb*{w}_1, \ldots, \vb*{w}_r) \begin{pmatrix}
                                          E_r & O \\
                                          O   & O
                                        \end{pmatrix}
  \end{align*}
  として定まる $\qed$
\end{proof}

\br

このように、線形空間$V,W$の任意の基底変換を許すと、線形写像$f$の表現行列をとても単純な形
\begin{equation*}
  \begin{pmatrix}
    E_r & O \\
    O   & O
  \end{pmatrix}
\end{equation*}
にできる

これを$f$の\keyword{階数標準形}という

\sectionline

\hyperref[thm:change-of-representation-matrix]{基底変換に伴う表現行列の変換}の原理を用いて、先ほどの定理を行列の言葉で表すことができる

\br

線形写像$f\colon V \to W$の基底$\mathcal{V},\, \mathcal{W}$に関する表現行列を$A$とし、同じ線形写像$f$の別な基底$\mathcal{V}',\, \mathcal{W}'$に関する表現行列を階数標準形を$B$とする

このとき、\hyperref[thm:rank-normal-form-by-regular-matrices]{正則行列による階数標準形の構成}より、それぞれの基底変換行列$P,Q$は行変形、列変形に対応する正則行列である

\begin{theorem*}{表現行列の階数標準形}
  $m\times n$型行列$A$に対し、それぞれ$n,m$次の正則行列$P,Q$が存在して、
  \begin{equation*}
    Q^{-1} A P = \begin{pmatrix}
      E_r & O \\
      O   & O
    \end{pmatrix}
  \end{equation*}
  となる

  ここで、$r = \rank(A)$である
\end{theorem*}

\end{document}
