\documentclass[../../../topic_linear-algebra]{subfiles}

\usepackage{xr-hyper}
\externaldocument{../../../.tex_intermediates/topic_linear-algebra}

\begin{document}

\sectionline
\section{基底の取り替え}
\marginnote{\refbookS p60〜61 \\ \refbookA p106〜111 \\ \refbookF p215〜219、p225}

一般に、基底が変わればベクトルの成分表示が変わるように、基底が変われば線形写像の表現行列も変わる。

\br

線形写像$f\colon V \to W$に対して、その表現行列が簡単な形になるように$V$と$W$の基底を選ぶことができれば、$f$がよくわかることになる。

そのため、線形写像を調べる上では、最初から与えられた基底をそのまま使うのではなく、基底の取り替え（\keyword{基底変換}）を行うことが多くの場面で重要になる。

\subsection{線形変換の表現行列と基底の選び方}

線形変換（$V=W$の場合）では、写像の定義される空間$V$と、写す先の空間$W$が同じなので、$V,W$どちらに対しても同じ基底を用いることができる。
\begin{center}
  \begin{tikzcd}[every label/.append style = {font = \small}]
    V \arrow[r,"f"] & V \\
    K^n \arrow[u,"{\Phi_{\mathcal{V}}}"] \arrow[r,"A\times"] & K^n \arrow[u,"{\Phi_{\mathcal{V}}}"']
  \end{tikzcd}
\end{center}

\br

\begin{mindflow}
  % \refbookS 第3章
  \note{$V$の基底と$W$の基底として同じものを考える場合については、後の章で詳しく扱う}
\end{mindflow}

もちろん、考える問題によっては別な基底を用いる場合もある。

その重要な例として、\keyword{基底変換}も、定義域と終域の基底を別に選んだ場合の線形変換として考えることができる。

\subsection{基底を変換する線形変換}

$V$を線形空間とし、$V$の基底$\mathcal{V} = \{\vb*{v}_1, \ldots, \vb*{v}_n\}$を別な基底$\mathcal{V}' = \{\vb*{v}'_1, \ldots, \vb*{v}'_n\}$に取り替えることを考える。

\br

このとき、基底$\mathcal{V}$を別な基底$\mathcal{V}'$に写す線形変換を$f$とおく。
\begin{equation*}
  \left\{
  \begin{array}{ccc}
    f(\vb*{v}_1) & = & \vb*{v}'_1 \\
    \vdots       &   & \vdots     \\
    f(\vb*{v}_n) & = & \vb*{v}'_n
  \end{array}
  \right.
\end{equation*}

$f\colon V \to V$は、基底$\mathcal{V}$を構成するそれぞれのベクトルを、基底$\mathcal{V}'$を構成するベクトルに順に写す線形変換であり、まとめて次のようにも書ける。
\begin{equation}\label{eq:change-basis-map}
  \begin{pmatrix}
    f(\vb*{v}_1), \ldots, f(\vb*{v}_n)
  \end{pmatrix} = \begin{pmatrix}
    \vb*{v}'_1, \ldots, \vb*{v}'_n
  \end{pmatrix}
\end{equation}

\br

一方、$f$の表現行列を$P$とすると、\thmref{thm:matrix-representation-construction}より、$P$は次の規則で定まる。
\begin{equation*}
  \begin{pmatrix}
    f(\vb*{v}_1) & \cdots & f(\vb*{v}_n)
  \end{pmatrix} = \begin{pmatrix}
    \vb*{v}_1 & \cdots & \vb*{v}_n
  \end{pmatrix} P
\end{equation*}

先ほどの等式\eqref{eq:change-basis-map}を代入して、次の式が得られる。
\begin{equation*}
  \begin{pmatrix}
    \vb*{v}'_1 & \cdots & \vb*{v}'_n
  \end{pmatrix} = \begin{pmatrix}
    \vb*{v}_1 & \cdots & \vb*{v}_n
  \end{pmatrix} P
\end{equation*}

\br

$f$は基底変換$\mathcal{V} \rightharpoonup \mathcal{V}'$を表す線形写像であり、$P$はその表現行列である。

この意味で、$P$を基底変換$\mathcal{V} \rightharpoonup \mathcal{V}'$の\keywordJE{基底変換行列}{change-of-basis matrix}という。

\begin{theorem*}{基底変換行列の構成}
  $V$を線形空間とし、$\mathcal{V} = \{\vb*{v}_i\}_{i=1}^n,\, \mathcal{V}' = \{\vb*{v}'_i\}_{i=1}^n$を$V$の基底とするとき、基底変換$\mathcal{V} \rightharpoonup \mathcal{V}'$の変換行列$P$は次の式で定まる。
  \begin{equation*}
    \begin{pmatrix}
      \vb*{v}'_1 & \cdots & \vb*{v}'_n
    \end{pmatrix} = \begin{pmatrix}
      \vb*{v}_1 & \cdots & \vb*{v}_n
    \end{pmatrix} P
  \end{equation*}
\end{theorem*}

\subsection{基底変換行列の可換図式}

基底変換行列$P$は、座標写像を介して考えると、次の可換図式で定まるものである。
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \small}]
    V \arrow[r,"f"] & V \\
    K^n \arrow[u,"{\Phi_{\mathcal{V}}}"] \arrow[r,"P\times"] & K^n \arrow[u,"{\Phi_{\mathcal{V}'}}"']
  \end{tikzcd}
\end{equation*}

\br

$V$を1つにまとめて書いてしまうと関係がよりわかりやすい。
\begin{equation}\label{eq:basis-change-diagram}
  \begin{tikzcd}[every label/.append style = {font = \small}]
    K^n \arrow[dd, "P\times"'] \arrow[rd,"{\Phi_{\mathcal{V}'}}"] & \\
    & V \\
    K^n \arrow[ru,"{\Phi_{\mathcal{V}}}"']
  \end{tikzcd}
\end{equation}

\br

この図式から、$P$は、次のような数ベクトル空間上の線形変換の（標準基底に関する）表現行列であることがわかる。
\begin{equation*}
  \Phi_{\mathcal{V}}^{-1} \circ \Phi_{\mathcal{V}'} \colon K^n \to K^n
\end{equation*}
\begin{equation*}
  \begin{tikzcd}[every label/.append style = {font = \small}]
    K^n \arrow[dd, "P\times"'] \arrow[rd,"{\Phi_{\mathcal{V}'}}"] & \\
    & V \arrow[ld,"{\Phi_{\mathcal{V}}^{-1}}"] \\
    K^n &
  \end{tikzcd}
\end{equation*}

\subsection{基底変換行列の正則性}

基底変換行列$P$を座標写像の合成写像として表すことで、$P$の正則性が明らかになる。

\begin{theorem*}{基底変換行列の正則性}
  基底変換行列は正則行列である。
\end{theorem*}

\begin{proof}
  基底変換行列$P$は、次の線形変換の表現行列である。
  \begin{equation*}
    \Phi_{\mathcal{V}}^{-1} \circ \Phi_{\mathcal{V}'} \colon K^n \to K^n
  \end{equation*}
  ここで、$\Phi_{\mathcal{V}}, \Phi_{\mathcal{V}'}$は座標写像であるので、線形同型（全単射）である。
  
  \br
  
  線形同型写像は全単射であるから、その表現行列は正則である。（\defref{def:invertible-map-by-map-language}）
  
  そこで、$\Phi_{\mathcal{V}}$の表現行列を$A$、$\Phi_{\mathcal{V}'}$の表現行列を$B$とすると、$A,B$はともに正則行列であり、線形写像の合成は行列の積として、
  \begin{equation*}
    P = A^{-1} B
  \end{equation*}
  と書くことができる。
  
  \br
  
  ここで、\thmref{thm:inverse-of-inverse}より、$A^{-1}$も正則行列である。
  また、\thmref{thm:inverse-of-product}より、正則行列の積は正則行列である。
  よって、$P$は正則行列である。$\qed$
\end{proof}

\end{document}
